import{p as P,y as de,g as fe,r as me,M as he,b as ge,i as pe,t as ye,S as be}from"./index-BjWvSF7Y.js";import{m as h,k as f,T as b,M as Y,w as V,p as F,h as C,e as we}from"./const-Do-etVHR.js";import{b as ve,A as Ie,I as Se,h as Me,g as Te,C as Fe,y as Ce,m as Pe,u as _e,p as q,d as G,P as J}from"./index-4Xml3FNN.js";function Ee(n){const{hostMatch:e,extensionId:t,extensionName:r}=n;chrome.tabs.onUpdated.addListener(async(s,i,c)=>{if(c&&c.url&&c&&c.url&&i&&i.status==="loading"){const u=new URL(c.url).hostname;if(e.find(a=>!!~a.indexOf(u))){const a=chrome.runtime.getManifest();chrome.scripting.executeScript({injectImmediately:!0,world:"MAIN",target:{tabId:s,allFrames:!0},func:m=>{window[m.slug]=m},args:[{id:chrome.runtime.id,slug:t,extensionName:r,version:a.version,icons:a.icons,extensionFolderUri:chrome.runtime.getURL("/"),isProdMode:"update_url"in chrome.runtime.getManifest()}]})}}})}var xe=Object.defineProperty,Le=(n,e,t)=>e in n?xe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,_=(n,e,t)=>(Le(n,typeof e!="symbol"?e+"":e,t),t);class te{constructor(e,t){_(this,"listeners",{}),_(this,"tabs",[]),_(this,"slug"),_(this,"isDebugger"),this.slug=e,this.isDebugger=!!t,this.bindMessage(),this.bindEvent()}on(e,t){if(this.listeners[e])throw new Error(`event listener ${String(e)} already exist!`);return this.listeners[e]=t,()=>{delete this.listeners[e]}}async send(e,...t){this.isDebugger&&console.log("send message from background script",{action:e,payload:t,tabs:this.tabs});for(let r of this.tabs)try{const s=await chrome.tabs.get(r);s&&s.id?chrome.tabs.sendMessage(s.id,{from:this.slug,payload:{action:e,payload:t}}):this.deleteTabById(r)}catch(s){console.log(s),this.deleteTabById(r)}}bindMessage(){chrome.runtime.onMessageExternal.addListener((e,t,r)=>{var s,i;if((s=t==null?void 0:t.tab)!=null&&s.id){if(this.isDebugger&&console.log("received message from page",{request:e,sender:t}),e.action==="__connect")return this.tabs.includes(t.tab.id)||this.tabs.push(t.tab.id),r();if(e.action==="__disconnect")return this.deleteTabById(t.tab.id),r();if(this.listeners[e.action])return(i=t==null?void 0:t.tab)!=null&&i.id?(this.tabs.includes(t.tab.id)||this.tabs.push(t.tab.id),this.listeners[e.action](...e.payload).then(c=>{this.isDebugger&&console.log("send to callback from background",{request:e,sender:t,res:c}),r(c)}),!0):r();console.log(`unknown event ${e.action}`)}})}bindEvent(){chrome.tabs.onRemoved.addListener(e=>{this.deleteTabById(e)})}deleteTabById(e){if(this.tabs.includes(e)){const t=this.tabs.indexOf(e);this.tabs.splice(t,1)}}}const Be="1IbzeYQ4G7u",je={type:"object",properties:{},default:{}},Re={__GraphQLUserToken:je},{updateBucket:Ue,setBucket:xt,getBucket:De,deleteBucket:Ae}=P(Re);let U=!1;function ke(n){const e={zFWRw:function(r,s){return r(s)},oZnIu:function(r,s){return r!==s},BUffp:"Network Error!",xVYYS:function(r,s){return r(s)},uEMsL:"__GraphQLUserToken",VRwKX:function(r,s){return r??s},YLJzp:function(r,s){return r===s},PABnK:function(r,s){return r==s},WDYUa:"loading",ujcOF:"www.instagram.com",YjerB:"MAIN",jIyxn:"https://www.instagram.com/",BCEZA:function(r,s,i){return r(s,i)},MdPVe:"Graphql must have https://www.instagram.com/* permission",GsGyn:function(r,s){return r in s},BvSPU:"update_url",OkdrJ:"__fetchGraphQl",SzOTH:"__getUserToken",LAwGX:"__deleteUserToken",VGRdR:"__getTokenAfterRedirection",kofUl:"__updateUserToken"};if(!n.hostMatch.find(r=>!!~r.indexOf("https://www.instagram.com/*")))throw new Error(e.MdPVe);const t=new te(n.projectId,!e.GsGyn(e.BvSPU,chrome.runtime.getManifest()));t.on(e.OkdrJ,async r=>{const s=await e.zFWRw(fetch,r);return e.oZnIu(200,s.status)?{error:{code:s.status,message:e.BUffp}}:await s.json()}),t.on(e.SzOTH,async()=>{const r=await e.xVYYS(De,e.uEMsL);return!(!r.token||!r.scopes)&&r}),t.on(e.LAwGX,async()=>{await e.xVYYS(Ae,e.uEMsL)}),t.on(e.VGRdR,async()=>U?Promise.resolve(""):(U=!0,new Promise(r=>{const s=function(u,a){return e.xVYYS(u,a)},i=function(u,a){return e.zFWRw(u,a)},c=function(u,a,m){return e.BCEZA(u,a,m)};chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(u){const a={FJhfo:function(o,l){return e.xVYYS(o,l)},fsQFF:function(o,l){return e.xVYYS(o,l)},PYVHw:function(o,l){return e.VRwKX(o,l)},ipUZv:function(o,l){return e.YLJzp(o,l)},PSItv:function(o,l){return e.PABnK(o,l)},JjujX:e.WDYUa,IxUYf:e.ujcOF,LjoCS:e.YjerB},m=u[0]??{},g=m==null?void 0:m.id;chrome.tabs.create({url:e.jIyxn},o=>{const l=function(v,T){return s(v,T)},d=function(v,T){return s(v,T)},p=function(v,T){return i(v,T)};let w=!1;function y(v,T,R){const ae=function(S,M){return a.FJhfo(S,M)},oe=function(S,M){return a.fsQFF(S,M)},ce=function(S,M){return a.PYVHw(S,M)},ue=R.url;a.ipUZv(v,o.id)&&a.PSItv(a.JjujX,T.status)&&~ue.indexOf(a.IxUYf)&&chrome.scripting.executeScript({injectImmediately:!1,world:a.LjoCS,target:{tabId:R.id,allFrames:!0},func:Oe}).then(S=>{var M;const le=((M=S==null?void 0:S[0])==null?void 0:M.result)??null;w=!0,ae(I,R.id),oe(r,ce(le,""))})}function I(v){chrome.tabs.remove(v),chrome.tabs.onUpdated.removeListener(y),g&&chrome.tabs.update(g,{active:!0})}chrome.tabs.onUpdated.addListener(y),chrome.tabs.onRemoved.addListener(v=>{w||(l(I,v),d(r,""))}),c(setTimeout,()=>{!w&&p(r,"")},1e4)})})}).finally(()=>{U=!1}))),t.on(e.kofUl,async r=>{await e.BCEZA(Ue,e.uEMsL,i=>r);const s=await chrome.tabs.query({url:n.hostMatch});if(s)for(let i of s)i!=null&&i.id&&chrome.scripting.executeScript({injectImmediately:!0,world:e.YjerB,target:{tabId:i.id,allFrames:!0},func:(c,u)=>{window[u]=c},args:[r,Be]})})}function Oe(){const n=function(s,i){return s(i)},e=function(s,i,c){return s(i,c)},t="include",r=n(atob,"MTI0MDI0NTc0Mjg3NDE0");return new Promise(s=>{const i=function(u,a){return n(u,a)},c=function(u,a){return n(u,a)};e(fetch,"https://www.facebook.com/x/oauth/status?client_id="+r+"&input_token&origin=1&redirect_uri=https%3A%2F%2Fwww.instagram.com%2Faccounts%2Fsignup%2F&sdk=joey&wants_cookie_data=true",{credentials:t}).then(u=>u.headers.get("FB-S")==="connected"?u.headers.get("FB-AR"):null).then(u=>{if(u)try{const a=JSON.parse(u);a.access_token&&i(s,a.access_token)}catch(a){console.error(a),c(s,null)}else c(s,null)})})}var ne=(n=>(n[n.FREE=0]="FREE",n[n.BASIC=1]="BASIC",n[n.PREMIUM=2]="PREMIUM",n))(ne||{});const Ne={type:"object",properties:{uid:{type:"string",default:""},email:{type:"string",default:""},stripeId:{type:"string",default:""},name:{type:"string",default:""},payments:{type:"array",items:{type:"object",properties:{},required:[],default:{}},default:[]},plan:{type:"string",default:ne.FREE},isSubscriptionActive:{type:"boolean",default:!1},lastCheckAt:{type:"number",default:0}},required:["uid","email","stripeId","name","payments","plan","isSubscriptionActive","lastCheckAt"],default:{}},$e={type:"object",properties:{},required:[],default:{}},Ye={type:"object",properties:{},required:[],default:{}},j={customerDataV2:Ne,features:$e,persistLocalStorage:Ye};function re(){return Math.floor(new Date().getTime()/1e3)}function K(n){return n+86400<re()}async function Ve(n){const e=await chrome.tabs.query({url:n.filter(t=>!~t.indexOf("esuit"))});for(let t of e)t.id&&await chrome.tabs.reload(t.id)}let E=[];const{updateBucket:H,getBucket:D,deleteBucket:z}=P(j);function qe(n){h("logout",async()=>{await z("customerDataV2"),await z("features")}),h("login",async()=>{const e=new URLSearchParams({[Y.RETURN_EXT_LOCAL]:chrome.runtime.id}).toString();await chrome.tabs.create({url:`https://esuit.dev/login?${e}`,active:!0})}),h("closePopup",async()=>{chrome.extension.getViews({type:"popup"}).forEach(e=>{e.window.close()})}),h("openOptionsPage",async e=>{const t=chrome.runtime.getURL("src/pages/options/index.html"+(e?"#showSubscription=1":""));(await chrome.tabs.query({url:[t]})).forEach(r=>(r==null?void 0:r.id)&&chrome.tabs.remove(r.id)),await new Promise(r=>setTimeout(r,300)),await chrome.tabs.create({url:t,active:!0})}),h("getCustomerData",async()=>{const e=await D("customerDataV2");if(e.uid)return K(e.lastCheckAt)&&f("reFetchCustomerData"),e}),h("reFetchCustomerData",async(e=!1)=>{const t=await D("customerDataV2"),r=t.uid;if(!r)return!1;if(!e&&r&&!K(t.lastCheckAt))return!0;let s=null,i=null;try{const[a,m]=await Promise.all([fetch(`https://getusersubscription-57pphaecyq-uc.a.run.app/?token=${ve(r,n.projectId)}`).then(g=>g.json()),Ge()]);if(a.stripeId&&(s=a),m){const g=m.find(o=>o.projectId===n.projectId);g&&(i=g)}}catch(a){return console.error(a),"Unknown error, please contact the developer."}if(!s||!i)return"ERROR: reFetchCustomerData returned undefined";let c=s.allPayments.filter(a=>Ie(a.status)||Se(a.status)||Me(a.status)||Te(a.status)||Fe(a.status)),u=b.FREE;return X(c,i,b.BASIC)&&(u=b.BASIC),X(c,i,b.PREMIUM)&&(u=b.PREMIUM),await H("customerDataV2",async a=>s?{uid:r,stripeId:s.stripeId,email:s.email,name:s.name,payments:s.allPayments,plan:u,isSubscriptionActive:u!==b.FREE,lastCheckAt:re()}:a),f("rejectFeaturesToWindow"),!0}),h("visitPricingPage",async()=>{const e=`https://esuit.dev/pricing/${n.projectId}`,t=new URLSearchParams({[Y.RETURN_EXT_LOCAL]:chrome.runtime.id}).toString();await chrome.tabs.create({url:e+`?${t}`,active:!0})}),h("visitDashboard",async()=>{await chrome.tabs.create({url:"https://esuit.dev/dashboard",active:!0}),f("closePopup")}),V("ifUserLogin",async()=>!!(await D("customerDataV2")).uid),V("userInfoUpdate",async([e])=>{e&&(await H("customerDataV2",t=>(t.uid=e,t)),await f("reFetchCustomerData",!0),f("openOptionsPage",!0),setTimeout(()=>{Ve(n.hostMatch)},2e3))})}async function Ge(){if(E.length>0)return E;const n=await fetch("https://static-data.esuit.dev/index.json").then(e=>e.json());return E=Ce(n),E}function X(n,e,t){return!!n.find(r=>{if(![...Pe,..._e,...q,...G,...J].includes(r.status)||[...q].includes(r.status)&&(!r.nextBillingDate||r.nextBillingDate<Math.ceil(new Date().getTime()/1e3))||[...G].includes(r.status)&&(!r.nextBillingDate||r.nextBillingDate<Math.ceil(new Date().getTime()/1e3))||[...J].includes(r.status)&&(!r.nextBillingDate||r.nextBillingDate<Math.ceil(new Date().getTime()/1e3)))return!1;const s=e.prices.find(i=>i.id===r.priceId);return!(!s||s.plan!==t)})}var Je=Object.defineProperty,Ke=(n,e,t)=>e in n?Je(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,x=(n,e,t)=>(Ke(n,typeof e!="symbol"?e+"":e,t),t);class ${constructor(e,t){x(this,"listeners",{}),x(this,"tabs",[]),x(this,"slug"),x(this,"isDebugger"),this.slug=e,this.isDebugger=!!t,this.bindMessage(),this.bindEvent()}on(e,t){if(this.listeners[e])throw new Error(`event listener ${String(e)} already exist!`);return this.listeners[e]=t,()=>{delete this.listeners[e]}}async send(e,...t){this.isDebugger&&console.log("send message from background script",{action:e,payload:t,tabs:this.tabs});for(let r of this.tabs)try{const s=await chrome.tabs.get(r);s&&s.id?chrome.tabs.sendMessage(s.id,{from:this.slug,payload:{action:e,payload:t}}):this.deleteTabById(r)}catch(s){console.log(s),this.deleteTabById(r)}}bindMessage(){chrome.runtime.onMessageExternal.addListener((e,t,r)=>{var s,i;if((s=t==null?void 0:t.tab)!=null&&s.id){if(this.isDebugger&&console.log("received message from page",{request:e,sender:t}),e.action==="__connect")return this.tabs.includes(t.tab.id)||this.tabs.push(t.tab.id),r();if(e.action==="__disconnect")return this.deleteTabById(t.tab.id),r();if(this.listeners[e.action])return(i=t==null?void 0:t.tab)!=null&&i.id?(this.tabs.includes(t.tab.id)||this.tabs.push(t.tab.id),this.listeners[e.action](...e.payload).then(c=>{this.isDebugger&&console.log("send to callback from background",{request:e,sender:t,res:c}),r(c)}),!0):r();console.log(`unknown event ${e.action}`)}})}bindEvent(){chrome.tabs.onRemoved.addListener(e=>{this.deleteTabById(e)})}deleteTabById(e){if(this.tabs.includes(e)){const t=this.tabs.indexOf(e);this.tabs.splice(t,1)}}}function He(n){return[b.FREE,b.BASIC,b.PREMIUM].indexOf(n)}function ze(n,e){const t=He(e);return n.limitation?n.limitation[t]:0}function W(n,e){return{[b.FREE]:1,[b.BASIC]:10,[b.PREMIUM]:100}[e]>=n.permission}function A(n,e){return n.map(t=>{e[t.key]?(e[t.key].enable=e[t.key].enable??t.defaultEnable,e[t.key].currentFreeTryCount=e[t.key].currentFreeTryCount??0):e[t.key]={enable:t.defaultEnable,currentFreeTryCount:0}}),e}function Xe(n){const{cacheId:e,defaultMemoConfig:t}=n;h("setUIMemoSettings",async r=>{await chrome.storage.local.set({[e]:r})}),h("getUIMemoSettings",async()=>{const r=await f("getFeaturesDataByPlan");let s=await new Promise(i=>{chrome.storage.local.get([e]).then(c=>{c[e]?i(c[e]):i(!1)})});return s||(s={...t}),Object.keys(s).map(i=>{const c=Object.values(r).find(a=>a._.memoKey===i);if(c&&c.needUpgrade&&(!c.enable||!(c.freeTryLeft>0||c.limitation>0)&&t[i]!==void 0))return u();function u(){s[i]=t[i]}}),{...t,...s}})}let se=!1;function We(){return se}function Ze(){se=!0}const{updateBucket:k,getBucket:Z}=P(j);function Qe(n){if(We())return;Ze();const e=new $(n,!0);return h("getAllPersistLocalStorage",()=>Z("persistLocalStorage")),h("setPersistLocalStorage",async(t,r)=>{await k("persistLocalStorage",s=>{try{r=JSON.stringify(r)}catch{}return s[t]=r,s})}),h("getPersistLocalStorage",async(t,r)=>{const s=await Z("persistLocalStorage");if(s[t]){try{return JSON.parse(s[t])}catch{}return s[t]}return r??void 0}),h("clearPersistLocalStorage",async()=>{k("persistLocalStorage",()=>({}))}),h("removePersistLocalStorage",async t=>{k("persistLocalStorage",r=>(delete r[t],r))}),e.on("getAllPersistLocalStorage",()=>f("getAllPersistLocalStorage")),e.on("setPersistLocalStorage",(...t)=>f("setPersistLocalStorage",...t)),e.on("getPersistLocalStorage",(...t)=>f("getPersistLocalStorage",...t)),e.on("clearPersistLocalStorage",()=>f("clearPersistLocalStorage")),void e.on("removePersistLocalStorage",t=>f("removePersistLocalStorage",t))}const{setBucket:Q,getBucket:O}=P(j);function et(n){const{projectId:e,hostMatch:t,cacheId:r,features:s,defaultMemoConfig:i}=n,c=new $(e,!0);return Qe(n.projectId),Xe({cacheId:r,defaultMemoConfig:i}),chrome.tabs.onUpdated.addListener(async(o,l,d)=>{if(d&&d.url&&l.status==="loading"){const p=new URL(d.url).hostname;t.find(w=>!!~w.indexOf(p))&&a(o)}}),chrome.storage.onChanged.addListener((o,l)=>{l==="local"&&o&&o.features&&u()}),h("rejectFeaturesToWindow",async()=>{u()}),h("getFeature",async o=>m()[o]),h("consumeFeaturesTreeTryByMemoUIConfigs",async o=>{const l=await m();let d=[];Object.entries(o).map(([p,w])=>{if(i[p]!==void 0&&i[p]!==w){const y=Object.values(l).find(I=>I._.memoKey===p);y&&y.isCanFreeTry&&d.push(y._.key)}}),d.length>0&&f("consumeFeatureTreeTry",d)}),h("consumeFeatureTreeTry",async o=>{let l=A(s,await O("features"));const d=await g();let p=!1;o.map(w=>{const y=s.find(I=>I.key===w||I.memoKey===w);y&&(W(y,d)||(l[y.key].currentFreeTryCount++,p=!0))}),p&&await Q("features",l)}),h("saveFeaturesEnables",async o=>{let l=A(s,await O("features"));Object.entries(o).map(([d,p])=>{l[d].enable=p}),await Q("features",l)}),h("getFeaturesDataByPlan",m),c.on("getUIMemoSettings",()=>f("getUIMemoSettings")),c.on("setUIMemoSettings",o=>f("setUIMemoSettings",o)),c.on("consumeFeatureTreeTry",o=>f("consumeFeatureTreeTry",o)),c.on("visitPricingPage",()=>f("visitPricingPage")),void c.on("consumeFeaturesTreeTryByMemoUIConfigs",o=>{f("consumeFeaturesTreeTryByMemoUIConfigs",o)});async function u(){const o=await chrome.tabs.query({url:t});o&&o.map(l=>{l&&l.id&&a(l.id)})}async function a(o){const l=await m();chrome.scripting.executeScript({injectImmediately:!0,world:"MAIN",target:{tabId:o,allFrames:!0},func:(d,p)=>{window[p]=JSON.parse(d)},args:[JSON.stringify(l),`${e.replaceAll("-","_")}`]})}async function m(){const o=await g();let l=A(s,await O("features"));return s.map(d=>{var p;const w=W(d,o);let y,I=0;return d.memoKey&&(y=i[d.memoKey]),d.maxFreeTryCount&&l[d.key].currentFreeTryCount!==void 0&&(I=Math.max(0,d.maxFreeTryCount-l[d.key].currentFreeTryCount)),{enable:((p=l[d.key])==null?void 0:p.enable)??d.defaultEnable,needUpgrade:!w,limitation:ze(d,o),permission:d.permission,freeTryLeft:d.maxFreeTryCount?I:0,isCanFreeTry:!!d.maxFreeTryCount&&d.maxFreeTryCount>0,defaultValue:y,_:d}}).reduce((d,p)=>(d[p._.key]=p,d),{})}async function g(){const o=await f("getCustomerData");return o?o.plan:b.FREE}}function tt(n,e){(async()=>{let t=0,r=(await chrome.declarativeNetRequest.getDynamicRules()).map(i=>i.id);const s=n.map((i,c)=>(t=c+1,{id:t,priority:1,action:{type:"modifyHeaders",responseHeaders:[{header:"Content-Security-Policy",operation:"remove"},{header:"Content-Security-Policy-Report-Only",operation:"remove"}]},condition:{regexFilter:i,resourceTypes:["main_frame","xmlhttprequest"]}}));await chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:r,addRules:s})})()}function nt(n){const e=new $(n,!0);e.on("reFetchCustomerData",t=>f("reFetchCustomerData",t)),e.on("visitDashboard",()=>f("visitDashboard")),e.on("getCustomerData",()=>f("getCustomerData")),e.on("logout",()=>f("logout")),e.on("login",()=>f("login"))}function rt(n){de(j),qe(n),nt(n.projectId)}const st=[{key:"fetchLimit",name:"Fetch limit",permission:1,limitation:[300,0,0],defaultEnable:!0,memoKey:null},{key:"RESUME_EXPORTING",name:"Resume Exporting",permission:10,maxFreeTryCount:3,defaultEnable:!0,memoKey:null}],it={fullSpeed:!1,isExtraFields:!1,isExtraConcatInfo:!1,isExtraMutualFriendsCount:!1};function at(){}function ot(n,e,t,r){for(var s=n.length,i=t+-1;++i<s;)if(e(n[i],i,n))return i;return-1}function ct(n){return n!==n}function ut(n,e,t){for(var r=t-1,s=n.length;++r<s;)if(n[r]===e)return r;return-1}function lt(n,e,t){return e===e?ut(n,e,t):ot(n,ct,t)}function dt(n,e){var t=n==null?0:n.length;return!!t&&lt(n,e,0)>-1}var N=fe(me,"Set"),ft="__lodash_hash_undefined__";function mt(n){return this.__data__.set(n,ft),this}function ht(n){return this.__data__.has(n)}function B(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new he;++e<t;)this.add(n[e])}B.prototype.add=B.prototype.push=mt;B.prototype.has=ht;function gt(n,e){return n.has(e)}function ie(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}function pt(n){return function(e){return e==null?void 0:e[n]}}function yt(n){return function(e){return ge(e,n)}}function bt(n){return pe(n)?pt(ye(n)):yt(n)}function wt(n){return bt(n)}var vt=1/0,It=N&&1/ie(new N([,-0]))[1]==vt?function(n){return new N(n)}:at,St=200;function Mt(n,e,t){var r=-1,s=dt,i=n.length,c=!0,u=[],a=u;if(i>=St){var m=e?null:It(n);if(m)return ie(m);c=!1,s=gt,a=new B}else a=e?[]:u;e:for(;++r<i;){var g=n[r],o=e?e(g):g;if(g=g!==0?g:0,c&&o===o){for(var l=a.length;l--;)if(a[l]===o)continue e;e&&a.push(o),u.push(g)}else s(a,o,t)||(a!==u&&a.push(o),u.push(g))}return u}function Tt(n,e){return n&&n.length?Mt(n,wt(e)):[]}function ee(){return Math.floor(new Date().getTime()/1e3)}const{updateBucket:L,setBucket:Lt,getBucket:Ft,deleteBucket:Bt}=P(be);function Ct(){const n=new te(F,!0);n.on("goOptionsPage",()=>{chrome.runtime.openOptionsPage()}),n.on("visitPricing",async()=>{f("visitPricingPage")}),n.on("setResumeCursors",async(e,t,r)=>{await L("resumeCursors",s=>{s[e]=s[e]||{},s[e][t]=s[e][t]||{},s[e][t].cursor=r,s[e][t].timestamp=ee();const i=10,c=Object.entries(s[e]);if(c.length>i){c.sort((a,m)=>m[1].timestamp-a[1].timestamp);const u=c.slice(0,i).reduce((a,m)=>{const[g,o]=m;return a[g]=o,a},{});s[e]=u}return s})}),n.on("getResumeCursors",async e=>{const t=await Ft("resumeCursors");if(t[e])return t[e]}),n.on("removeResumeCursors",async(e,t)=>{await L("resumeCursors",r=>(!r[e]||!r[e][t]||delete r[e][t],r))}),n.on("pushRecordsToHistory",async(e,t)=>{L("history",r=>{const s=r.find(i=>i.historyId===e);return s&&(s.records.push(...t),s.records=Tt(s.records,"id")),r})}),n.on("createNewHistoryRecord",async e=>{L("history",t=>(t.find(s=>s.historyId===e.historyId)||t.push({...e,createdAt:ee(),records:[]}),t))})}ke({projectId:F,hostMatch:C});tt(C);Ct();Ee({hostMatch:C,extensionId:F,extensionName:we});rt({projectId:F,callbackExtId:chrome.runtime.id,hostMatch:C});et({projectId:F,hostMatch:C,cacheId:"app-1.0.0",features:st,defaultMemoConfig:it});chrome.scripting.registerContentScripts([{id:`inject-${F}`,js:["injects/proxy.js"],matches:C,runAt:"document_start",world:"MAIN"}]);chrome.scripting.registerContentScripts([{id:`inject-${F}-module`,js:["injects/vendors.js","injects/index.js"],matches:C,runAt:"document_end",world:"MAIN"}]);
