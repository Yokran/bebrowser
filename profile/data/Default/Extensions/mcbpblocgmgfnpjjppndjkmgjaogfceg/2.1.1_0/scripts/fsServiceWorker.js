/**
* @license FireShot - Webpage Screenshots and Annotations
* Copyright (C) 2007-2024 Evgeny Vokilsus (contacts@getfireshot.com)
*/

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="af9c8516-2e86-51f3-8d9a-8fed62d4711b")}catch(e){}}();
(()=>{function Z(e,t){return _e.getOption(e,t)}function Q(e,t){_e.setOption(e,t+"")}var _e={storage:{},onChanged:{listeners:[],addListener(e){this.listeners.indexOf(e)===-1&&this.listeners.push(e)},removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)},notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch{}})}},initPromise:null,inited:!1,onInit:null,assignOptions:function(e){this.storage={...this.storage,...e},chrome.storage.local.set(e)},ensureLoaded:function(){return this.initPromise=this.initPromise||new Promise(e=>{chrome.storage.onChanged.addListener((i,o)=>{if(o==="local"){let s=Object.keys(i);for(let c of s)this.storage[c]=i[c].newValue;this.inited&&this.onChanged.notifyListeners(i)}});let t=i=>{this.inited=!0,i&&(this.storage=i),this.onInit?this.onInit().then(()=>this.onInit=null).finally(e):e()};chrome.storage.local.get(null,i=>{chrome.runtime.lastError&&console.error(chrome.runtime.lastError),i?t(i):(console.log("chrome.storage.local.get failed to obtain preferences"),setTimeout(()=>chrome.storage.local.get(null,s=>{!s&&console.log("chrome.storage.local.get failed to obtain preferences for the second time"),t(s)}),500))})}),this.initPromise},setOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (setOption(${e}))`);else{var i={};i[e]=t,chrome.storage.local.set(i),this.storage[e]=t}},getOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (getOption(${e}))`);else return typeof this.storage[e]>"u"?t:this.storage[e]}};var y={N:0,u:1,te:2,ne:3,re:4,ie:5,oe:7,ae:8,f:10,se:11,p:12,K:13,ce:100,H:101,o:0,e:1,m:2,P:3,I:4,Te:268435456,V:8192,W:"lastAction",G:"lastMode",ue:"enableAPI",z:"fsDebug",le:"errorReporting",fe:"notifyOnUpdates",T:!1,Ce:"disableWASMWorker",de:"allTabsCaptureOnlyVisiblePart",t:"pluginProMode",g:"registeredMode",v:"curVersion",ke:"curVersion1",C:"filenameTemplate",a:"filenameNumber",D:"filenameNumberPadCheck",O:"filenameNumberPadValue",R:"filenameMaxLen",pe:"contextMenuIntegration",he:"pageScrollSpeedValue",Ae:"allowInfiniteScrolling",Pe:"sendUsageDataToGA",me:"newTabIsNextToSource",ge:"screenshotDelay",De:"defaultFolderLite",Oe:"FireShot",ye:"openFolderAfterSavingLite",Re:"noFilenamePrompt",Fe:"closeTabAfterSavingLite",Me:"batchModePrefs",ve:"historyRetainPeriod",Y:"notifyOnUpdates",Ne:"captureTimeLimit",be:"nativeFetchErrorCntr-",F:"uCheck",b:"uEmit",_e:"https://ssl.getfireshot.com/images/api/utm.gif?dummy:",Le:"canBeCapturedBetterNextShow",J:"errorFilter",we:"https://ssl.getfireshot.com/sentry-filter-%VERSION%.csv",X:"onlyLite",Be:"nativeInstall",je:"userLikedFireShot",$e:"userRatedFireShot",Ue:"resultPageShown",Ke:"WASMErrorReported",He:"nextAdShownTime",Ve:"firstSaveDuringSession",k:"guid",L:1296e6,Se:2592e5,B:432e5,Ee:1e4,We:"png",q:"queuedBadgeURL.1",Ge:"showSelectionHint.1",ze:"advancedFeaturesAvailable",Ye:"showAdvertising",Je:"betaPreviewWarningExpanded",Xe:"betaPreviewCompactMode",qe:"PDFOptionsEverDisplayed",Q:"regUser",_:"regKey",j:"taskProgressValue",Qe:"https://ssl.getfireshot.com/images/api/chromefeatures.gif?dummy:",Z:"FireShot Capture %n - %t - [%e]",Ze:"https://getfireshot.com/downloads/%VERSION%/fireshot-chrome-plugin.exe",Ie:"https://screenshot-program.com/fireshot/crash_report.php",A:"captureState",S:"nativeHostReady",U:"resumeMenuEnabled",xe:1,ee:0,c:1,i:2,et:4,E:8,M:16};var As=function(e){let t=Object.prototype.toString;function i(n){switch(t.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return w(n,Error)}}function o(n,r){return t.call(n)===`[object ${r}]`}function s(n){return o(n,"ErrorEvent")}function c(n){return o(n,"DOMError")}function l(n){return o(n,"DOMException")}function d(n){return o(n,"String")}function h(n){return typeof n=="object"&&n!==null&&"__sentry_template_string__"in n&&"__sentry_template_values__"in n}function m(n){return n===null||h(n)||typeof n!="object"&&typeof n!="function"}function b(n){return o(n,"Object")}function v(n){return typeof Event<"u"&&w(n,Event)}function T(n){return typeof Element<"u"&&w(n,Element)}function R(n){return o(n,"RegExp")}function _(n){return!!(n&&n.then&&typeof n.then=="function")}function E(n){return b(n)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n}function w(n,r){try{return n instanceof r}catch{return!1}}function I(n){return!!(typeof n=="object"&&n!==null&&(n.__isVue||n._isVue))}function x(n,r=0){return typeof n!="string"||r===0||n.length<=r?n:`${n.slice(0,r)}...`}function C(n,r){if(!Array.isArray(n))return"";let a=[];for(let u=0;u<n.length;u++){let f=n[u];try{I(f)?a.push("[VueViewModel]"):a.push(String(f))}catch{a.push("[value cannot be serialized]")}}return a.join(r)}function A(n,r,a=!1){return d(n)?R(r)?r.test(n):d(r)?a?n===r:n.includes(r):!1:!1}function k(n,r=[],a=!1){return r.some(u=>A(n,u,a))}function F(n,r,a=250,u,f,p,g){if(!p.exception||!p.exception.values||!g||!w(g.originalException,Error))return;let S=p.exception.values.length>0?p.exception.values[p.exception.values.length-1]:void 0;S&&(p.exception.values=L(H(n,r,f,g.originalException,u,p.exception.values,S,0),a))}function H(n,r,a,u,f,p,g,S){if(p.length>=a+1)return p;let P=[...p];if(w(u[f],Error)){O(g,S);let B=n(r,u[f]),J=P.length;j(B,f,J,S),P=H(n,r,a,u[f],f,[B,...P],B,J)}return Array.isArray(u.errors)&&u.errors.forEach((B,J)=>{if(w(B,Error)){O(g,S);let Y=n(r,B),ie=P.length;j(Y,`errors[${J}]`,ie,S),P=H(n,r,a,B,f,[Y,...P],Y,ie)}}),P}function O(n,r){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,...n.type==="AggregateError"&&{is_exception_group:!0},exception_id:r}}function j(n,r,a,u){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,type:"chained",source:r,exception_id:a,parent_id:u}}function L(n,r){return n.map(a=>(a.value&&(a.value=x(a.value,r)),a))}let M="8.18.0",D=globalThis;function K(n,r,a){let u=a||D,f=u.__SENTRY__=u.__SENTRY__||{},p=f[M]=f[M]||{};return p[n]||(p[n]=r())}let W=D,$=80;function G(n,r={}){if(!n)return"<unknown>";try{let a=n,u=5,f=[],p=0,g=0,S=" > ",P=S.length,B,J=Array.isArray(r)?r:r.keyAttrs,Y=!Array.isArray(r)&&r.maxStringLength||$;for(;a&&p++<u&&(B=se(a,J),!(B==="html"||p>1&&g+f.length*P+B.length>=Y));)f.push(B),g+=B.length,a=a.parentNode;return f.reverse().join(S)}catch{return"<unknown>"}}function se(n,r){let a=n,u=[];if(!a||!a.tagName)return"";if(W.HTMLElement&&a instanceof HTMLElement&&a.dataset){if(a.dataset.sentryComponent)return a.dataset.sentryComponent;if(a.dataset.sentryElement)return a.dataset.sentryElement}u.push(a.tagName.toLowerCase());let f=r&&r.length?r.filter(g=>a.getAttribute(g)).map(g=>[g,a.getAttribute(g)]):null;if(f&&f.length)f.forEach(g=>{u.push(`[${g[0]}="${g[1]}"]`)});else{a.id&&u.push(`#${a.id}`);let g=a.className;if(g&&d(g)){let S=g.split(/\s+/);for(let P of S)u.push(`.${P}`)}}let p=["aria-label","type","name","title","alt"];for(let g of p){let S=a.getAttribute(g);S&&u.push(`[${g}="${S}"]`)}return u.join("")}function ve(){try{return W.document.location.href}catch{return""}}function be(n){if(!W.HTMLElement)return null;let r=n,a=5;for(let u=0;u<a;u++){if(!r)return null;if(r instanceof HTMLElement){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}r=r.parentNode}return null}let de="Sentry Logger ",Ee=["debug","info","warn","error","log","assert","trace"],re={};function U(n){if(!("console"in D))return n();let r=D.console,a={},u=Object.keys(re);u.forEach(f=>{let p=re[f];a[f]=r[f],r[f]=p});try{return n()}finally{u.forEach(f=>{r[f]=a[f]})}}function ae(){let n=!1,r={enable:()=>{n=!0},disable:()=>{n=!1},isEnabled:()=>n};return Ee.forEach(a=>{r[a]=(...u)=>{n&&U(()=>{D.console[a](`${de}[${a}]:`,...u)})}}),r}let V=ae(),Be=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function He(n){return n==="http"||n==="https"}function Oe(n,r=!1){let{host:a,path:u,pass:f,port:p,projectId:g,protocol:S,publicKey:P}=n;return`${S}://${P}${r&&f?`:${f}`:""}@${a}${p?`:${p}`:""}/${u&&`${u}/`}${g}`}function cu(n){let r=Be.exec(n);if(!r){U(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});return}let[a,u,f="",p="",g="",S=""]=r.slice(1),P="",B=S,J=B.split("/");if(J.length>1&&(P=J.slice(0,-1).join("/"),B=J.pop()),B){let Y=B.match(/^\d+/);Y&&(B=Y[0])}return Uo({host:p,pass:f,path:P,projectId:B,port:g,protocol:a,publicKey:u})}function Uo(n){return{protocol:n.protocol,publicKey:n.publicKey||"",pass:n.pass||"",host:n.host,port:n.port||"",path:n.path||"",projectId:n.projectId}}function uu(n){let{port:r,projectId:a,protocol:u}=n;return["protocol","publicKey","host","projectId"].find(g=>n[g]?!1:(V.error(`Invalid Sentry Dsn: ${g} missing`),!0))?!1:a.match(/^\d+$/)?He(u)?r&&isNaN(parseInt(r,10))?(V.error(`Invalid Sentry Dsn: Invalid port ${r}`),!1):!0:(V.error(`Invalid Sentry Dsn: Invalid protocol ${u}`),!1):(V.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),!1)}function Ko(n){let r=typeof n=="string"?cu(n):Uo(n);if(!(!r||!uu(r)))return r}class nt extends Error{constructor(r,a="warn"){super(r),this.message=r,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=a}}function Te(n,r,a){if(!(r in n))return;let u=n[r],f=a(u);typeof f=="function"&&Ho(f,u),n[r]=f}function Ot(n,r,a){try{Object.defineProperty(n,r,{value:a,writable:!0,configurable:!0})}catch{V.log(`Failed to add non-enumerable property "${r}" to object`,n)}}function Ho(n,r){try{let a=r.prototype||{};n.prototype=r.prototype=a,Ot(n,"__sentry_original__",r)}catch{}}function Qr(n){return n.__sentry_original__}function lu(n){return Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}function Vo(n){if(i(n))return{message:n.message,name:n.name,stack:n.stack,...Go(n)};if(v(n)){let r={type:n.type,target:Wo(n.target),currentTarget:Wo(n.currentTarget),...Go(n)};return typeof CustomEvent<"u"&&w(n,CustomEvent)&&(r.detail=n.detail),r}else return n}function Wo(n){try{return T(n)?G(n):Object.prototype.toString.call(n)}catch{return"<unknown>"}}function Go(n){if(typeof n=="object"&&n!==null){let r={};for(let a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r}else return{}}function fu(n,r=40){let a=Object.keys(Vo(n));a.sort();let u=a[0];if(!u)return"[object has no keys]";if(u.length>=r)return x(u,r);for(let f=a.length;f>0;f--){let p=a.slice(0,f).join(", ");if(!(p.length>r))return f===a.length?p:x(p,r)}return""}function Je(n){return Zr(n,new Map)}function Zr(n,r){if(du(n)){let a=r.get(n);if(a!==void 0)return a;let u={};r.set(n,u);for(let f of Object.keys(n))typeof n[f]<"u"&&(u[f]=Zr(n[f],r));return u}if(Array.isArray(n)){let a=r.get(n);if(a!==void 0)return a;let u=[];return r.set(n,u),n.forEach(f=>{u.push(Zr(f,r))}),u}return n}function du(n){if(!b(n))return!1;try{let r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}let zo=50,rt="?",Yo=/\(error: (.*)\)/,Jo=/captureMessage|captureException/;function Xo(...n){let r=n.sort((a,u)=>a[0]-u[0]).map(a=>a[1]);return(a,u=0,f=0)=>{let p=[],g=a.split(`
`);for(let S=u;S<g.length;S++){let P=g[S];if(P.length>1024)continue;let B=Yo.test(P)?P.replace(Yo,"$1"):P;if(!B.match(/\S*Error: /)){for(let J of r){let Y=J(B);if(Y){p.push(Y);break}}if(p.length>=zo+f)break}}return hu(p.slice(f))}}function pu(n){return Array.isArray(n)?Xo(...n):n}function hu(n){if(!n.length)return[];let r=Array.from(n);return/sentryWrapped/.test(qn(r).function||"")&&r.pop(),r.reverse(),Jo.test(qn(r).function||"")&&(r.pop(),Jo.test(qn(r).function||"")&&r.pop()),r.slice(0,zo).map(a=>({...a,filename:a.filename||qn(r).filename,function:a.function||rt}))}function qn(n){return n[n.length-1]||{}}let ei="<anonymous>";function gt(n){try{return!n||typeof n!="function"?ei:n.name||ei}catch{return ei}}function qo(n){let r=n.exception;if(r){let a=[];try{return r.values.forEach(u=>{u.stacktrace.frames&&a.push(...u.stacktrace.frames)}),a}catch{return}}}let Qn={},Qo={};function Rt(n,r){Qn[n]=Qn[n]||[],Qn[n].push(r)}function Ft(n,r){Qo[n]||(r(),Qo[n]=!0)}function et(n,r){let a=n&&Qn[n];if(a)for(let u of a)try{u(r)}catch(f){V.error(`Error while triggering instrumentation handler.
Type: ${n}
Name: ${gt(u)}
Error:`,f)}}function mu(n){let r="console";Rt(r,n),Ft(r,gu)}function gu(){"console"in D&&Ee.forEach(function(n){n in D.console&&Te(D.console,n,function(r){return re[n]=r,function(...a){et("console",{args:a,level:n});let f=re[n];f&&f.apply(D.console,a)}})})}let ti=D;function Zo(){if(!("fetch"in ti))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function ni(n){return n&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(n.toString())}function yu(){if(typeof EdgeRuntime=="string")return!0;if(!Zo())return!1;if(ni(ti.fetch))return!0;let n=!1,r=ti.document;if(r&&typeof r.createElement=="function")try{let a=r.createElement("iframe");a.hidden=!0,r.head.appendChild(a),a.contentWindow&&a.contentWindow.fetch&&(n=ni(a.contentWindow.fetch)),r.head.removeChild(a)}catch(a){V.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return n}let ea=1e3;function _n(){return Date.now()/ea}function vu(){let{performance:n}=D;if(!n||!n.now)return _n;let r=Date.now()-n.now(),a=n.timeOrigin==null?r:n.timeOrigin;return()=>(a+n.now())/ea}let ct=vu();(()=>{let{performance:n}=D;if(!n||!n.now)return;let r=3600*1e3,a=n.now(),u=Date.now(),f=n.timeOrigin?Math.abs(n.timeOrigin+a-u):r,p=f<r,g=n.timing&&n.timing.navigationStart,P=typeof g=="number"?Math.abs(g+a-u):r,B=P<r;return p||B?f<=P?n.timeOrigin:g:u})();function bu(n){let r="fetch";Rt(r,n),Ft(r,_u)}function _u(){yu()&&Te(D,"fetch",function(n){return function(...r){let{method:a,url:u}=wu(r),f={args:r,fetchData:{method:a,url:u},startTimestamp:ct()*1e3};et("fetch",{...f});let p=new Error().stack;return n.apply(D,r).then(g=>{let S={...f,endTimestamp:ct()*1e3,response:g};return et("fetch",S),g},g=>{let S={...f,endTimestamp:ct()*1e3,error:g};throw et("fetch",S),i(g)&&g.stack===void 0&&(g.stack=p,Ot(g,"framesToPop",1)),g})}})}function ri(n,r){return!!n&&typeof n=="object"&&!!n[r]}function ta(n){return typeof n=="string"?n:n?ri(n,"url")?n.url:n.toString?n.toString():"":""}function wu(n){if(n.length===0)return{method:"GET",url:""};if(n.length===2){let[a,u]=n;return{url:ta(a),method:ri(u,"method")?String(u.method).toUpperCase():"GET"}}let r=n[0];return{url:ta(r),method:ri(r,"method")?String(r.method).toUpperCase():"GET"}}let Zn=null;function Su(n){let r="error";Rt(r,n),Ft(r,Eu)}function Eu(){Zn=D.onerror,D.onerror=function(n,r,a,u,f){return et("error",{column:u,error:f,line:a,msg:n,url:r}),Zn&&!Zn.__SENTRY_LOADER__?Zn.apply(this,arguments):!1},D.onerror.__SENTRY_INSTRUMENTED__=!0}let er=null;function Iu(n){let r="unhandledrejection";Rt(r,n),Ft(r,xu)}function xu(){er=D.onunhandledrejection,D.onunhandledrejection=function(n){return et("unhandledrejection",n),er&&!er.__SENTRY_LOADER__?er.apply(this,arguments):!0},D.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function Tu(){return"npm"}function Cu(){let n=typeof WeakSet=="function",r=n?new WeakSet:[];function a(f){if(n)return r.has(f)?!0:(r.add(f),!1);for(let p=0;p<r.length;p++)if(r[p]===f)return!0;return r.push(f),!1}function u(f){if(n)r.delete(f);else for(let p=0;p<r.length;p++)if(r[p]===f){r.splice(p,1);break}}return[a,u]}function Se(){let n=D,r=n.crypto||n.msCrypto,a=()=>Math.random()*16;try{if(r&&r.randomUUID)return r.randomUUID().replace(/-/g,"");r&&r.getRandomValues&&(a=()=>{let u=new Uint8Array(1);return r.getRandomValues(u),u[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,u=>(u^(a()&15)>>u/4).toString(16))}function na(n){return n.exception&&n.exception.values?n.exception.values[0]:void 0}function yt(n){let{message:r,event_id:a}=n;if(r)return r;let u=na(n);return u?u.type&&u.value?`${u.type}: ${u.value}`:u.type||u.value||a||"<unknown>":a||"<unknown>"}function ii(n,r,a){let u=n.exception=n.exception||{},f=u.values=u.values||[],p=f[0]=f[0]||{};p.value||(p.value=r||""),p.type||(p.type=a||"Error")}function wn(n,r){let a=na(n);if(!a)return;let u={type:"generic",handled:!0},f=a.mechanism;if(a.mechanism={...u,...f,...r},r&&"data"in r){let p={...f&&f.data,...r.data};a.mechanism.data=p}}function ra(n){if(n&&n.__sentry_captured__)return!0;try{Ot(n,"__sentry_captured__",!0)}catch{}return!1}function ia(n){return Array.isArray(n)?n:[n]}function vt(n,r=100,a=1/0){try{return oi("",n,r,a)}catch(u){return{ERROR:`**non-serializable** (${u})`}}}function oa(n,r=3,a=102400){let u=vt(n,r);return Du(u)>a?oa(n,r-1,a):u}function oi(n,r,a=1/0,u=1/0,f=Cu()){let[p,g]=f;if(r==null||["number","boolean","string"].includes(typeof r)&&!Number.isNaN(r))return r;let S=ku(n,r);if(!S.startsWith("[object "))return S;if(r.__sentry_skip_normalization__)return r;let P=typeof r.__sentry_override_normalization_depth__=="number"?r.__sentry_override_normalization_depth__:a;if(P===0)return S.replace("object ","");if(p(r))return"[Circular ~]";let B=r;if(B&&typeof B.toJSON=="function")try{let le=B.toJSON();return oi("",le,P-1,u,f)}catch{}let J=Array.isArray(r)?[]:{},Y=0,ie=Vo(r);for(let le in ie){if(!Object.prototype.hasOwnProperty.call(ie,le))continue;if(Y>=u){J[le]="[MaxProperties ~]";break}let ce=ie[le];J[le]=oi(le,ce,P-1,u,f),Y++}return g(r),J}function ku(n,r){try{if(n==="domain"&&r&&typeof r=="object"&&r._events)return"[Domain]";if(n==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&r===global)return"[Global]";if(typeof window<"u"&&r===window)return"[Window]";if(typeof document<"u"&&r===document)return"[Document]";if(I(r))return"[VueViewModel]";if(E(r))return"[SyntheticEvent]";if(typeof r=="number"&&r!==r)return"[NaN]";if(typeof r=="function")return`[Function: ${gt(r)}]`;if(typeof r=="symbol")return`[${String(r)}]`;if(typeof r=="bigint")return`[BigInt: ${String(r)}]`;let a=Au(r);return/^HTML(\w*)Element$/.test(a)?`[HTMLElement: ${a}]`:`[object ${a}]`}catch(a){return`**non-serializable** (${a})`}}function Au(n){let r=Object.getPrototypeOf(n);return r?r.constructor.name:"null prototype"}function Pu(n){return~-encodeURI(n).split(/%..|./).length}function Du(n){return Pu(JSON.stringify(n))}var ut;(function(n){n[n.PENDING=0]="PENDING";let a=1;n[n.RESOLVED=a]="RESOLVED";let u=2;n[n.REJECTED=u]="REJECTED"})(ut||(ut={}));function Mt(n){return new Xe(r=>{r(n)})}function tr(n){return new Xe((r,a)=>{a(n)})}class Xe{constructor(r){Xe.prototype.__init.call(this),Xe.prototype.__init2.call(this),Xe.prototype.__init3.call(this),Xe.prototype.__init4.call(this),this._state=ut.PENDING,this._handlers=[];try{r(this._resolve,this._reject)}catch(a){this._reject(a)}}then(r,a){return new Xe((u,f)=>{this._handlers.push([!1,p=>{if(!r)u(p);else try{u(r(p))}catch(g){f(g)}},p=>{if(!a)f(p);else try{u(a(p))}catch(g){f(g)}}]),this._executeHandlers()})}catch(r){return this.then(a=>a,r)}finally(r){return new Xe((a,u)=>{let f,p;return this.then(g=>{p=!1,f=g,r&&r()},g=>{p=!0,f=g,r&&r()}).then(()=>{if(p){u(f);return}a(f)})})}__init(){this._resolve=r=>{this._setResult(ut.RESOLVED,r)}}__init2(){this._reject=r=>{this._setResult(ut.REJECTED,r)}}__init3(){this._setResult=(r,a)=>{if(this._state===ut.PENDING){if(_(a)){a.then(this._resolve,this._reject);return}this._state=r,this._value=a,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===ut.PENDING)return;let r=this._handlers.slice();this._handlers=[],r.forEach(a=>{a[0]||(this._state===ut.RESOLVED&&a[1](this._value),this._state===ut.REJECTED&&a[2](this._value),a[0]=!0)})}}}function Ou(n){let r=[];function a(){return n===void 0||r.length<n}function u(g){return r.splice(r.indexOf(g),1)[0]||Promise.resolve(void 0)}function f(g){if(!a())return tr(new nt("Not adding Promise because buffer limit was reached."));let S=g();return r.indexOf(S)===-1&&r.push(S),S.then(()=>u(S)).then(null,()=>u(S).then(null,()=>{})),S}function p(g){return new Xe((S,P)=>{let B=r.length;if(!B)return S(!0);let J=setTimeout(()=>{g&&g>0&&S(!1)},g);r.forEach(Y=>{Mt(Y).then(()=>{--B||(clearTimeout(J),S(!0))},P)})})}return{$:r,add:f,drain:p}}function ai(n){if(!n)return{};let r=n.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!r)return{};let a=r[6]||"",u=r[8]||"";return{host:r[4],path:r[5],protocol:r[2],search:a,hash:u,relative:r[5]+a+u}}let Ru=["fatal","error","warning","log","info","debug"];function Fu(n){return n==="warn"?"warning":Ru.includes(n)?n:"log"}let aa="sentry-",Mu=/^sentry-/,Nu=8192;function sa(n){let r=Bu(n);if(!r)return;let a=Object.entries(r).reduce((u,[f,p])=>{if(f.match(Mu)){let g=f.slice(aa.length);u[g]=p}return u},{});if(Object.keys(a).length>0)return a}function Lu(n){if(!n)return;let r=Object.entries(n).reduce((a,[u,f])=>(f&&(a[`${aa}${u}`]=f),a),{});return ju(r)}function Bu(n){if(!(!n||!d(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((r,a)=>{let u=ca(a);return Object.entries(u).forEach(([f,p])=>{r[f]=p}),r},{}):ca(n)}function ca(n){return n.split(",").map(r=>r.split("=").map(a=>decodeURIComponent(a.trim()))).reduce((r,[a,u])=>(a&&u&&(r[a]=u),r),{})}function ju(n){if(Object.keys(n).length!==0)return Object.entries(n).reduce((r,[a,u],f)=>{let p=`${encodeURIComponent(a)}=${encodeURIComponent(u)}`,g=f===0?p:`${r},${p}`;return g.length>Nu?(V.warn(`Not adding key: ${a} with val: ${u} to baggage header due to exceeding baggage size limits.`),r):g},"")}let $u=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function Uu(n){if(!n)return;let r=n.match($u);if(!r)return;let a;return r[3]==="1"?a=!0:r[3]==="0"&&(a=!1),{traceId:r[1],parentSampled:a,parentSpanId:r[2]}}function Ku(n,r){let a=Uu(n),u=sa(r),{traceId:f,parentSpanId:p,parentSampled:g}=a||{};return a?{traceId:f||Se(),parentSpanId:p||Se().substring(16),spanId:Se().substring(16),sampled:g,dsc:u||{}}:{traceId:f||Se(),spanId:Se().substring(16)}}function Hu(n=Se(),r=Se().substring(16),a){let u="";return a!==void 0&&(u=a?"-1":"-0"),`${n}-${r}${u}`}function Sn(n,r=[]){return[n,r]}function Vu(n,r){let[a,u]=n;return[a,[...u,r]]}function ua(n,r){let a=n[1];for(let u of a){let f=u[0].type;if(r(u,f))return!0}return!1}function si(n){return D.__SENTRY__&&D.__SENTRY__.encodePolyfill?D.__SENTRY__.encodePolyfill(n):new TextEncoder().encode(n)}function Wu(n){let[r,a]=n,u=JSON.stringify(r);function f(p){typeof u=="string"?u=typeof p=="string"?u+p:[si(u),p]:u.push(typeof p=="string"?si(p):p)}for(let p of a){let[g,S]=p;if(f(`
${JSON.stringify(g)}
`),typeof S=="string"||S instanceof Uint8Array)f(S);else{let P;try{P=JSON.stringify(S)}catch{P=JSON.stringify(vt(S))}f(P)}}return typeof u=="string"?u:Gu(u)}function Gu(n){let r=n.reduce((f,p)=>f+p.length,0),a=new Uint8Array(r),u=0;for(let f of n)a.set(f,u),u+=f.length;return a}function zu(n){let r=typeof n.data=="string"?si(n.data):n.data;return[Je({type:"attachment",length:r.length,filename:n.filename,content_type:n.contentType,attachment_type:n.attachmentType}),r]}let Yu={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function la(n){return Yu[n]}function fa(n){if(!n||!n.sdk)return;let{name:r,version:a}=n.sdk;return{name:r,version:a}}function Ju(n,r,a,u){let f=n.sdkProcessingMetadata&&n.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:n.event_id,sent_at:new Date().toISOString(),...r&&{sdk:r},...!!a&&u&&{dsn:Oe(u)},...f&&{trace:Je({...f})}}}function Xu(n,r,a){let u=[{type:"client_report"},{timestamp:a||_n(),discarded_events:n}];return Sn(r?{dsn:r}:{},[u])}let qu=60*1e3;function Qu(n,r=Date.now()){let a=parseInt(`${n}`,10);if(!isNaN(a))return a*1e3;let u=Date.parse(`${n}`);return isNaN(u)?qu:u-r}function Zu(n,r){return n[r]||n.all||0}function el(n,r,a=Date.now()){return Zu(n,r)>a}function tl(n,{statusCode:r,headers:a},u=Date.now()){let f={...n},p=a&&a["x-sentry-rate-limits"],g=a&&a["retry-after"];if(p)for(let S of p.trim().split(",")){let[P,B,,,J]=S.split(":",5),Y=parseInt(P,10),ie=(isNaN(Y)?60:Y)*1e3;if(!B)f.all=u+ie;else for(let le of B.split(";"))le==="metric_bucket"?(!J||J.split(";").includes("custom"))&&(f[le]=u+ie):f[le]=u+ie}else g?f.all=u+Qu(g,u):r===429&&(f.all=u+6e4);return f}function da(){return{traceId:Se(),spanId:Se().substring(16)}}let nr=D;function nl(){let n=nr.chrome,r=n&&n.app&&n.app.runtime,a="history"in nr&&!!nr.history.pushState&&!!nr.history.replaceState;return!r&&a}let pa=()=>{},rl=["attachTo","createWidget","remove"];function ha(n){return U(()=>{console.warn("You are using feedbackIntegration() even though this bundle does not include feedback.")}),{name:"Feedback",...rl.reduce((r,a)=>(r[a]=pa,r),{})}}let il=["start","stop","flush"];function ol(n){return U(()=>{console.warn("You are using replayIntegration() even though this bundle does not include replay.")}),{name:"Replay",...il.reduce((r,a)=>(r[a]=pa,r),{})}}function En(){return ci(D),D}function ci(n){let r=n.__SENTRY__=n.__SENTRY__||{};return r.version=r.version||M,r[M]=r[M]||{}}function al(n){let r=ct(),a={sid:Se(),init:!0,timestamp:r,started:r,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>cl(a)};return n&&Jt(a,n),a}function Jt(n,r={}){if(r.user&&(!n.ipAddress&&r.user.ip_address&&(n.ipAddress=r.user.ip_address),!n.did&&!r.did&&(n.did=r.user.id||r.user.email||r.user.username)),n.timestamp=r.timestamp||ct(),r.abnormal_mechanism&&(n.abnormal_mechanism=r.abnormal_mechanism),r.ignoreDuration&&(n.ignoreDuration=r.ignoreDuration),r.sid&&(n.sid=r.sid.length===32?r.sid:Se()),r.init!==void 0&&(n.init=r.init),!n.did&&r.did&&(n.did=`${r.did}`),typeof r.started=="number"&&(n.started=r.started),n.ignoreDuration)n.duration=void 0;else if(typeof r.duration=="number")n.duration=r.duration;else{let a=n.timestamp-n.started;n.duration=a>=0?a:0}r.release&&(n.release=r.release),r.environment&&(n.environment=r.environment),!n.ipAddress&&r.ipAddress&&(n.ipAddress=r.ipAddress),!n.userAgent&&r.userAgent&&(n.userAgent=r.userAgent),typeof r.errors=="number"&&(n.errors=r.errors),r.status&&(n.status=r.status)}function sl(n,r){let a={};r?a={status:r}:n.status==="ok"&&(a={status:"exited"}),Jt(n,a)}function cl(n){return Je({sid:`${n.sid}`,init:n.init,started:new Date(n.started*1e3).toISOString(),timestamp:new Date(n.timestamp*1e3).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})}let ui="_sentrySpan";function ma(n,r){r?Ot(n,ui,r):delete n[ui]}function ga(n){return n[ui]}let ul=100;class li{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=da()}clone(){let r=new li;return r._breadcrumbs=[...this._breadcrumbs],r._tags={...this._tags},r._extra={...this._extra},r._contexts={...this._contexts},r._user=this._user,r._level=this._level,r._session=this._session,r._transactionName=this._transactionName,r._fingerprint=this._fingerprint,r._eventProcessors=[...this._eventProcessors],r._requestSession=this._requestSession,r._attachments=[...this._attachments],r._sdkProcessingMetadata={...this._sdkProcessingMetadata},r._propagationContext={...this._propagationContext},r._client=this._client,r._lastEventId=this._lastEventId,ma(r,ga(this)),r}setClient(r){this._client=r}setLastEventId(r){this._lastEventId=r}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(r){this._scopeListeners.push(r)}addEventProcessor(r){return this._eventProcessors.push(r),this}setUser(r){return this._user=r||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Jt(this._session,{user:r}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(r){return this._requestSession=r,this}setTags(r){return this._tags={...this._tags,...r},this._notifyScopeListeners(),this}setTag(r,a){return this._tags={...this._tags,[r]:a},this._notifyScopeListeners(),this}setExtras(r){return this._extra={...this._extra,...r},this._notifyScopeListeners(),this}setExtra(r,a){return this._extra={...this._extra,[r]:a},this._notifyScopeListeners(),this}setFingerprint(r){return this._fingerprint=r,this._notifyScopeListeners(),this}setLevel(r){return this._level=r,this._notifyScopeListeners(),this}setTransactionName(r){return this._transactionName=r,this._notifyScopeListeners(),this}setContext(r,a){return a===null?delete this._contexts[r]:this._contexts[r]=a,this._notifyScopeListeners(),this}setSession(r){return r?this._session=r:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(r){if(!r)return this;let a=typeof r=="function"?r(this):r,[u,f]=a instanceof lt?[a.getScopeData(),a.getRequestSession()]:b(a)?[r,r.requestSession]:[],{tags:p,extra:g,user:S,contexts:P,level:B,fingerprint:J=[],propagationContext:Y}=u||{};return this._tags={...this._tags,...p},this._extra={...this._extra,...g},this._contexts={...this._contexts,...P},S&&Object.keys(S).length&&(this._user=S),B&&(this._level=B),J.length&&(this._fingerprint=J),Y&&(this._propagationContext=Y),f&&(this._requestSession=f),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,ma(this,void 0),this._attachments=[],this._propagationContext=da(),this._notifyScopeListeners(),this}addBreadcrumb(r,a){let u=typeof a=="number"?a:ul;if(u<=0)return this;let f={timestamp:_n(),...r},p=this._breadcrumbs;return p.push(f),this._breadcrumbs=p.length>u?p.slice(-u):p,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(r){return this._attachments.push(r),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:ga(this)}}setSDKProcessingMetadata(r){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...r},this}setPropagationContext(r){return this._propagationContext=r,this}getPropagationContext(){return this._propagationContext}captureException(r,a){let u=a&&a.event_id?a.event_id:Se();if(!this._client)return V.warn("No client configured on scope - will not capture exception!"),u;let f=new Error("Sentry syntheticException");return this._client.captureException(r,{originalException:r,syntheticException:f,...a,event_id:u},this),u}captureMessage(r,a,u){let f=u&&u.event_id?u.event_id:Se();if(!this._client)return V.warn("No client configured on scope - will not capture message!"),f;let p=new Error(r);return this._client.captureMessage(r,a,{originalException:r,syntheticException:p,...u,event_id:f},this),f}captureEvent(r,a){let u=a&&a.event_id?a.event_id:Se();return this._client?(this._client.captureEvent(r,{...a,event_id:u},this),u):(V.warn("No client configured on scope - will not capture event!"),u)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(r=>{r(this)}),this._notifyingListeners=!1)}}let lt=li;function ll(){return K("defaultCurrentScope",()=>new lt)}function fl(){return K("defaultIsolationScope",()=>new lt)}class dl{constructor(r,a){let u;r?u=r:u=new lt;let f;a?f=a:f=new lt,this._stack=[{scope:u}],this._isolationScope=f}withScope(r){let a=this._pushScope(),u;try{u=r(a)}catch(f){throw this._popScope(),f}return _(u)?u.then(f=>(this._popScope(),f),f=>{throw this._popScope(),f}):(this._popScope(),u)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let r=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:r}),r}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Xt(){let n=En(),r=ci(n);return r.stack=r.stack||new dl(ll(),fl())}function pl(n){return Xt().withScope(n)}function hl(n,r){let a=Xt();return a.withScope(()=>(a.getStackTop().scope=n,r(n)))}function ya(n){return Xt().withScope(()=>n(Xt().getIsolationScope()))}function ml(){return{withIsolationScope:ya,withScope:pl,withSetScope:hl,withSetIsolationScope:(n,r)=>ya(r),getCurrentScope:()=>Xt().getScope(),getIsolationScope:()=>Xt().getIsolationScope()}}function rr(n){let r=ci(n);return r.acs?r.acs:ml()}function Re(){let n=En();return rr(n).getCurrentScope()}function Me(){let n=En();return rr(n).getIsolationScope()}function va(){return K("globalScope",()=>new lt)}function ir(...n){let r=En(),a=rr(r);if(n.length===2){let[u,f]=n;return u?a.withSetScope(u,f):a.withScope(f)}return a.withScope(n[0])}function gl(...n){let r=En(),a=rr(r);if(n.length===2){let[u,f]=n;return u?a.withSetIsolationScope(u,f):a.withIsolationScope(f)}return a.withIsolationScope(n[0])}function pe(){return Re().getClient()}let yl="_sentryMetrics";function vl(n){let r=n[yl];if(!r)return;let a={};for(let[,[u,f]]of r)(a[u]||(a[u]=[])).push(Je(f));return a}let ba="sentry.source",_a="sentry.sample_rate",wa="sentry.op",Sa="sentry.origin",bl=0,_l=1,wl=1;function Sl(n){let{spanId:r,traceId:a}=n.spanContext(),{parent_span_id:u}=In(n);return Je({parent_span_id:u,span_id:r,trace_id:a})}function El(n){let{traceId:r,spanId:a}=n.spanContext(),u=xa(n);return Hu(r,a,u)}function Ea(n){return typeof n=="number"?Ia(n):Array.isArray(n)?n[0]+n[1]/1e9:n instanceof Date?Ia(n.getTime()):ct()}function Ia(n){return n>9999999999?n/1e3:n}function In(n){if(xl(n))return n.getSpanJSON();try{let{spanId:r,traceId:a}=n.spanContext();if(Il(n)){let{attributes:u,startTime:f,name:p,endTime:g,parentSpanId:S,status:P}=n;return Je({span_id:r,trace_id:a,data:u,description:p,parent_span_id:S,start_timestamp:Ea(f),timestamp:Ea(g)||void 0,status:Tl(P),op:u[wa],origin:u[Sa],_metrics_summary:vl(n)})}return{span_id:r,trace_id:a}}catch{return{}}}function Il(n){let r=n;return!!r.attributes&&!!r.startTime&&!!r.name&&!!r.endTime&&!!r.status}function xl(n){return typeof n.getSpanJSON=="function"}function xa(n){let{traceFlags:r}=n.spanContext();return r===wl}function Tl(n){if(!(!n||n.code===bl))return n.code===_l?"ok":n.message||"unknown_error"}let Cl="_sentryRootSpan";function Ta(n){return n[Cl]||n}let fi="production",kl="_frozenDsc";function Ca(n,r){let a=r.getOptions(),{publicKey:u}=r.getDsn()||{},f=Je({environment:a.environment||fi,release:a.release,public_key:u,trace_id:n});return r.emit("createDsc",f),f}function ka(n){let r=pe();if(!r)return{};let a=Ca(In(n).trace_id||"",r),u=Ta(n),f=u[kl];if(f)return f;let p=u.spanContext().traceState,g=p&&p.get("sentry.dsc"),S=g&&sa(g);if(S)return S;let P=In(u),B=P.data||{},J=B[_a];J!=null&&(a.sample_rate=`${J}`);let Y=B[ba],ie=P.description;return Y!=="url"&&ie&&(a.transaction=ie),a.sampled=String(xa(u)),r.emit("createDsc",a,u),a}function Al(n){let r=ka(n);return Lu(r)}function Pl(n){if(typeof n=="boolean")return Number(n);let r=typeof n=="string"?parseFloat(n):n;if(typeof r!="number"||isNaN(r)||r<0||r>1){V.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`);return}return r}function Dl(n,r){return r&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||r.name,n.sdk.version=n.sdk.version||r.version,n.sdk.integrations=[...n.sdk.integrations||[],...r.integrations||[]],n.sdk.packages=[...n.sdk.packages||[],...r.packages||[]]),n}function Ol(n,r,a,u){let f=fa(a),p={sent_at:new Date().toISOString(),...f&&{sdk:f},...!!u&&r&&{dsn:Oe(r)}},g="aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()];return Sn(p,[g])}function Rl(n,r,a,u){let f=fa(a),p=n.type&&n.type!=="replay_event"?n.type:"event";Dl(n,a&&a.sdk);let g=Ju(n,f,u,r);return delete n.sdkProcessingMetadata,Sn(g,[[{type:p},n]])}let Fl=({sentryTrace:n,baggage:r},a)=>ir(u=>{let f=Ku(n,r);return u.setPropagationContext(f),a()});function di(n,r,a,u=0){return new Xe((f,p)=>{let g=n[u];if(r===null||typeof g!="function")f(r);else{let S=g({...r},a);g.id&&S===null&&V.log(`Event processor "${g.id}" dropped event`),_(S)?S.then(P=>di(n,P,a,u+1).then(f)).then(null,p):di(n,S,a,u+1).then(f).then(null,p)}})}function Ml(n,r){let{fingerprint:a,span:u,breadcrumbs:f,sdkProcessingMetadata:p}=r;Nl(n,r),u&&jl(n,u),$l(n,a),Ll(n,f),Bl(n,p)}function Aa(n,r){let{extra:a,tags:u,user:f,contexts:p,level:g,sdkProcessingMetadata:S,breadcrumbs:P,fingerprint:B,eventProcessors:J,attachments:Y,propagationContext:ie,transactionName:le,span:ce}=r;xn(n,"extra",a),xn(n,"tags",u),xn(n,"user",f),xn(n,"contexts",p),xn(n,"sdkProcessingMetadata",S),g&&(n.level=g),le&&(n.transactionName=le),ce&&(n.span=ce),P.length&&(n.breadcrumbs=[...n.breadcrumbs,...P]),B.length&&(n.fingerprint=[...n.fingerprint,...B]),J.length&&(n.eventProcessors=[...n.eventProcessors,...J]),Y.length&&(n.attachments=[...n.attachments,...Y]),n.propagationContext={...n.propagationContext,...ie}}function xn(n,r,a){if(a&&Object.keys(a).length){n[r]={...n[r]};for(let u in a)Object.prototype.hasOwnProperty.call(a,u)&&(n[r][u]=a[u])}}function Nl(n,r){let{extra:a,tags:u,user:f,contexts:p,level:g,transactionName:S}=r,P=Je(a);P&&Object.keys(P).length&&(n.extra={...P,...n.extra});let B=Je(u);B&&Object.keys(B).length&&(n.tags={...B,...n.tags});let J=Je(f);J&&Object.keys(J).length&&(n.user={...J,...n.user});let Y=Je(p);Y&&Object.keys(Y).length&&(n.contexts={...Y,...n.contexts}),g&&(n.level=g),S&&n.type!=="transaction"&&(n.transaction=S)}function Ll(n,r){let a=[...n.breadcrumbs||[],...r];n.breadcrumbs=a.length?a:void 0}function Bl(n,r){n.sdkProcessingMetadata={...n.sdkProcessingMetadata,...r}}function jl(n,r){n.contexts={trace:Sl(r),...n.contexts},n.sdkProcessingMetadata={dynamicSamplingContext:ka(r),...n.sdkProcessingMetadata};let a=Ta(r),u=In(a).description;u&&!n.transaction&&n.type==="transaction"&&(n.transaction=u)}function $l(n,r){n.fingerprint=n.fingerprint?ia(n.fingerprint):[],r&&(n.fingerprint=n.fingerprint.concat(r)),n.fingerprint&&!n.fingerprint.length&&delete n.fingerprint}function Ul(n,r,a,u,f,p){let{normalizeDepth:g=3,normalizeMaxBreadth:S=1e3}=n,P={...r,event_id:r.event_id||a.event_id||Se(),timestamp:r.timestamp||_n()},B=a.integrations||n.integrations.map(Ne=>Ne.name);Kl(P,n),Wl(P,B),f&&f.emit("applyFrameMetadata",r),r.type===void 0&&Hl(P,n.stackParser);let J=zl(u,a.captureContext);a.mechanism&&wn(P,a.mechanism);let Y=f?f.getEventProcessors():[],ie=va().getScopeData();if(p){let Ne=p.getScopeData();Aa(ie,Ne)}if(J){let Ne=J.getScopeData();Aa(ie,Ne)}let le=[...a.attachments||[],...ie.attachments];le.length&&(a.attachments=le),Ml(P,ie);let ce=[...Y,...ie.eventProcessors];return di(ce,P,a).then(Ne=>(Ne&&Vl(Ne),typeof g=="number"&&g>0?Gl(Ne,g,S):Ne))}function Kl(n,r){let{environment:a,release:u,dist:f,maxValueLength:p=250}=r;"environment"in n||(n.environment="environment"in r?a:fi),n.release===void 0&&u!==void 0&&(n.release=u),n.dist===void 0&&f!==void 0&&(n.dist=f),n.message&&(n.message=x(n.message,p));let g=n.exception&&n.exception.values&&n.exception.values[0];g&&g.value&&(g.value=x(g.value,p));let S=n.request;S&&S.url&&(S.url=x(S.url,p))}let Pa=new WeakMap;function Hl(n,r){let a=D._sentryDebugIds;if(!a)return;let u,f=Pa.get(r);f?u=f:(u=new Map,Pa.set(r,u));let p=Object.entries(a).reduce((g,[S,P])=>{let B,J=u.get(S);J?B=J:(B=r(S),u.set(S,B));for(let Y=B.length-1;Y>=0;Y--){let ie=B[Y];if(ie.filename){g[ie.filename]=P;break}}return g},{});try{n.exception.values.forEach(g=>{g.stacktrace.frames.forEach(S=>{S.filename&&(S.debug_id=p[S.filename])})})}catch{}}function Vl(n){let r={};try{n.exception.values.forEach(u=>{u.stacktrace.frames.forEach(f=>{f.debug_id&&(f.abs_path?r[f.abs_path]=f.debug_id:f.filename&&(r[f.filename]=f.debug_id),delete f.debug_id)})})}catch{}if(Object.keys(r).length===0)return;n.debug_meta=n.debug_meta||{},n.debug_meta.images=n.debug_meta.images||[];let a=n.debug_meta.images;Object.entries(r).forEach(([u,f])=>{a.push({type:"sourcemap",code_file:u,debug_id:f})})}function Wl(n,r){r.length>0&&(n.sdk=n.sdk||{},n.sdk.integrations=[...n.sdk.integrations||[],...r])}function Gl(n,r,a){if(!n)return null;let u={...n,...n.breadcrumbs&&{breadcrumbs:n.breadcrumbs.map(f=>({...f,...f.data&&{data:vt(f.data,r,a)}}))},...n.user&&{user:vt(n.user,r,a)},...n.contexts&&{contexts:vt(n.contexts,r,a)},...n.extra&&{extra:vt(n.extra,r,a)}};return n.contexts&&n.contexts.trace&&u.contexts&&(u.contexts.trace=n.contexts.trace,n.contexts.trace.data&&(u.contexts.trace.data=vt(n.contexts.trace.data,r,a))),n.spans&&(u.spans=n.spans.map(f=>({...f,...f.data&&{data:vt(f.data,r,a)}}))),u}function zl(n,r){if(!r)return n;let a=n?n.clone():new lt;return a.update(r),a}function Yl(n){if(n)return Jl(n)?{captureContext:n}:ql(n)?{captureContext:n}:n}function Jl(n){return n instanceof lt||typeof n=="function"}let Xl=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function ql(n){return Object.keys(n).some(r=>Xl.includes(r))}function Da(n,r){return Re().captureException(n,Yl(r))}function Ql(n,r){let a=typeof r=="string"?r:void 0,u=typeof r!="string"?{captureContext:r}:void 0;return Re().captureMessage(n,a,u)}function or(n,r){return Re().captureEvent(n,r)}function Oa(n,r){Me().setContext(n,r)}function Ra(n){Me().setExtras(n)}function Fa(n,r){Me().setExtra(n,r)}function Ma(n){Me().setTags(n)}function Na(n,r){Me().setTag(n,r)}function La(n){Me().setUser(n)}function Ba(){return Me().lastEventId()}async function Zl(n){let r=pe();return r?r.flush(n):(V.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function ef(n){let r=pe();return r?r.close(n):(V.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function tf(){return!!pe()}function nf(n){Me().addEventProcessor(n)}function ar(n){let r=pe(),a=Me(),u=Re(),{release:f,environment:p=fi}=r&&r.getOptions()||{},{userAgent:g}=D.navigator||{},S=al({release:f,environment:p,user:u.getUser()||a.getUser(),...g&&{userAgent:g},...n}),P=a.getSession();return P&&P.status==="ok"&&Jt(P,{status:"exited"}),Tn(),a.setSession(S),u.setSession(S),S}function Tn(){let n=Me(),r=Re(),a=r.getSession()||n.getSession();a&&sl(a),ja(),n.setSession(),r.setSession()}function ja(){let n=Me(),r=Re(),a=pe(),u=r.getSession()||n.getSession();u&&a&&a.captureSession(u)}function pi(n=!1){if(n){Tn();return}ja()}let rf="7";function $a(n){let r=n.protocol?`${n.protocol}:`:"",a=n.port?`:${n.port}`:"";return`${r}//${n.host}${a}${n.path?`/${n.path}`:""}/api/`}function of(n){return`${$a(n)}${n.projectId}/envelope/`}function af(n,r){return lu({sentry_key:n.publicKey,sentry_version:rf,...r&&{sentry_client:`${r.name}/${r.version}`}})}function sf(n,r,a){return r||`${of(n)}?${af(n,a)}`}function cf(n,r){let a=Ko(n);if(!a)return"";let u=`${$a(a)}embed/error-page/`,f=`dsn=${Oe(a)}`;for(let p in r)if(p!=="dsn"&&p!=="onClose")if(p==="user"){let g=r.user;if(!g)continue;g.name&&(f+=`&name=${encodeURIComponent(g.name)}`),g.email&&(f+=`&email=${encodeURIComponent(g.email)}`)}else f+=`&${encodeURIComponent(p)}=${encodeURIComponent(r[p])}`;return`${u}?${f}`}let Ua=[];function uf(n){let r={};return n.forEach(a=>{let{name:u}=a,f=r[u];f&&!f.isDefaultInstance&&a.isDefaultInstance||(r[u]=a)}),Object.values(r)}function lf(n){let r=n.defaultIntegrations||[],a=n.integrations;r.forEach(g=>{g.isDefaultInstance=!0});let u;Array.isArray(a)?u=[...r,...a]:typeof a=="function"?u=ia(a(r)):u=r;let f=uf(u),p=f.findIndex(g=>g.name==="Debug");if(p>-1){let[g]=f.splice(p,1);f.push(g)}return f}function ff(n,r){let a={};return r.forEach(u=>{u&&Ha(n,u,a)}),a}function Ka(n,r){for(let a of r)a&&a.afterAllSetup&&a.afterAllSetup(n)}function Ha(n,r,a){if(a[r.name]){V.log(`Integration skipped because it was already installed: ${r.name}`);return}if(a[r.name]=r,Ua.indexOf(r.name)===-1&&typeof r.setupOnce=="function"&&(r.setupOnce(),Ua.push(r.name)),r.setup&&typeof r.setup=="function"&&r.setup(n),typeof r.preprocessEvent=="function"){let u=r.preprocessEvent.bind(r);n.on("preprocessEvent",(f,p)=>u(f,p,n))}if(typeof r.processEvent=="function"){let u=r.processEvent.bind(r),f=Object.assign((p,g)=>u(p,g,n),{id:r.name});n.addEventProcessor(f)}V.log(`Integration installed: ${r.name}`)}function df(n){let r=pe();if(!r){V.warn(`Cannot add integration "${n.name}" because no SDK Client is available.`);return}r.addIntegration(n)}function Sm(n){return n}let Va="Not capturing exception because it's already been captured.";class pf{constructor(r){if(this._options=r,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],r.dsn?this._dsn=Ko(r.dsn):V.warn("No DSN provided, client will not send events."),this._dsn){let a=sf(this._dsn,r.tunnel,r._metadata?r._metadata.sdk:void 0);this._transport=r.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...r.transportOptions,url:a})}}captureException(r,a,u){let f=Se();if(ra(r))return V.log(Va),f;let p={event_id:f,...a};return this._process(this.eventFromException(r,p).then(g=>this._captureEvent(g,p,u))),p.event_id}captureMessage(r,a,u,f){let p={event_id:Se(),...u},g=h(r)?r:String(r),S=m(r)?this.eventFromMessage(g,a,p):this.eventFromException(r,p);return this._process(S.then(P=>this._captureEvent(P,p,f))),p.event_id}captureEvent(r,a,u){let f=Se();if(a&&a.originalException&&ra(a.originalException))return V.log(Va),f;let p={event_id:f,...a},S=(r.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(r,p,S||u)),p.event_id}captureSession(r){typeof r.release!="string"?V.warn("Discarded session because of missing or non-string release"):(this.sendSession(r),Jt(r,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(r){let a=this._transport;return a?(this.emit("flush"),this._isClientDoneProcessing(r).then(u=>a.flush(r).then(f=>u&&f))):Mt(!0)}close(r){return this.flush(r).then(a=>(this.getOptions().enabled=!1,this.emit("close"),a))}getEventProcessors(){return this._eventProcessors}addEventProcessor(r){this._eventProcessors.push(r)}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationByName(r){return this._integrations[r]}addIntegration(r){let a=this._integrations[r.name];Ha(this,r,this._integrations),a||Ka(this,[r])}sendEvent(r,a={}){this.emit("beforeSendEvent",r,a);let u=Rl(r,this._dsn,this._options._metadata,this._options.tunnel);for(let p of a.attachments||[])u=Vu(u,zu(p));let f=this.sendEnvelope(u);f&&f.then(p=>this.emit("afterSendEvent",r,p),null)}sendSession(r){let a=Ol(r,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(a)}recordDroppedEvent(r,a,u){if(this._options.sendClientReports){let f=`${r}:${a}`;V.log(`Adding outcome: "${f}"`),this._outcomes[f]=(this._outcomes[f]||0)+1}}on(r,a){let u=this._hooks[r]=this._hooks[r]||[];return u.push(a),()=>{let f=u.indexOf(a);f>-1&&u.splice(f,1)}}emit(r,...a){let u=this._hooks[r];u&&u.forEach(f=>f(...a))}sendEnvelope(r){return this.emit("beforeEnvelope",r),this._isEnabled()&&this._transport?this._transport.send(r).then(null,a=>(V.error("Error while sending event:",a),a)):(V.error("Transport disabled"),Mt({}))}_setupIntegrations(){let{integrations:r}=this._options;this._integrations=ff(this,r),Ka(this,r)}_updateSessionFromEvent(r,a){let u=!1,f=!1,p=a.exception&&a.exception.values;if(p){f=!0;for(let P of p){let B=P.mechanism;if(B&&B.handled===!1){u=!0;break}}}let g=r.status==="ok";(g&&r.errors===0||g&&u)&&(Jt(r,{...u&&{status:"crashed"},errors:r.errors||Number(f||u)}),this.captureSession(r))}_isClientDoneProcessing(r){return new Xe(a=>{let u=0,f=1,p=setInterval(()=>{this._numProcessing==0?(clearInterval(p),a(!0)):(u+=f,r&&u>=r&&(clearInterval(p),a(!1)))},f)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(r,a,u,f=Me()){let p=this.getOptions(),g=Object.keys(this._integrations);return!a.integrations&&g.length>0&&(a.integrations=g),this.emit("preprocessEvent",r,a),r.type||f.setLastEventId(r.event_id||a.event_id),Ul(p,r,a,u,this,f).then(S=>{if(S===null)return S;let P={...f.getPropagationContext(),...u?u.getPropagationContext():void 0};if(!(S.contexts&&S.contexts.trace)&&P){let{traceId:J,spanId:Y,parentSpanId:ie,dsc:le}=P;S.contexts={trace:Je({trace_id:J,span_id:Y,parent_span_id:ie}),...S.contexts};let ce=le||Ca(J,this);S.sdkProcessingMetadata={dynamicSamplingContext:ce,...S.sdkProcessingMetadata}}return S})}_captureEvent(r,a={},u){return this._processEvent(r,a,u).then(f=>f.event_id,f=>{{let p=f;p.logLevel==="log"?V.log(p.message):V.warn(p)}})}_processEvent(r,a,u){let f=this.getOptions(),{sampleRate:p}=f,g=hi(r),S=Wa(r),P=r.type||"error",B=`before send for type \`${P}\``,J=typeof p>"u"?void 0:Pl(p);if(S&&typeof J=="number"&&Math.random()>J)return this.recordDroppedEvent("sample_rate","error",r),tr(new nt(`Discarding event because it's not included in the random sample (sampling rate = ${p})`,"log"));let Y=P==="replay_event"?"replay":P,le=(r.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(r,a,u,le).then(ce=>{if(ce===null)throw this.recordDroppedEvent("event_processor",Y,r),new nt("An event processor returned `null`, will not send event.","log");if(a.data&&a.data.__sentry__===!0)return ce;let Ne=mf(this,f,ce,a);return hf(Ne,B)}).then(ce=>{if(ce===null){if(this.recordDroppedEvent("before_send",Y,r),hi(r)){let op=1+(r.spans||[]).length;this._outcomes.span=(this._outcomes.span||0)+op}throw new nt(`${B} returned \`null\`, will not send event.`,"log")}let dr=u&&u.getSession();!g&&dr&&this._updateSessionFromEvent(dr,ce);let Ne=ce.transaction_info;if(g&&Ne&&ce.transaction!==r.transaction){let ks="custom";ce.transaction_info={...Ne,source:ks}}return this.sendEvent(ce,a),ce}).then(null,ce=>{throw ce instanceof nt?ce:(this.captureException(ce,{data:{__sentry__:!0},originalException:ce}),new nt(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${ce}`))})}_process(r){this._numProcessing++,r.then(a=>(this._numProcessing--,a),a=>(this._numProcessing--,a))}_clearOutcomes(){let r=this._outcomes;return this._outcomes={},Object.entries(r).map(([a,u])=>{let[f,p]=a.split(":");return{reason:f,category:p,quantity:u}})}}function hf(n,r){let a=`${r} must return \`null\` or a valid event.`;if(_(n))return n.then(u=>{if(!b(u)&&u!==null)throw new nt(a);return u},u=>{throw new nt(`${r} rejected with ${u}`)});if(!b(n)&&n!==null)throw new nt(a);return n}function mf(n,r,a,u){let{beforeSend:f,beforeSendTransaction:p,beforeSendSpan:g}=r;if(Wa(a)&&f)return f(a,u);if(hi(a)){if(a.spans&&g){let S=[];for(let P of a.spans){let B=g(P);B?S.push(B):n.recordDroppedEvent("before_send","span")}a.spans=S}if(p)return p(a,u)}return a}function Wa(n){return n.type===void 0}function hi(n){return n.type==="transaction"}function gf(n,r){r.debug===!0&&V.enable(),Re().update(r.initialScope);let u=new n(r);return Ga(u),u.init(),u}function Ga(n){Re().setClient(n)}let yf=64;function za(n,r,a=Ou(n.bufferSize||yf)){let u={},f=g=>a.drain(g);function p(g){let S=[];if(ua(g,(Y,ie)=>{let le=la(ie);if(el(u,le)){let ce=Ya(Y,ie);n.recordDroppedEvent("ratelimit_backoff",le,ce)}else S.push(Y)}),S.length===0)return Mt({});let P=Sn(g[0],S),B=Y=>{ua(P,(ie,le)=>{let ce=Ya(ie,le);n.recordDroppedEvent(Y,la(le),ce)})},J=()=>r({body:Wu(P)}).then(Y=>(Y.statusCode!==void 0&&(Y.statusCode<200||Y.statusCode>=300)&&V.warn(`Sentry responded with status code ${Y.statusCode} to sent event.`),u=tl(u,Y),Y),Y=>{throw B("network_error"),Y});return a.add(J).then(Y=>Y,Y=>{if(Y instanceof nt)return V.error("Skipped sending event because buffer is full."),B("queue_overflow"),Mt({});throw Y})}return{send:p,flush:f}}function Ya(n,r){if(!(r!=="event"&&r!=="transaction"))return Array.isArray(n)?n[1]:void 0}function vf(n,...r){let a=new String(String.raw(n,...r));return a.__sentry_template_string__=n.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),a.__sentry_template_values__=r,a}function bf(n,r,a=[r],u="npm"){let f=n._metadata||{};f.sdk||(f.sdk={name:`sentry.javascript.${r}`,packages:a.map(p=>({name:`${u}:@sentry/${p}`,version:M})),version:M}),n._metadata=f}let _f=100;function ft(n,r){let a=pe(),u=Me();if(!a)return;let{beforeBreadcrumb:f=null,maxBreadcrumbs:p=_f}=a.getOptions();if(p<=0)return;let S={timestamp:_n(),...n},P=f?U(()=>f(S,r)):S;P!==null&&(a.emit&&a.emit("beforeAddBreadcrumb",P,r),u.addBreadcrumb(P,p))}let Ja,wf="FunctionToString",Xa=new WeakMap,qa=()=>({name:wf,setupOnce(){Ja=Function.prototype.toString;try{Function.prototype.toString=function(...n){let r=Qr(this),a=Xa.has(pe())&&r!==void 0?r:this;return Ja.apply(a,n)}}catch{}},setup(n){Xa.set(n,!0)}}),Sf=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],Ef="InboundFilters",Qa=(n={})=>({name:Ef,processEvent(r,a,u){let f=u.getOptions(),p=If(n,f);return xf(r,p)?null:r}});function If(n={},r={}){return{allowUrls:[...n.allowUrls||[],...r.allowUrls||[]],denyUrls:[...n.denyUrls||[],...r.denyUrls||[]],ignoreErrors:[...n.ignoreErrors||[],...r.ignoreErrors||[],...n.disableErrorDefaults?[]:Sf],ignoreTransactions:[...n.ignoreTransactions||[],...r.ignoreTransactions||[]],ignoreInternal:n.ignoreInternal!==void 0?n.ignoreInternal:!0}}function xf(n,r){return r.ignoreInternal&&Df(n)?(V.warn(`Event dropped due to being internal Sentry Error.
Event: ${yt(n)}`),!0):Tf(n,r.ignoreErrors)?(V.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${yt(n)}`),!0):Rf(n)?(V.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${yt(n)}`),!0):Cf(n,r.ignoreTransactions)?(V.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${yt(n)}`),!0):kf(n,r.denyUrls)?(V.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${yt(n)}.
Url: ${sr(n)}`),!0):Af(n,r.allowUrls)?!1:(V.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${yt(n)}.
Url: ${sr(n)}`),!0)}function Tf(n,r){return n.type||!r||!r.length?!1:Pf(n).some(a=>k(a,r))}function Cf(n,r){if(n.type!=="transaction"||!r||!r.length)return!1;let a=n.transaction;return a?k(a,r):!1}function kf(n,r){if(!r||!r.length)return!1;let a=sr(n);return a?k(a,r):!1}function Af(n,r){if(!r||!r.length)return!0;let a=sr(n);return a?k(a,r):!0}function Pf(n){let r=[];n.message&&r.push(n.message);let a;try{a=n.exception.values[n.exception.values.length-1]}catch{}return a&&a.value&&(r.push(a.value),a.type&&r.push(`${a.type}: ${a.value}`)),r}function Df(n){try{return n.exception.values[0].type==="SentryError"}catch{}return!1}function Of(n=[]){for(let r=n.length-1;r>=0;r--){let a=n[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}function sr(n){try{let r;try{r=n.exception.values[0].stacktrace.frames}catch{}return r?Of(r):null}catch{return V.error(`Cannot extract url for event ${yt(n)}`),null}}function Rf(n){return n.type||!n.exception||!n.exception.values||n.exception.values.length===0?!1:!n.message&&!n.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value)}let Ff="Dedupe",Za=()=>{let n;return{name:Ff,processEvent(r){if(r.type)return r;try{if(Mf(r,n))return V.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return n=r}}};function Mf(n,r){return r?!!(Nf(n,r)||Lf(n,r)):!1}function Nf(n,r){let a=n.message,u=r.message;return!(!a&&!u||a&&!u||!a&&u||a!==u||!ts(n,r)||!es(n,r))}function Lf(n,r){let a=ns(r),u=ns(n);return!(!a||!u||a.type!==u.type||a.value!==u.value||!ts(n,r)||!es(n,r))}function es(n,r){let a=qo(n),u=qo(r);if(!a&&!u)return!0;if(a&&!u||!a&&u||(a=a,u=u,u.length!==a.length))return!1;for(let f=0;f<u.length;f++){let p=u[f],g=a[f];if(p.filename!==g.filename||p.lineno!==g.lineno||p.colno!==g.colno||p.function!==g.function)return!1}return!0}function ts(n,r){let a=n.fingerprint,u=r.fingerprint;if(!a&&!u)return!0;if(a&&!u||!a&&u)return!1;a=a,u=u;try{return a.join("")===u.join("")}catch{return!1}}function ns(n){return n.exception&&n.exception.values&&n.exception.values[0]}function Bf(){return{bindClient(n){Re().setClient(n)},withScope:ir,getClient:()=>pe(),getScope:Re,getIsolationScope:Me,captureException:(n,r)=>Re().captureException(n,r),captureMessage:(n,r,a)=>Re().captureMessage(n,r,a),captureEvent:or,addBreadcrumb:ft,setUser:La,setTags:Ma,setTag:Na,setExtra:Fa,setExtras:Ra,setContext:Oa,getIntegration(n){let r=pe();return r&&r.getIntegrationByName(n.id)||null},startSession:ar,endSession:Tn,captureSession(n){if(n)return Tn();$f()}}}let jf=Bf;function $f(){let n=Re(),r=pe(),a=n.getSession();r&&a&&r.captureSession(a)}let Uf=n=>(U(()=>{console.warn("You are using browserTracingIntegration() even though this bundle does not include tracing.")}),{name:"BrowserTracing"});function Cn(){U(()=>{console.warn("You are using metrics even though this bundle does not include tracing.")})}let Kf={increment:Cn,distribution:Cn,set:Cn,gauge:Cn,timing:(n,r)=>{if(Cn(),typeof r=="function")return r()}},ne=D,mi=0;function rs(){return mi>0}function Hf(){mi++,setTimeout(()=>{mi--})}function qt(n,r={},a){if(typeof n!="function")return n;try{let f=n.__sentry_wrapped__;if(f)return f;if(Qr(n))return n}catch{return n}let u=function(){let f=Array.prototype.slice.call(arguments);try{a&&typeof a=="function"&&a.apply(this,arguments);let p=f.map(g=>qt(g,r));return n.apply(this,p)}catch(p){throw Hf(),ir(g=>{g.addEventProcessor(S=>(r.mechanism&&(ii(S,void 0,void 0),wn(S,r.mechanism)),S.extra={...S.extra,arguments:f},S)),Da(p)}),p}};try{for(let f in n)Object.prototype.hasOwnProperty.call(n,f)&&(u[f]=n[f])}catch{}Ho(u,n),Ot(n,"__sentry_wrapped__",u);try{Object.getOwnPropertyDescriptor(u,"name").configurable&&Object.defineProperty(u,"name",{get(){return n.name}})}catch{}return u}function cr(n,r){let a=yi(n,r),u={type:r&&r.name,value:Yf(r)};return a.length&&(u.stacktrace={frames:a}),u.type===void 0&&u.value===""&&(u.value="Unrecoverable error caught"),u}function Vf(n,r,a,u){let f=pe(),p=f&&f.getOptions().normalizeDepth,g=qf(r),S={__serialized__:oa(r,p)};if(g)return{exception:{values:[cr(n,g)]},extra:S};let P={exception:{values:[{type:v(r)?r.constructor.name:u?"UnhandledRejection":"Error",value:Jf(r,{isUnhandledRejection:u})}]},extra:S};if(a){let B=yi(n,a);B.length&&(P.exception.values[0].stacktrace={frames:B})}return P}function gi(n,r){return{exception:{values:[cr(n,r)]}}}function yi(n,r){let a=r.stacktrace||r.stack||"",u=Gf(r),f=zf(r);try{return n(a,u,f)}catch{}return[]}let Wf=/Minified React error #\d+;/i;function Gf(n){return n&&Wf.test(n.message)?1:0}function zf(n){return typeof n.framesToPop=="number"?n.framesToPop:0}function Yf(n){let r=n&&n.message;return r?r.error&&typeof r.error.message=="string"?r.error.message:r:"No error message"}function is(n,r,a,u){let f=a&&a.syntheticException||void 0,p=vi(n,r,f,u);return wn(p),p.level="error",a&&a.event_id&&(p.event_id=a.event_id),Mt(p)}function os(n,r,a="info",u,f){let p=u&&u.syntheticException||void 0,g=bi(n,r,p,f);return g.level=a,u&&u.event_id&&(g.event_id=u.event_id),Mt(g)}function vi(n,r,a,u,f){let p;if(s(r)&&r.error)return gi(n,r.error);if(c(r)||l(r)){let g=r;if("stack"in r)p=gi(n,r);else{let S=g.name||(c(g)?"DOMError":"DOMException"),P=g.message?`${S}: ${g.message}`:S;p=bi(n,P,a,u),ii(p,P)}return"code"in g&&(p.tags={...p.tags,"DOMException.code":`${g.code}`}),p}return i(r)?gi(n,r):b(r)||v(r)?(p=Vf(n,r,a,f),wn(p,{synthetic:!0}),p):(p=bi(n,r,a,u),ii(p,`${r}`,void 0),wn(p,{synthetic:!0}),p)}function bi(n,r,a,u){let f={};if(u&&a){let p=yi(n,a);p.length&&(f.exception={values:[{value:r,stacktrace:{frames:p}}]})}if(h(r)){let{__sentry_template_string__:p,__sentry_template_values__:g}=r;return f.logentry={message:p,params:g},f}return f.message=r,f}function Jf(n,{isUnhandledRejection:r}){let a=fu(n),u=r?"promise rejection":"exception";return s(n)?`Event \`ErrorEvent\` captured as ${u} with message \`${n.message}\``:v(n)?`Event \`${Xf(n)}\` (type=${n.type}) captured as ${u}`:`Object captured as ${u} with keys: ${a}`}function Xf(n){try{let r=Object.getPrototypeOf(n);return r?r.constructor.name:void 0}catch{}}function qf(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let a=n[r];if(a instanceof Error)return a}}function as(n,{metadata:r,tunnel:a,dsn:u}){let f={event_id:n.event_id,sent_at:new Date().toISOString(),...r&&r.sdk&&{sdk:{name:r.sdk.name,version:r.sdk.version}},...!!a&&!!u&&{dsn:Oe(u)}},p=Qf(n);return Sn(f,[p])}function Qf(n){return[{type:"user_report"},n]}class ss extends pf{constructor(r){let a={parentSpanIsAlwaysRootSpan:!0,...r},u=ne.SENTRY_SDK_SOURCE||Tu();bf(a,"browser",["browser"],u),super(a),a.sendClientReports&&ne.document&&ne.document.addEventListener("visibilitychange",()=>{ne.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(r,a){return is(this._options.stackParser,r,a,this._options.attachStacktrace)}eventFromMessage(r,a="info",u){return os(this._options.stackParser,r,a,u,this._options.attachStacktrace)}captureUserFeedback(r){if(!this._isEnabled()){V.warn("SDK not enabled, will not capture user feedback.");return}let a=as(r,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(a)}_prepareEvent(r,a,u){return r.platform=r.platform||"javascript",super._prepareEvent(r,a,u)}_flushOutcomes(){let r=this._clearOutcomes();if(r.length===0){V.log("No outcomes to send");return}if(!this._dsn){V.log("No dsn provided, will not send outcomes");return}V.log("Sending outcomes:",r);let a=Xu(r,this._options.tunnel&&Oe(this._dsn));this.sendEnvelope(a)}}let Fe=D,Zf=1e3,cs,_i,wi;function ed(n){let r="dom";Rt(r,n),Ft(r,td)}function td(){if(!Fe.document)return;let n=et.bind(null,"dom"),r=us(n,!0);Fe.document.addEventListener("click",r,!1),Fe.document.addEventListener("keypress",r,!1),["EventTarget","Node"].forEach(a=>{let u=Fe[a]&&Fe[a].prototype;!u||!u.hasOwnProperty||!u.hasOwnProperty("addEventListener")||(Te(u,"addEventListener",function(f){return function(p,g,S){if(p==="click"||p=="keypress")try{let P=this,B=P.__sentry_instrumentation_handlers__=P.__sentry_instrumentation_handlers__||{},J=B[p]=B[p]||{refCount:0};if(!J.handler){let Y=us(n);J.handler=Y,f.call(this,p,Y,S)}J.refCount++}catch{}return f.call(this,p,g,S)}}),Te(u,"removeEventListener",function(f){return function(p,g,S){if(p==="click"||p=="keypress")try{let P=this,B=P.__sentry_instrumentation_handlers__||{},J=B[p];J&&(J.refCount--,J.refCount<=0&&(f.call(this,p,J.handler,S),J.handler=void 0,delete B[p]),Object.keys(B).length===0&&delete P.__sentry_instrumentation_handlers__)}catch{}return f.call(this,p,g,S)}}))})}function nd(n){if(n.type!==_i)return!1;try{if(!n.target||n.target._sentryId!==wi)return!1}catch{}return!0}function rd(n,r){return n!=="keypress"?!1:!r||!r.tagName?!0:!(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable)}function us(n,r=!1){return a=>{if(!a||a._sentryCaptured)return;let u=id(a);if(rd(a.type,u))return;Ot(a,"_sentryCaptured",!0),u&&!u._sentryId&&Ot(u,"_sentryId",Se());let f=a.type==="keypress"?"input":a.type;nd(a)||(n({event:a,name:f,global:r}),_i=a.type,wi=u?u._sentryId:void 0),clearTimeout(cs),cs=Fe.setTimeout(()=>{wi=void 0,_i=void 0},Zf)}}function id(n){try{return n.target}catch{return null}}let ur;function ls(n){let r="history";Rt(r,n),Ft(r,od)}function od(){if(!nl())return;let n=Fe.onpopstate;Fe.onpopstate=function(...a){let u=Fe.location.href,f=ur;if(ur=u,et("history",{from:f,to:u}),n)try{return n.apply(this,a)}catch{}};function r(a){return function(...u){let f=u.length>2?u[2]:void 0;if(f){let p=ur,g=String(f);ur=g,et("history",{from:p,to:g})}return a.apply(this,u)}}Te(Fe.history,"pushState",r),Te(Fe.history,"replaceState",r)}let lr={};function ad(n){let r=lr[n];if(r)return r;let a=Fe[n];if(ni(a))return lr[n]=a.bind(Fe);let u=Fe.document;if(u&&typeof u.createElement=="function")try{let f=u.createElement("iframe");f.hidden=!0,u.head.appendChild(f);let p=f.contentWindow;p&&p[n]&&(a=p[n]),u.head.removeChild(f)}catch(f){V.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,f)}return a&&(lr[n]=a.bind(Fe))}function fs(n){lr[n]=void 0}let kn="__sentry_xhr_v3__";function sd(n){let r="xhr";Rt(r,n),Ft(r,cd)}function cd(){if(!Fe.XMLHttpRequest)return;let n=XMLHttpRequest.prototype;Te(n,"open",function(r){return function(...a){let u=ct()*1e3,f=d(a[0])?a[0].toUpperCase():void 0,p=ud(a[1]);if(!f||!p)return r.apply(this,a);this[kn]={method:f,url:p,request_headers:{}},f==="POST"&&p.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let g=()=>{let S=this[kn];if(S&&this.readyState===4){try{S.status_code=this.status}catch{}let P={endTimestamp:ct()*1e3,startTimestamp:u,xhr:this};et("xhr",P)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?Te(this,"onreadystatechange",function(S){return function(...P){return g(),S.apply(this,P)}}):this.addEventListener("readystatechange",g),Te(this,"setRequestHeader",function(S){return function(...P){let[B,J]=P,Y=this[kn];return Y&&d(B)&&d(J)&&(Y.request_headers[B.toLowerCase()]=J),S.apply(this,P)}}),r.apply(this,a)}}),Te(n,"send",function(r){return function(...a){let u=this[kn];if(!u)return r.apply(this,a);a[0]!==void 0&&(u.body=a[0]);let f={startTimestamp:ct()*1e3,xhr:this};return et("xhr",f),r.apply(this,a)}})}function ud(n){if(d(n))return n;try{return n.toString()}catch{}}function ds(n,r=ad("fetch")){let a=0,u=0;function f(p){let g=p.body.length;a+=g,u++;let S={body:p.body,method:"POST",referrerPolicy:"origin",headers:n.headers,keepalive:a<=6e4&&u<15,...n.fetchOptions};if(!r)return fs("fetch"),tr("No fetch implementation available");try{return r(n.url,S).then(P=>(a-=g,u--,{statusCode:P.status,headers:{"x-sentry-rate-limits":P.headers.get("X-Sentry-Rate-Limits"),"retry-after":P.headers.get("Retry-After")}}))}catch(P){return fs("fetch"),a-=g,u--,tr(P)}}return za(n,f)}let ld=10,fd=20,dd=30,pd=40,hd=50;function Qt(n,r,a,u){let f={filename:n,function:r==="<anonymous>"?rt:r,in_app:!0};return a!==void 0&&(f.lineno=a),u!==void 0&&(f.colno=u),f}let md=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,gd=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,yd=/\((\S*)(?::(\d+))(?::(\d+))\)/,ps=[dd,n=>{let r=md.exec(n);if(r){let[,u,f,p]=r;return Qt(u,rt,+f,+p)}let a=gd.exec(n);if(a){if(a[2]&&a[2].indexOf("eval")===0){let g=yd.exec(a[2]);g&&(a[2]=g[1],a[3]=g[2],a[4]=g[3])}let[f,p]=ys(a[1]||rt,a[2]);return Qt(p,f,a[3]?+a[3]:void 0,a[4]?+a[4]:void 0)}}],vd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,bd=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,hs=[hd,n=>{let r=vd.exec(n);if(r){if(r[3]&&r[3].indexOf(" > eval")>-1){let p=bd.exec(r[3]);p&&(r[1]=r[1]||"eval",r[3]=p[1],r[4]=p[2],r[5]="")}let u=r[3],f=r[1]||rt;return[f,u]=ys(f,u),Qt(u,f,r[4]?+r[4]:void 0,r[5]?+r[5]:void 0)}}],_d=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,wd=[pd,n=>{let r=_d.exec(n);return r?Qt(r[2],r[1]||rt,+r[3],r[4]?+r[4]:void 0):void 0}],Sd=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,Ed=[ld,n=>{let r=Sd.exec(n);return r?Qt(r[2],r[3]||rt,+r[1]):void 0}],Id=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,xd=[fd,n=>{let r=Id.exec(n);return r?Qt(r[5],r[3]||r[4]||rt,+r[1],+r[2]):void 0}],ms=[ps,hs],gs=Xo(...ms),ys=(n,r)=>{let a=n.indexOf("safari-extension")!==-1,u=n.indexOf("safari-web-extension")!==-1;return a||u?[n.indexOf("@")!==-1?n.split("@")[0]:rt,a?`safari-extension:${r}`:`safari-web-extension:${r}`]:[n,r]},fr=1024,Td="Breadcrumbs",vs=(n={})=>{let r={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...n};return{name:Td,setup(a){r.console&&mu(Ad(a)),r.dom&&ed(kd(a,r.dom)),r.xhr&&sd(Pd(a)),r.fetch&&bu(Dd(a)),r.history&&ls(Od(a)),r.sentry&&a.on("beforeSendEvent",Cd(a))}}};function Cd(n){return function(a){pe()===n&&ft({category:`sentry.${a.type==="transaction"?"transaction":"event"}`,event_id:a.event_id,level:a.level,message:yt(a)},{event:a})}}function kd(n,r){return function(u){if(pe()!==n)return;let f,p,g=typeof r=="object"?r.serializeAttribute:void 0,S=typeof r=="object"&&typeof r.maxStringLength=="number"?r.maxStringLength:void 0;S&&S>fr&&(V.warn(`\`dom.maxStringLength\` cannot exceed ${fr}, but a value of ${S} was configured. Sentry will use ${fr} instead.`),S=fr),typeof g=="string"&&(g=[g]);try{let B=u.event,J=Rd(B)?B.target:B;f=G(J,{keyAttrs:g,maxStringLength:S}),p=be(J)}catch{f="<unknown>"}if(f.length===0)return;let P={category:`ui.${u.name}`,message:f};p&&(P.data={"ui.component_name":p}),ft(P,{event:u.event,name:u.name,global:u.global})}}function Ad(n){return function(a){if(pe()!==n)return;let u={category:"console",data:{arguments:a.args,logger:"console"},level:Fu(a.level),message:C(a.args," ")};if(a.level==="assert")if(a.args[0]===!1)u.message=`Assertion failed: ${C(a.args.slice(1)," ")||"console.assert"}`,u.data.arguments=a.args.slice(1);else return;ft(u,{input:a.args,level:a.level})}}function Pd(n){return function(a){if(pe()!==n)return;let{startTimestamp:u,endTimestamp:f}=a,p=a.xhr[kn];if(!u||!f||!p)return;let{method:g,url:S,status_code:P,body:B}=p,J={method:g,url:S,status_code:P},Y={xhr:a.xhr,input:B,startTimestamp:u,endTimestamp:f};ft({category:"xhr",data:J,type:"http"},Y)}}function Dd(n){return function(a){if(pe()!==n)return;let{startTimestamp:u,endTimestamp:f}=a;if(f&&!(a.fetchData.url.match(/sentry_key/)&&a.fetchData.method==="POST"))if(a.error){let p=a.fetchData,g={data:a.error,input:a.args,startTimestamp:u,endTimestamp:f};ft({category:"fetch",data:p,level:"error",type:"http"},g)}else{let p=a.response,g={...a.fetchData,status_code:p&&p.status},S={input:a.args,response:p,startTimestamp:u,endTimestamp:f};ft({category:"fetch",data:g,type:"http"},S)}}}function Od(n){return function(a){if(pe()!==n)return;let u=a.from,f=a.to,p=ai(ne.location.href),g=u?ai(u):void 0,S=ai(f);(!g||!g.path)&&(g=p),p.protocol===S.protocol&&p.host===S.host&&(f=S.relative),p.protocol===g.protocol&&p.host===g.host&&(u=g.relative),ft({category:"navigation",data:{from:u,to:f}})}}function Rd(n){return!!n&&!!n.target}let Fd=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Md="BrowserApiErrors",bs=(n={})=>{let r={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...n};return{name:Md,setupOnce(){r.setTimeout&&Te(ne,"setTimeout",_s),r.setInterval&&Te(ne,"setInterval",_s),r.requestAnimationFrame&&Te(ne,"requestAnimationFrame",Nd),r.XMLHttpRequest&&"XMLHttpRequest"in ne&&Te(XMLHttpRequest.prototype,"send",Ld);let a=r.eventTarget;a&&(Array.isArray(a)?a:Fd).forEach(Bd)}}};function _s(n){return function(...r){let a=r[0];return r[0]=qt(a,{mechanism:{data:{function:gt(n)},handled:!1,type:"instrument"}}),n.apply(this,r)}}function Nd(n){return function(r){return n.apply(this,[qt(r,{mechanism:{data:{function:"requestAnimationFrame",handler:gt(n)},handled:!1,type:"instrument"}})])}}function Ld(n){return function(...r){let a=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(f=>{f in a&&typeof a[f]=="function"&&Te(a,f,function(p){let g={mechanism:{data:{function:f,handler:gt(p)},handled:!1,type:"instrument"}},S=Qr(p);return S&&(g.mechanism.data.handler=gt(S)),qt(p,g)})}),n.apply(this,r)}}function Bd(n){let r=ne,a=r[n]&&r[n].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(Te(a,"addEventListener",function(u){return function(f,p,g){try{typeof p.handleEvent=="function"&&(p.handleEvent=qt(p.handleEvent,{mechanism:{data:{function:"handleEvent",handler:gt(p),target:n},handled:!1,type:"instrument"}}))}catch{}return u.apply(this,[f,qt(p,{mechanism:{data:{function:"addEventListener",handler:gt(p),target:n},handled:!1,type:"instrument"}}),g])}}),Te(a,"removeEventListener",function(u){return function(f,p,g){let S=p;try{let P=S&&S.__sentry_wrapped__;P&&u.call(this,f,P,g)}catch{}return u.call(this,f,S,g)}}))}let jd="GlobalHandlers",ws=(n={})=>{let r={onerror:!0,onunhandledrejection:!0,...n};return{name:jd,setupOnce(){Error.stackTraceLimit=50},setup(a){r.onerror&&($d(a),Ss("onerror")),r.onunhandledrejection&&(Ud(a),Ss("onunhandledrejection"))}}};function $d(n){Su(r=>{let{stackParser:a,attachStacktrace:u}=Es();if(pe()!==n||rs())return;let{msg:f,url:p,line:g,column:S,error:P}=r,B=Vd(vi(a,P||f,void 0,u,!1),p,g,S);B.level="error",or(B,{originalException:P,mechanism:{handled:!1,type:"onerror"}})})}function Ud(n){Iu(r=>{let{stackParser:a,attachStacktrace:u}=Es();if(pe()!==n||rs())return;let f=Kd(r),p=m(f)?Hd(f):vi(a,f,void 0,u,!0);p.level="error",or(p,{originalException:f,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Kd(n){if(m(n))return n;try{if("reason"in n)return n.reason;if("detail"in n&&"reason"in n.detail)return n.detail.reason}catch{}return n}function Hd(n){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}}}function Vd(n,r,a,u){let f=n.exception=n.exception||{},p=f.values=f.values||[],g=p[0]=p[0]||{},S=g.stacktrace=g.stacktrace||{},P=S.frames=S.frames||[],B=isNaN(parseInt(u,10))?void 0:u,J=isNaN(parseInt(a,10))?void 0:a,Y=d(r)&&r.length>0?r:ve();return P.length===0&&P.push({colno:B,filename:Y,function:rt,in_app:!0,lineno:J}),n}function Ss(n){V.log(`Global Handler attached: ${n}`)}function Es(){let n=pe();return n&&n.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}let Is=()=>({name:"HttpContext",preprocessEvent(n){if(!ne.navigator&&!ne.location&&!ne.document)return;let r=n.request&&n.request.url||ne.location&&ne.location.href,{referrer:a}=ne.document||{},{userAgent:u}=ne.navigator||{},f={...n.request&&n.request.headers,...a&&{Referer:a},...u&&{"User-Agent":u}},p={...n.request,...r&&{url:r},headers:f};n.request=p}}),Wd="cause",Gd=5,zd="LinkedErrors",xs=(n={})=>{let r=n.limit||Gd,a=n.key||Wd;return{name:zd,preprocessEvent(u,f,p){let g=p.getOptions();F(cr,g.stackParser,g.maxValueLength,a,r,u,f)}}};function Ts(n){return[Qa(),qa(),bs(),vs(),ws(),xs(),Za(),Is()]}function Yd(n={}){return{...{defaultIntegrations:Ts(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:ne.SENTRY_RELEASE&&ne.SENTRY_RELEASE.id?ne.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0},...n}}function Jd(){let n=ne,r=n.chrome?"chrome":"browser",a=n[r],u=a&&a.runtime&&a.runtime.id,f=ne.location&&ne.location.href||"",p=["chrome-extension:","moz-extension:","ms-browser-extension:"],g=!!u&&ne===ne.top&&p.some(P=>f.startsWith(`${P}//`)),S=typeof n.nw<"u";return!!u&&!g&&!S}function Xd(n={}){let r=Yd(n);if(Jd()){U(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}Zo()||V.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");let a={...r,stackParser:pu(r.stackParser||gs),integrations:lf(r),transport:r.transport||ds},u=gf(ss,a);return r.autoSessionTracking&&ep(),u}function qd(n={}){if(!ne.document){V.error("Global document not defined in showReportDialog call");return}let r=Re(),a=r.getClient(),u=a&&a.getDsn();if(!u){V.error("DSN not configured for showReportDialog call");return}if(r&&(n.user={...r.getUser(),...n.user}),!n.eventId){let S=Ba();S&&(n.eventId=S)}let f=ne.document.createElement("script");f.async=!0,f.crossOrigin="anonymous",f.src=cf(u,n),n.onLoad&&(f.onload=n.onLoad);let{onClose:p}=n;if(p){let S=P=>{if(P.data==="__sentry_reportdialog_closed__")try{p()}finally{ne.removeEventListener("message",S)}};ne.addEventListener("message",S)}let g=ne.document.head||ne.document.body;g?g.appendChild(f):V.error("Not injecting report dialog. No injection point found in HTML")}function Qd(){}function Zd(n){n()}function ep(){if(typeof ne.document>"u"){V.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}ar({ignoreDuration:!0}),pi(),ls(({from:n,to:r})=>{n!==void 0&&n!==r&&(ar({ignoreDuration:!0}),pi())})}function tp(n){let r=pe();r&&r.captureUserFeedback(n)}let np={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",debugIntegration:"debug",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",sessionTimingIntegration:"sessiontiming",browserProfilingIntegration:"browserprofiling"},Cs=ne;async function rp(n){let r=np[n],a=Cs.Sentry=Cs.Sentry||{};if(!r)throw new Error(`Cannot lazy load integration: ${n}`);let u=a[n];if(typeof u=="function")return u;let f=ip(r),p=ne.document.createElement("script");p.src=f,p.crossOrigin="anonymous",p.referrerPolicy="origin";let g=new Promise((P,B)=>{p.addEventListener("load",()=>P()),p.addEventListener("error",B)});ne.document.body.appendChild(p);try{await g}catch{throw new Error(`Error when loading integration: ${n}`)}let S=a[n];if(typeof S!="function")throw new Error(`Could not load integration: ${n}`);return S}function ip(n){let r=pe(),a=r&&r.getOptions(),u=a&&a.cdnBaseUrl||"https://browser.sentry-cdn.com";return new URL(`/${M}/${n}.min.js`,u).toString()}return e.BrowserClient=ss,e.SDK_VERSION=M,e.SEMANTIC_ATTRIBUTE_SENTRY_OP=wa,e.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=Sa,e.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=_a,e.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=ba,e.Scope=lt,e.WINDOW=ne,e.addBreadcrumb=ft,e.addEventProcessor=nf,e.addIntegration=df,e.breadcrumbsIntegration=vs,e.browserApiErrorsIntegration=bs,e.browserTracingIntegration=Uf,e.captureEvent=or,e.captureException=Da,e.captureMessage=Ql,e.captureSession=pi,e.captureUserFeedback=tp,e.chromeStackLineParser=ps,e.close=ef,e.continueTrace=Fl,e.createTransport=za,e.createUserFeedbackEnvelope=as,e.dedupeIntegration=Za,e.defaultStackLineParsers=ms,e.defaultStackParser=gs,e.endSession=Tn,e.eventFromException=is,e.eventFromMessage=os,e.exceptionFromError=cr,e.feedbackAsyncIntegration=ha,e.feedbackIntegration=ha,e.flush=Zl,e.forceLoad=Qd,e.functionToStringIntegration=qa,e.geckoStackLineParser=hs,e.getClient=pe,e.getCurrentHub=jf,e.getCurrentScope=Re,e.getDefaultIntegrations=Ts,e.getGlobalScope=va,e.getIsolationScope=Me,e.globalHandlersIntegration=ws,e.httpContextIntegration=Is,e.inboundFiltersIntegration=Qa,e.init=Xd,e.isInitialized=tf,e.lastEventId=Ba,e.lazyLoadIntegration=rp,e.linkedErrorsIntegration=xs,e.makeFetchTransport=ds,e.metrics=Kf,e.onLoad=Zd,e.opera10StackLineParser=Ed,e.opera11StackLineParser=xd,e.parameterize=vf,e.replayIntegration=ol,e.setContext=Oa,e.setCurrentClient=Ga,e.setExtra=Fa,e.setExtras=Ra,e.setTag=Na,e.setTags=Ma,e.setUser=La,e.showReportDialog=qd,e.spanToBaggageHeader=Al,e.spanToJSON=In,e.spanToTraceHeader=El,e.startSession=ar,e.winjsStackLineParser=wd,e.withIsolationScope=gl,e.withScope=ir,e}({});var Si,An,Ps,Ds,Os,ap,Pn,Ce,ke,Ae,Pe,Ei,Ii,pr,xi,Rs,Fs,dt,hr;dt=function(e,t){var i,o;return i=(e&65535)+(t&65535),o=(e>>16)+(t>>16)+(i>>16),o<<16|i&65535};Ps=function(e,t){return e<<t|e>>>32-t};Pn=function(e,t,i,o,s,c){return dt(Ps(dt(dt(t,e),dt(o,c)),s),i)};Ce=function(e,t,i,o,s,c,l){return Pn(t&i|~t&o,e,t,s,c,l)};ke=function(e,t,i,o,s,c,l){return Pn(t&o|i&~o,e,t,s,c,l)};Ae=function(e,t,i,o,s,c,l){return Pn(t^i^o,e,t,s,c,l)};Pe=function(e,t,i,o,s,c,l){return Pn(i^(t|~o),e,t,s,c,l)};An=function(e,t){var i,o,s,c,l,d,h,m,b;for(e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t,l=void 0,d=void 0,h=void 0,m=void 0,b=void 0,i=1732584193,o=-271733879,s=-1732584194,c=271733878,l=0;l<e.length;)d=i,h=o,m=s,b=c,i=Ce(i,o,s,c,e[l],7,-680876936),c=Ce(c,i,o,s,e[l+1],12,-389564586),s=Ce(s,c,i,o,e[l+2],17,606105819),o=Ce(o,s,c,i,e[l+3],22,-1044525330),i=Ce(i,o,s,c,e[l+4],7,-176418897),c=Ce(c,i,o,s,e[l+5],12,1200080426),s=Ce(s,c,i,o,e[l+6],17,-1473231341),o=Ce(o,s,c,i,e[l+7],22,-45705983),i=Ce(i,o,s,c,e[l+8],7,1770035416),c=Ce(c,i,o,s,e[l+9],12,-1958414417),s=Ce(s,c,i,o,e[l+10],17,-42063),o=Ce(o,s,c,i,e[l+11],22,-1990404162),i=Ce(i,o,s,c,e[l+12],7,1804603682),c=Ce(c,i,o,s,e[l+13],12,-40341101),s=Ce(s,c,i,o,e[l+14],17,-1502002290),o=Ce(o,s,c,i,e[l+15],22,1236535329),i=ke(i,o,s,c,e[l+1],5,-165796510),c=ke(c,i,o,s,e[l+6],9,-1069501632),s=ke(s,c,i,o,e[l+11],14,643717713),o=ke(o,s,c,i,e[l],20,-373897302),i=ke(i,o,s,c,e[l+5],5,-701558691),c=ke(c,i,o,s,e[l+10],9,38016083),s=ke(s,c,i,o,e[l+15],14,-660478335),o=ke(o,s,c,i,e[l+4],20,-405537848),i=ke(i,o,s,c,e[l+9],5,568446438),c=ke(c,i,o,s,e[l+14],9,-1019803690),s=ke(s,c,i,o,e[l+3],14,-187363961),o=ke(o,s,c,i,e[l+8],20,1163531501),i=ke(i,o,s,c,e[l+13],5,-1444681467),c=ke(c,i,o,s,e[l+2],9,-51403784),s=ke(s,c,i,o,e[l+7],14,1735328473),o=ke(o,s,c,i,e[l+12],20,-1926607734),i=Ae(i,o,s,c,e[l+5],4,-378558),c=Ae(c,i,o,s,e[l+8],11,-2022574463),s=Ae(s,c,i,o,e[l+11],16,1839030562),o=Ae(o,s,c,i,e[l+14],23,-35309556),i=Ae(i,o,s,c,e[l+1],4,-1530992060),c=Ae(c,i,o,s,e[l+4],11,1272893353),s=Ae(s,c,i,o,e[l+7],16,-155497632),o=Ae(o,s,c,i,e[l+10],23,-1094730640),i=Ae(i,o,s,c,e[l+13],4,681279174),c=Ae(c,i,o,s,e[l],11,-358537222),s=Ae(s,c,i,o,e[l+3],16,-722521979),o=Ae(o,s,c,i,e[l+6],23,76029189),i=Ae(i,o,s,c,e[l+9],4,-640364487),c=Ae(c,i,o,s,e[l+12],11,-421815835),s=Ae(s,c,i,o,e[l+15],16,530742520),o=Ae(o,s,c,i,e[l+2],23,-995338651),i=Pe(i,o,s,c,e[l],6,-198630844),c=Pe(c,i,o,s,e[l+7],10,1126891415),s=Pe(s,c,i,o,e[l+14],15,-1416354905),o=Pe(o,s,c,i,e[l+5],21,-57434055),i=Pe(i,o,s,c,e[l+12],6,1700485571),c=Pe(c,i,o,s,e[l+3],10,-1894986606),s=Pe(s,c,i,o,e[l+10],15,-1051523),o=Pe(o,s,c,i,e[l+1],21,-2054922799),i=Pe(i,o,s,c,e[l+8],6,1873313359),c=Pe(c,i,o,s,e[l+15],10,-30611744),s=Pe(s,c,i,o,e[l+6],15,-1560198380),o=Pe(o,s,c,i,e[l+13],21,1309151649),i=Pe(i,o,s,c,e[l+4],6,-145523070),c=Pe(c,i,o,s,e[l+11],10,-1120210379),s=Pe(s,c,i,o,e[l+2],15,718787259),o=Pe(o,s,c,i,e[l+9],21,-343485551),i=dt(i,d),o=dt(o,h),s=dt(s,m),c=dt(c,b),l+=16;return[i,o,s,c]};Si=function(e){var t,i,o;for(t=void 0,o="",i=e.length*32,t=0;t<i;)o+=String.fromCharCode(e[t>>5]>>>t%32&255),t+=8;return o};pr=function(e){var t,i,o;for(t=void 0,o=[],o[(e.length>>2)-1]=void 0,t=0;t<o.length;)o[t]=0,t+=1;for(i=e.length*8,t=0;t<i;)o[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32,t+=8;return o};Fs=function(e){return Si(An(pr(e),e.length*8))};Rs=function(e,t){var i,o,s,c,l;for(s=void 0,i=pr(e),c=[],l=[],o=void 0,c[15]=l[15]=void 0,i.length>16&&(i=An(i,e.length*8)),s=0;s<16;)c[s]=i[s]^909522486,l[s]=i[s]^1549556828,s+=1;return o=An(c.concat(pr(t)),512+t.length*8),Si(An(l.concat(o),640))};xi=function(e){var t,i,o,s;for(t="0123456789abcdef",o="",s=void 0,i=void 0,i=0;i<e.length;)s=e.charCodeAt(i),o+=t.charAt(s>>>4&15)+t.charAt(s&15),i+=1;return o};hr=function(e){return unescape(encodeURIComponent(e))};Ii=function(e){return Fs(hr(e))};Os=function(e){return xi(Ii(e))};Ei=function(e,t){return Rs(hr(e),hr(t))};Ds=function(e,t){return xi(Ei(e,t))};var sp=ap=function(e,t,i){return t?i?Ei(t,e):Ds(t,e):i?Ii(e):Os(e)},Ti=sp;var Nt=As,Ci=!1,it=e=>(...t)=>{try{return e(...t)}catch(i){Nt.captureException(i),console.error(i)}};async function Dn(e){return(await chrome.storage.local.get(e)||{})[e]}async function cp(){let e=await Dn(y.J);try{if(!e||(e?.lastUpdated||0)+(e?.validity||0)<Date.now()){N()("Fetching sentry filter...");let t=je().extVersionFull,i=await fetch(y.we.replace("%VERSION%",t),{cache:"reload"});if(i.status===200){e=await i.json(),e.lastUpdated=Date.now();let o={};o[y.J]=e,await chrome.storage.local.set(o)}}}catch{}return e||{}}function up(e,t,i){if(e.action==="deny all")return N()("Error reporting is 'deny all'"),!0;if(e.action==="filter"&&e.patterns){ue&&(i&&console.log(i),t&&console.log(t));let o=!1;for(let s of e.patterns){if(s.hash&&s.hash===t)N()("Sentry filter matched hash: "+t),o=!0;else if(s.regex&&i){let[,c,l]=s.regex.match(/^\/(.+)\/(.*)$/)||[];o=c&&i.match(new RegExp(c,l))!==null,o&&N()("Sentry filter matched regex: "+s.regex)}if(o)break}return o}else return!1}async function lp(e){let t=await Dn(y.k),i=await Dn(y._),o=await Dn(y.t)=="true";return e.tags={...e.tags||{}},t&&(e.tags.UUID=t),i&&(e.tags.Serial=i),e.tags.Pro=o,e}function Ms(){Ci=!0;let e=chrome.runtime.id;try{let t=function(i){function o(s){let c={body:s.body,method:"POST",referrerPolicy:"origin",headers:i.headers,...i.fetchOptions};return fetch(i.url,c).then(l=>({statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}return Nt.createTransport(i,o)};mr()&&delete chrome.runtime.id,Nt.init({dsn:"https://b3cea7a848c3686ab337138a6a9751d0@o4507590541901824.ingest.us.sentry.io/4507590546096128",release:"head@"+je().extVersionFull,debug:ue,autoSessionTracking:!1,transport:t,allowUrls:[/mcbpblocgmgfnpjjppndjkmgjaogfceg/,/kmmldmlijnljnnhagfldmihaimmholga/],integrations:[],beforeSend:i=>Dn(y.le).then(o=>o==="false"?(ue&&(N()(i),N()("Sentry is disabled")),null):new Promise(s=>{let c=(l,d)=>{i.breadcrumbs=[{level:l,timestamp:Date.now()/1e3,message:d},...i.breadcrumbs||[]]};try{let l,d,h=i?.exception?.values?.slice(-1).pop();if(h){let b=h.stacktrace?.frames;if(b?.length>0){let v=b.map(R=>({filename:R.filename,lineno:R.lineno,colno:R.colno,function:R.function})),T=JSON.stringify(v);l=Ti(T),c("debug",T),c("info",`FSHASH: ${l}`)}d=h.type.trim()+": "+h.value.trim()}!l&&!d&&s(i);let m=cp().then(b=>up(b,l,d)?null:lp(i)).catch(b=>(c("debug",b.message+" "+b.stack),i));s(m)}catch(l){c("debug",l.message+" "+l.stack),s(i)}}))})}finally{mr()&&(chrome.runtime.id=e)}}function ki(e){Ci&&Nt.addBreadcrumb({message:e})}function Ai(e,t){Ci&&Nt.captureMessage(e,t)}function bt(){return/^win/i.test(navigator.platform)}function Ns(){return/opr\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="pbjmgmedeliohhbaefhlplndokcbmjio"}function Ls(){return/edg\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="fcbmiimfkmkkkffjlopcpdlgclncnknm"}function $e(){return/apple/i.test(navigator.vendor)}function qe(){return Bs()==="firefox"}function ot(){return Ns()?"op":Ls()?"edge":$e()?"safari":qe()?"fx":"ch"}function Bs(){var e=chrome.runtime.id;if(e==="legfpnnmhhnhjgekmmbkilmijnjoehne")return Ns()?"opera":Ls()?"edge":"chrome";let t=["pbjmgmedeliohhbaefhlplndokcbmjio"],i=["fireshot@getfireshot.com","fireshot-pro@getfireshot.com","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}"],o=["fcbmiimfkmkkkffjlopcpdlgclncnknm"];return t.indexOf(e)>-1?"opera":i.indexOf(e)>-1?"firefox":o.indexOf(e)>-1?"edge":"chrome"}var Di=Bs(),Zt={contractId:{chrome:"com.getfireshot.api",opera:"com.getfireshot.api",edge:"com.getfireshot.api",firefox:"com.getfireshot.api.firefox"},nativeFilePath:{chrome:"fireshot-chrome-plugin.dat",opera:"fireshot-chrome-plugin.dat",edge:"fireshot-chrome-plugin.dat",firefox:"fireshot-chrome-plugin.dat"}};for(Pi in Zt)Zt[Pi]=Zt[Pi][Di];var Pi;var Ve=chrome.runtime.id,ue=["legfpnnmhhnhjgekmmbkilmijnjoehne","fireshot-beta@getfireshot.com","kmmldmlijnljnnhagfldmihaimmholga"].indexOf(Ve)>-1;chrome.storage.local.get([y.z]).then(e=>ue=ue||e[y.z]);var fp=console.log;N()("Extension ID: "+Ve);function dp(e){ue&&console.log(`${e} not implemented yet.`)}function Oi(){return Z(y.X)==="true"||Z(y.X)==="1"}function mr(){return self.constructor.name==="ServiceWorkerGlobalScope"}function Le(){if(Oi())return!1;{let e=Z(y.S,"false")==="true";return mr()&&e&&!tt.port?(Q(y.S,"false"),!1):e}}function je(){let e=chrome.runtime.getManifest();return{extVersion:e.version.split(".",3).join("."),extVersionFull:e.version.split(".",4).join("."),fSilentMode:Ve=="legfpnnmhhnhjgekmmbkilmijnjoehne"||Ve=="hpbicldbpgipcloiojdbchegbbjiobbm"||Ve=="adpnodbfhlagloahhdhjggicnfcpggkm"}}function en(e){N()("openURLV2");let i=(o,s=0)=>{s>0&&N()(`trial ${s}`);let c=()=>{++s<10?setTimeout(()=>i(o,s),150):chrome.windows.create({url:e}).catch(l=>reportError(l))};try{chrome.tabs.create(o).catch(()=>c())}catch{c()}};i({url:e})}function N(){return(...e)=>{if(e.length!==0)if(ue&&fp(...e),e.length>1)ki(JSON.stringify(e).substring(0,512));else{let t=typeof e[0]=="string"?e[0]:JSON.stringify(e);ki(t.substring(0,512))}}}function Qe(e){ue&&console.time(e)}function Ze(e){ue&&console.timeEnd(e)}function Lt(e){console.error("FireShot: "+e)}function tn(e,t,i,o,s){dp("gaTrack")}function nn(e,t,i){for(e=e.toString();e.length<i;)e=t+e;return e}function rn(e){if(!e||!Mi()||Z(y.fe,"false")==="true"){Q(y.q,e),chrome.action.setBadgeBackgroundColor({color:"#c72a1c"});try{chrome.action.setBadgeTextColor({color:"#fff"})}catch{}chrome.action.setBadgeText({text:e?"New":""}),e&&N()("Setting badge for url: "+e)}}function Ri(){let e=parseInt(Z(y.W,y.N)),t=gr();return Le()?t===y.I&&e===y.f&&(e=y.p):t===y.I&&e===y.p?e=y.f:(e===y.f||e===y.u)&&(t===y.e||t===y.m||t===y.o)&&(e=y.N),e}function gr(){return parseInt(Z(y.G,y.e))}function Fi(e,t){Q(y.W,e),Q(y.G,t),vr()}function We(){return Le()?Z(y.t)=="true":!bt()&&Z(y.t)=="true"}function Mi(){return Z(y.g)==="true"}function js(e){var t,i;if(e.substring(0,23)==="data:image/jpeg;base64,"&&(e=atob(e.replace("data:image/jpeg;base64,",""))),e.charCodeAt(0)!==255||e.charCodeAt(1)!==216||e.charCodeAt(2)!==255||e.charCodeAt(3)!==224||e.charCodeAt(6)!==74||e.charCodeAt(7)!==70||e.charCodeAt(8)!==73||e.charCodeAt(9)!==70||e.charCodeAt(10)!==0)throw new Error("getJpegSize requires a binary jpeg file");for(var o=e.charCodeAt(4)*256+e.charCodeAt(5),s=4,c=e.length;s<c;){if(s+=o,e.charCodeAt(s)!==255)throw new Error("getJpegSize could not find the size of the image");if(e.charCodeAt(s+1)===192)return i=e.charCodeAt(s+5)*256+e.charCodeAt(s+6),t=e.charCodeAt(s+7)*256+e.charCodeAt(s+8),[t,i];s+=2,o=e.charCodeAt(s)*256+e.charCodeAt(s+1)}}function Ni(e){return Math.abs(e-Math.floor(e))<.009&&(e=Math.floor(e)),e}function Li(){return Z(y.ue)==="true"}async function $s(e){let t="fsAPIScript";if(e){if((await chrome.scripting.getRegisteredContentScripts()).filter(s=>s.id===t).length>0)return N()("Script is already registered, nothing to do"),!0;let o={id:t,js:["scripts/page/fsAPIEvents.js"],matches:["<all_urls>"],excludeMatches:["*://getfireshot.com/activate*"]};try{await chrome.scripting.registerContentScripts([o])}catch(s){return console.error(`failed to register content scripts: ${s}`),!1}}else try{await chrome.scripting.unregisterContentScripts({ids:[t]})}catch(i){return console.log(`failed to unregister content scripts: ${i}`),!1}return!0}function pp(e,t,i){$e()||qe()?t():chrome.permissions.contains(e,o=>{o?t():chrome.permissions.request(e,s=>{!chrome.runtime.lastError||console.log(chrome.runtime.lastError),s?t():(N()("The user rejected to grant permissions."),i&&i())})})}function Us(){return new Promise(e=>pp({origins:["https://mail.google.com/*"]},()=>e(!0),()=>e(!1)))}function Bi(){return Ve=="hpbicldbpgipcloiojdbchegbbjiobbm"||Ve=="adpnodbfhlagloahhdhjggicnfcpggkm"}function Ks(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function Hs(e){let t=JSON.parse(e),i="guid="+encodeURIComponent(Z(y.k,""))+"&stack="+encodeURIComponent(t.stack)+"&comment="+encodeURIComponent(t.comment)+"&contacts="+encodeURIComponent(t.contacts);fetch(y.Ie,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i})}function Vs(e,t){let i=e.split("|"),o=new URLSearchParams(i[0]).get("serial");o&&Q(y._,o);let s="guid="+encodeURIComponent(Z(y.k,""))+"&session="+encodeURIComponent(i[1]);fetch(i[0],{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(c=>{if(c.ok)return c.text()}).then(c=>t(c)).catch(()=>{})}function yr(e){let t=e.match(/,(.{100})/);if(t&&t.length>0){let i=Uint8Array.from(atob(t[1]),o=>o.charCodeAt(0));return{w:i[18]<<8|i[19],h:i[22]<<8|i[23]}}else return{w:0,h:0}}function ji(){var e=!1;function t(){chrome.action.setIcon({path:"/images/sss_48.png"})}return{start:()=>{let i=0,o=[];for(let c=1;c<=30;++c)o.push(`/images/progress/frame-${c}.png`);let s=()=>{e?chrome.action.setIcon({path:o[++i%o.length]},()=>setTimeout(s,60)):t()};e=!0,s()},stop:function(){e=!1,t()}}}function On(e){N()("open folder"),chrome.downloads.show(e)}function Ws(e){let t=JSON.parse(e);Q(y.C,t.filenameTemplate),Q(y.a,t.filenameNumber),Q(y.D,t.filenameNumberPadCheck===1?"true":"false"),Q(y.O,t.filenameNumberPadValue),Q(y.R,t.filenameMaxLen)}function Rn(){let e={};return e[y.C]=Z(y.C,"")===""?y.Z:Z(y.C,""),e[y.a]=parseInt(Z(y.a,2))-1,e[y.D]=Z(y.D,"true"),e[y.O]=parseInt(Z(y.O,3)),e[y.R]=parseInt(Z(y.R,100)),e}function vr(){chrome.contextMenus.removeAll(()=>{if(Z(y.pe,"true")==="true")if(he().isIdle()){let e=hp();chrome.contextMenus.create({title:e,contexts:["all"],id:"mnuLastCommand"},()=>{chrome.runtime.lastError})}else chrome.contextMenus.create({title:"Stop",contexts:["all"],id:"mnuStopCommand"},()=>{chrome.runtime.lastError})})}function he(){function e(){let t=parseInt(Z(y.A,0));return{reset:()=>{N()("reset state"),t=y.ee,Q(y.A,t)},add:i=>{N()("add state"),t|=i,Q(y.A,t)},remove:i=>{N()("remove state"),t&=~i>>>0,Q(y.A,t)},contains:i=>(t&i)===i,isIdle:()=>t===y.ee}}return new e}function hp(){function e(c){switch(c){case y.u:return"action_save";case y.f:return"action_save_pdf";case y.te:return"action_copy";case y.ne:return"action_email";case y.re:return"action_external";case y.se:return"action_onenote";case y.ie:return"action_upload";case y.oe:return"action_print";case y.p:return"action_save_pdf_single";default:return"action_edit"}}let t,i=e(Ri()),o=!Le(),s=gr();switch(s){case y.o:t=o?"action_capture_visible_lite":"action_capture_visible";break;case y.m:t=o?"action_capture_selection_lite":"action_capture_selection";break;case y.P:t="action_capture_browser";break;case y.I:t="action_capture_tabs";break;default:t=o?"action_capture_entire_lite":"action_capture_entire"}return o&&s!==y.I?chrome.i18n.getMessage(t):chrome.i18n.getMessage(t)+" "+chrome.i18n.getMessage(i)}function Fn(){chrome.runtime.sendMessage({message:"closeProgress"}).catch(()=>{})}var $i=0,mp=1,tt={port:void 0,ready:!1,autoReconnect:!1,updating:!1,updated:!1,ignoreResponse:!1,portBusy:!1,callback:void 0,callbackDisconnected:void 0,prevVersion:void 0,updateTrials:0,pendingData:"",firstPacket:!0,onNativeHostUpdated:null,onPluginEvent:null,init:function(e,t,i,o){this.onNativeHostUpdated=t,this.onPluginEvent=e;let s=c=>{if(this.ignoreResponse){N()("Ignored response: "+JSON.stringify(c)),c.topic==="status"&&c.code==mp&&(this.updating=!1,this.autoReconnect=!1,e&&e(c));return}this.autoReconnect=!1,!this.processInternally(c)&&e&&e(c)};this.callback=i,this.callbackDisconnected=o,this.ignoreResponse=!1,this.portBusy=!0;try{this.port=chrome.runtime.connectNative(Zt.contractId+"")}catch(c){Lt(c.message),this.portBusy=!1}this.port.onMessage.addListener(c=>{if(c.data!=="")this.pendingData+=c.data;else try{let l=JSON.parse(this.pendingData);ue&&N()("Original Packet: "+this.pendingData.substr(0,1024)),this.pendingData="",s(l)}catch(l){Nt.captureException(l),console.error("Original Packet: "+this.pendingData.substr(0,1024)),this.pendingData="",Lt(l.message)}}),this.port.onDisconnect.addListener(()=>{chrome.runtime.lastError&&console.log("ERROR: "+chrome.runtime.lastError.message),this.ready=!1,this.portBusy=!1,Q(y.S,"false"),!this.updating&&this.callbackDisconnected&&this.callbackDisconnected(),N()("Native port disconnected."),this.firstPacket=!0,this.pendingData="",this.autoReconnect&&this.doReconnect()}),N()("Native port created successfully. Starting test..."),this.launchJSON({JSONCommand:"ping",version:je().extVersionFull,id:Ve})},processInternally:function(e){if(e.topic=="hostVersion"){if(this.hostVersion=e.data,je().extVersion!=this.hostVersion)return++this.updateTrials>3?(N()("Too much of unsuccessful update trials. No updates anymore."),Ai("Too much of unsuccessful update trials. No updates anymore."),this.updating=!1,!1):(this.prevVersion=this.hostVersion,this.doUpdate(),!0)}else if(e.topic=="status")if(e.code==$i){var t=e.data;return this.updateTrials=0,this.ready=!0,Q(y.S,"true"),this.callback&&(this.callback(),this.callback=void 0),this.updating&&(this.updated=!0,this.updating=!1,this.prevVersion!="0"&&this.onNativeHostUpdated(t)),!1}else return this.updating&&(this.updating=!1),!1;else if(e.topic=="getDLL")return this.sendDLL(e.x64),!0;return!1},launchJSON:function(e){this.port.postMessage(e)},getFile:function(e,t){let i=()=>{let o=!0;if(e.search(/sss-x64\.dat|sss\.dat|fireshot-chrome-plugin\.dat/)!==-1){let s=je().extVersionFull,c=y.be+s,l=parseInt(_e.getOption(c,"0"));l<3?(N()("Opening helper installer page."),o=!1,_e.setOption(c,l+1),en("https://getfireshot.com/helper-install.php?ver="+s)):N()("Helper installer page cannot be shown more than 3 times, aborting.")}return o};N()("Fetching: "+e),fetch(chrome.runtime.getURL(e)).then(o=>{N()(`Fetching status = [${o.status}]`),o.ok?o.blob().then(s=>{N()(`Blob size is ${s.size} bytes`);let c=new FileReader;c.onload=l=>{N()("Fetching complete");let d="base64,";t(l.target.result.substr(l.target.result.indexOf(d)+d.length,l.target.result.length))},c.onerror=()=>{N()("Error in FileReader")},c.readAsDataURL(s)}).catch(s=>{i()&&reportError(s)}):(N()("NativeError-Error retrieving file"),Ai(`Error retrieving file: ${o.status}`))}).catch(o=>{i()&&reportError(o)})},sendDLL:function(e){this.getFile(`native/${e?"sss-x64.dat":"sss.dat"}`,t=>{t&&this.launchJSON({JSONCommand:"updateDLL",version:je().extVersionFull,data:t})})},doUpdate:function(){let e=je().extVersionFull;N()("Updating native to the version: "+e),this.ignoreResponse=!0,this.getFile("native/"+Zt.nativeFilePath,t=>{this.updating=!0,this.autoReconnect=!0,this.launchJSON({JSONCommand:"updateNative",version:e,data:t})})},doReconnect:function(){setTimeout(()=>{N()("Trying to reconnect..."),this.init(this.onPluginEvent,this.onNativeHostUpdated,this.callback,this.callbackDisconnected)},1e3)},forceDisconnect:function(){this.autoReconnect=!1,this.port&&this.port.disconnect(),this.ready=!1,Q(y.S,"false")}};var qi=function(e,t){return qi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},qi(e,t)};function gp(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");qi(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var ee=function(){return ee=Object.assign||function(t){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c])}return t},ee.apply(this,arguments)};function Dr(e,t,i){if(i||arguments.length===2)for(var o=0,s=t.length,c;o<s;o++)(c||!(o in t))&&(c||(c=Array.prototype.slice.call(t,0,o)),c[o]=t[o]);return e.concat(c||Array.prototype.slice.call(t))}var De=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,xe=Object.keys,ge=Array.isArray;typeof Promise<"u"&&!De.Promise&&(De.Promise=Promise);function Ye(e,t){return typeof t!="object"||xe(t).forEach(function(i){e[i]=t[i]}),e}var ln=Object.getPrototypeOf,yp={}.hasOwnProperty;function Ke(e,t){return yp.call(e,t)}function fn(e,t){typeof t=="function"&&(t=t(ln(e))),(typeof Reflect>"u"?xe:Reflect.ownKeys)(t).forEach(function(i){It(e,i,t[i])})}var cc=Object.defineProperty;function It(e,t,i,o){cc(e,t,Ye(i&&Ke(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function dn(e){return{from:function(t){return e.prototype=Object.create(t.prototype),It(e.prototype,"constructor",e),{extend:fn.bind(null,e.prototype)}}}}var vp=Object.getOwnPropertyDescriptor;function uc(e,t){var i=vp(e,t),o;return i||(o=ln(e))&&uc(o,t)}var bp=[].slice;function Hr(e,t,i){return bp.call(e,t,i)}function lc(e,t){return t(e)}function Mn(e){if(!e)throw new Error("Assertion Failed")}function fc(e){De.setImmediate?setImmediate(e):setTimeout(e,0)}function _p(e,t){return e.reduce(function(i,o,s){var c=t(o,s);return c&&(i[c[0]]=c[1]),i},{})}function mt(e,t){if(typeof t=="string"&&Ke(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var i=[],o=0,s=t.length;o<s;++o){var c=mt(e,t[o]);i.push(c)}return i}var l=t.indexOf(".");if(l!==-1){var d=e[t.substr(0,l)];return d==null?void 0:mt(d,t.substr(l+1))}}function ze(e,t,i){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Mn(typeof i!="string"&&"length"in i);for(var o=0,s=t.length;o<s;++o)ze(e,t[o],i[o])}else{var c=t.indexOf(".");if(c!==-1){var l=t.substr(0,c),d=t.substr(c+1);if(d==="")i===void 0?ge(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=i;else{var h=e[l];(!h||!Ke(e,l))&&(h=e[l]={}),ze(h,d,i)}}else i===void 0?ge(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function wp(e,t){typeof t=="string"?ze(e,t,void 0):"length"in t&&[].map.call(t,function(i){ze(e,i,void 0)})}function dc(e){var t={};for(var i in e)Ke(e,i)&&(t[i]=e[i]);return t}var Sp=[].concat;function pc(e){return Sp.apply([],e)}var Ep="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(pc([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return De[e]}),hc=new Set(Ep.map(function(e){return De[e]}));function mc(e){var t={};for(var i in e)if(Ke(e,i)){var o=e[i];t[i]=!o||typeof o!="object"||hc.has(o.constructor)?o:mc(o)}return t}function Ip(e){for(var t in e)if(Ke(e,t))return!1;return!0}var Ln=null;function Vt(e){Ln=new WeakMap;var t=Qi(e);return Ln=null,t}function Qi(e){if(!e||typeof e!="object")return e;var t=Ln.get(e);if(t)return t;if(ge(e)){t=[],Ln.set(e,t);for(var i=0,o=e.length;i<o;++i)t.push(Qi(e[i]))}else if(hc.has(e.constructor))t=e;else{var s=ln(e);t=s===Object.prototype?{}:Object.create(s),Ln.set(e,t);for(var c in e)Ke(e,c)&&(t[c]=Qi(e[c]))}return t}var xp={}.toString;function Zi(e){return xp.call(e).slice(8,-1)}var eo=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Tp=typeof eo=="symbol"?function(e){var t;return e!=null&&(t=e[eo])&&t.apply(e)}:function(){return null};function Bt(e,t){var i=e.indexOf(t);return i>=0&&e.splice(i,1),i>=0}var sn={};function ht(e){var t,i,o,s;if(arguments.length===1){if(ge(e))return e.slice();if(this===sn&&typeof e=="string")return[e];if(s=Tp(e)){for(i=[];o=s.next(),!o.done;)i.push(o.value);return i}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(i=new Array(t);t--;)i[t]=e[t];return i}return[e]}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var mo=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Cp=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],gc=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],go=Cp.concat(gc),kp={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pn(e,t){this.name=e,this.message=t}dn(pn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function yc(e,t){return e+". Errors: "+Object.keys(t).map(function(i){return t[i].toString()}).filter(function(i,o,s){return s.indexOf(i)===o}).join(`
`)}function Or(e,t,i,o){this.failures=t,this.failedKeys=o,this.successCount=i,this.message=yc(e,t)}dn(Or).from(pn);function cn(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(i){return t[i]}),this.failuresByPos=t,this.message=yc(e,this.failures)}dn(cn).from(pn);var yo=go.reduce(function(e,t){return e[t]=t+"Error",e},{}),Ap=pn,q=go.reduce(function(e,t){var i=t+"Error";function o(s,c){this.name=i,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=kp[t]||i,this.inner=null)}return dn(o).from(Ap),e[t]=o,e},{});q.Syntax=SyntaxError;q.Type=TypeError;q.Range=RangeError;var Gs=gc.reduce(function(e,t){return e[t+"Error"]=q[t],e},{});function Pp(e,t){if(!e||e instanceof pn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Gs[e.name])return e;var i=new Gs[e.name](t||e.message,e);return"stack"in e&&It(i,"stack",{get:function(){return this.inner.stack}}),i}var Vr=go.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=q[t]),e},{});Vr.ModifyError=Or;Vr.DexieError=pn;Vr.BulkError=cn;function fe(){}function Wn(e){return e}function Dp(e,t){return e==null||e===Wn?t:function(i){return t(e(i))}}function Wt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Op(e,t){return e===fe?t:function(){var i=e.apply(this,arguments);i!==void 0&&(arguments[0]=i);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Wt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Wt(s,this.onerror):s),c!==void 0?c:i}}function Rp(e,t){return e===fe?t:function(){e.apply(this,arguments);var i=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Wt(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Wt(o,this.onerror):o)}}function Fp(e,t){return e===fe?t:function(i){var o=e.apply(this,arguments);Ye(i,o);var s=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Wt(s,this.onsuccess):s),c&&(this.onerror=this.onerror?Wt(c,this.onerror):c),o===void 0?l===void 0?void 0:l:Ye(o,l)}}function Mp(e,t){return e===fe?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function vo(e,t){return e===fe?t:function(){var i=e.apply(this,arguments);if(i&&typeof i.then=="function"){for(var o=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return i.then(function(){return t.apply(o,c)})}return t.apply(this,arguments)}}var st=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function vc(e,t){st=e}var $n={},bc=100,bo=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,ln(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,ln(t),e]}(),zs=bo[0],Ys=bo[1],Np=bo[2],Lp=Ys&&Ys.then,Bn=zs&&zs.constructor,_o=!!Np;function Bp(){queueMicrotask($p)}var Un=function(e,t){Nn.push([e,t]),Rr&&(Bp(),Rr=!1)},to=!0,Rr=!0,Ut=[],xr=[],no=Wn,Et={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:fe,pgp:!1,env:{},finalize:fe},X=Et,Nn=[],Kt=0,Tr=[];function z(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=X;if(typeof e!="function"){if(e!==$n)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&io(this,this._value);return}this._state=null,this._value=null,++t.ref,wc(this,e)}var ro={get:function(){var e=X,t=Fr;function i(o,s){var c=this,l=!e.global&&(e!==X||t!==Fr),d=l&&!Tt(),h=new z(function(m,b){wo(c,new _c(Js(o,e,l,d),Js(s,e,l,d),m,b,e))});return this._consoleTask&&(h._consoleTask=this._consoleTask),h}return i.prototype=$n,i},set:function(e){It(this,"then",e&&e.prototype===$n?ro:{get:function(){return e},set:ro.set})}};fn(z.prototype,{then:ro,_then:function(e,t){wo(this,new _c(null,null,e,t,X))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],i=arguments[1];return typeof t=="function"?this.then(null,function(o){return o instanceof t?i(o):Cr(o)}):this.then(null,function(o){return o&&o.name===t?i(o):Cr(o)})},finally:function(e){return this.then(function(t){return z.resolve(e()).then(function(){return t})},function(t){return z.resolve(e()).then(function(){return Cr(t)})})},timeout:function(e,t){var i=this;return e<1/0?new z(function(o,s){var c=setTimeout(function(){return s(new q.Timeout(t))},e);i.then(o,s).finally(clearTimeout.bind(null,c))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&It(z.prototype,Symbol.toStringTag,"Dexie.Promise");Et.env=Ec();function _c(e,t,i,o,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=i,this.reject=o,this.psd=s}fn(z,{all:function(){var e=ht.apply(null,arguments).map(Mr);return new z(function(t,i){e.length===0&&t([]);var o=e.length;e.forEach(function(s,c){return z.resolve(s).then(function(l){e[c]=l,--o||t(e)},i)})})},resolve:function(e){if(e instanceof z)return e;if(e&&typeof e.then=="function")return new z(function(i,o){e.then(i,o)});var t=new z($n,!0,e);return t},reject:Cr,race:function(){var e=ht.apply(null,arguments).map(Mr);return new z(function(t,i){e.map(function(o){return z.resolve(o).then(t,i)})})},PSD:{get:function(){return X},set:function(e){return X=e}},totalEchoes:{get:function(){return Fr}},newPSD:xt,usePSD:Gt,scheduler:{get:function(){return Un},set:function(e){Un=e}},rejectionMapper:{get:function(){return no},set:function(e){no=e}},follow:function(e,t){return new z(function(i,o){return xt(function(s,c){var l=X;l.unhandleds=[],l.onunhandled=c,l.finalize=Wt(function(){var d=this;Up(function(){d.unhandleds.length===0?s():c(d.unhandleds[0])})},l.finalize),e()},t,i,o)})}});Bn&&(Bn.allSettled&&It(z,"allSettled",function(){var e=ht.apply(null,arguments).map(Mr);return new z(function(t){e.length===0&&t([]);var i=e.length,o=new Array(i);e.forEach(function(s,c){return z.resolve(s).then(function(l){return o[c]={status:"fulfilled",value:l}},function(l){return o[c]={status:"rejected",reason:l}}).then(function(){return--i||t(o)})})})}),Bn.any&&typeof AggregateError<"u"&&It(z,"any",function(){var e=ht.apply(null,arguments).map(Mr);return new z(function(t,i){e.length===0&&i(new AggregateError([]));var o=e.length,s=new Array(o);e.forEach(function(c,l){return z.resolve(c).then(function(d){return t(d)},function(d){s[l]=d,--o||i(new AggregateError(s))})})})}));function wc(e,t){try{t(function(i){if(e._state===null){if(i===e)throw new TypeError("A promise cannot be resolved with itself.");var o=e._lib&&hn();i&&typeof i.then=="function"?wc(e,function(s,c){i instanceof z?i._then(s,c):i.then(s,c)}):(e._state=!0,e._value=i,Sc(e)),o&&mn()}},io.bind(null,e))}catch(i){io(e,i)}}function io(e,t){if(xr.push(t),e._state===null){var i=e._lib&&hn();t=no(t),e._state=!1,e._value=t,Kp(e),Sc(e),i&&mn()}}function Sc(e){var t=e._listeners;e._listeners=[];for(var i=0,o=t.length;i<o;++i)wo(e,t[i]);var s=e._PSD;--s.ref||s.finalize(),Kt===0&&(++Kt,Un(function(){--Kt===0&&So()},[]))}function wo(e,t){if(e._state===null){e._listeners.push(t);return}var i=e._state?t.onFulfilled:t.onRejected;if(i===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Kt,Un(jp,[i,e,t])}function jp(e,t,i){try{var o,s=t._value;!t._state&&xr.length&&(xr=[]),o=st&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),!t._state&&xr.indexOf(s)===-1&&Hp(t),i.resolve(o)}catch(c){i.reject(c)}finally{--Kt===0&&So(),--i.psd.ref||i.psd.finalize()}}function $p(){Gt(Et,function(){hn()&&mn()})}function hn(){var e=to;return to=!1,Rr=!1,e}function mn(){var e,t,i;do for(;Nn.length>0;)for(e=Nn,Nn=[],i=e.length,t=0;t<i;++t){var o=e[t];o[0].apply(null,o[1])}while(Nn.length>0);to=!0,Rr=!0}function So(){var e=Ut;Ut=[],e.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)});for(var t=Tr.slice(0),i=t.length;i;)t[--i]()}function Up(e){function t(){e(),Tr.splice(Tr.indexOf(t),1)}Tr.push(t),++Kt,Un(function(){--Kt===0&&So()},[])}function Kp(e){Ut.some(function(t){return t._value===e._value})||Ut.push(e)}function Hp(e){for(var t=Ut.length;t;)if(Ut[--t]._value===e._value){Ut.splice(t,1);return}}function Cr(e){return new z($n,!1,e)}function me(e,t){var i=X;return function(){var o=hn(),s=X;try{return Ct(i,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{Ct(s,!1),o&&mn()}}}var Ie={awaits:0,echoes:0,id:0},Vp=0,kr=[],Ar=0,Fr=0,Wp=0;function xt(e,t,i,o){var s=X,c=Object.create(s);c.parent=s,c.ref=0,c.global=!1,c.id=++Wp,Et.env,c.env=_o?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},t&&Ye(c,t),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=Gt(c,e,i,o);return c.ref===0&&c.finalize(),l}function gn(){return Ie.id||(Ie.id=++Vp),++Ie.awaits,Ie.echoes+=bc,Ie.id}function Tt(){return Ie.awaits?(--Ie.awaits===0&&(Ie.id=0),Ie.echoes=Ie.awaits*bc,!0):!1}(""+Lp).indexOf("[native code]")===-1&&(gn=Tt=fe);function Mr(e){return Ie.echoes&&e&&e.constructor===Bn?(gn(),e.then(function(t){return Tt(),t},function(t){return Tt(),we(t)})):e}function Gp(e){++Fr,(!Ie.echoes||--Ie.echoes===0)&&(Ie.echoes=Ie.awaits=Ie.id=0),kr.push(X),Ct(e,!0)}function zp(){var e=kr[kr.length-1];kr.pop(),Ct(e,!1)}function Ct(e,t){var i=X;if((t?Ie.echoes&&(!Ar++||e!==X):Ar&&(!--Ar||e!==X))&&queueMicrotask(t?Gp.bind(null,e):zp),e!==X&&(X=e,i===Et&&(Et.env=Ec()),_o)){var o=Et.env.Promise,s=e.env;(i.global||e.global)&&(Object.defineProperty(De,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function Ec(){var e=De.Promise;return _o?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(De,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Gt(e,t,i,o,s){var c=X;try{return Ct(e,!0),t(i,o,s)}finally{Ct(c,!1)}}function Js(e,t,i,o){return typeof e!="function"?e:function(){var s=X;i&&gn(),Ct(t,!0);try{return e.apply(this,arguments)}finally{Ct(s,!1),o&&queueMicrotask(Tt)}}}function Ui(e){Promise===Bn&&Ie.echoes===0?Ar===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var we=z.reject;function oo(e,t,i,o){if(!e.idbdb||!e._state.openComplete&&!X.letThrough&&!e._vip){if(e._state.openComplete)return we(new q.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return we(new q.DatabaseClosed);e.open().catch(fe)}return e._state.dbReadyPromise.then(function(){return oo(e,t,i,o)})}else{var s=e._createTransaction(t,i,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(c){return c.name===yo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return oo(e,t,i,o)})):we(c)}return s._promise(t,function(c,l){return xt(function(){return X.trans=s,o(c,l,s)})}).then(function(c){if(t==="readwrite")try{s.idbtrans.commit()}catch{}return t==="readonly"?c:s._completion.then(function(){return c})})}}var Xs="4.0.8",$t="\uFFFF",ao=-1/0,pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ic="String expected.",un=[],Wr="__dbnames",Ki="readonly",Hi="readwrite";function zt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var xc={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function br(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Vt(t),delete t[e]),t}:function(t){return t}}function Yp(){throw q.Type()}function oe(e,t){try{var i=qs(e),o=qs(t);if(i!==o)return i==="Array"?1:o==="Array"?-1:i==="binary"?1:o==="binary"?-1:i==="string"?1:o==="string"?-1:i==="Date"?1:o!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Xp(Qs(e),Qs(t));case"Array":return Jp(e,t)}}catch{}return NaN}function Jp(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c){var l=oe(e[c],t[c]);if(l!==0)return l}return i===o?0:i<o?-1:1}function Xp(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c)if(e[c]!==t[c])return e[c]<t[c]?-1:1;return i===o?0:i<o?-1:1}function qs(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var i=Zi(e);return i==="ArrayBuffer"?"binary":i}function Qs(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Tc=function(){function e(){}return e.prototype._trans=function(t,i,o){var s=this._tx||X.trans,c=this.name,l=st&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function d(b,v,T){if(!T.schema[c])throw new q.NotFound("Table "+c+" not part of transaction");return i(T.idbtrans,T)}var h=hn();try{var m=s&&s.db._novip===this.db._novip?s===X.trans?s._promise(t,d,o):xt(function(){return s._promise(t,d,o)},{trans:s,transless:X.transless||X}):oo(this.db,t,[this.name],d);return l&&(m._consoleTask=l,m=m.catch(function(b){return console.trace(b),we(b)})),m}finally{h&&mn()}},e.prototype.get=function(t,i){var o=this;return t&&t.constructor===Object?this.where(t).first(i):t==null?we(new q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return o.core.get({trans:s,key:t}).then(function(c){return o.hook.reading.fire(c)})}).then(i)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(ge(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var i=xe(t);if(i.length===1)return this.where(i[0]).equals(t[i[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&i.every(function(R){return v.keyPath.indexOf(R)>=0})){for(var T=0;T<i.length;++T)if(i.indexOf(v.keyPath[T])===-1)return!1;return!0}return!1}).sort(function(v,T){return v.keyPath.length-T.keyPath.length})[0];if(o&&this.db._maxKey!==$t){var s=o.keyPath.slice(0,i.length);return this.where(s).equals(s.map(function(v){return t[v]}))}!o&&st&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var c=this.schema.idxByName,l=this.db._deps.indexedDB;function d(v,T){return l.cmp(v,T)===0}var h=i.reduce(function(v,T){var R=v[0],_=v[1],E=c[T],w=t[T];return[R||E,R||!E?zt(_,E&&E.multi?function(I){var x=mt(I,T);return ge(x)&&x.some(function(C){return d(w,C)})}:function(I){return d(w,mt(I,T))}):_]},[null,null]),m=h[0],b=h[1];return m?this.where(m.name).equals(t[m.keyPath]).filter(b):o?this.filter(b):this.where(i).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,ge(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var i=this,o=i.db,s=i.name;this.schema.mappedClass=t,t.prototype instanceof Yp&&(t=function(h){gp(m,h);function m(){return h!==null&&h.apply(this,arguments)||this}return Object.defineProperty(m.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),m.prototype.table=function(){return s},m}(t));for(var c=new Set,l=t.prototype;l;l=ln(l))Object.getOwnPropertyNames(l).forEach(function(h){return c.add(h)});var d=function(h){if(!h)return h;var m=Object.create(t.prototype);for(var b in h)if(!c.has(b))try{m[b]=h[b]}catch{}return m};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),t},e.prototype.defineClass=function(){function t(i){Ye(this,i)}return this.mapToClass(t)},e.prototype.add=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,d=t;return l&&c&&(d=br(l)(t)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"add",keys:i!=null?[i]:null,values:[d]})}).then(function(h){return h.numFailures?z.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{ze(t,l,h)}catch{}return h})},e.prototype.update=function(t,i){if(typeof t=="object"&&!ge(t)){var o=mt(t,this.schema.primKey.keyPath);return o===void 0?we(new q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(i)}else return this.where(":id").equals(t).modify(i)},e.prototype.put=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,d=t;return l&&c&&(d=br(l)(t)),this._trans("readwrite",function(h){return o.core.mutate({trans:h,type:"put",values:[d],keys:i!=null?[i]:null})}).then(function(h){return h.numFailures?z.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{ze(t,l,h)}catch{}return h})},e.prototype.delete=function(t){var i=this;return this._trans("readwrite",function(o){return i.core.mutate({trans:o,type:"delete",keys:[t]})}).then(function(o){return o.numFailures?z.reject(o.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"deleteRange",range:xc})}).then(function(i){return i.numFailures?z.reject(i.failures[0]):void 0})},e.prototype.bulkGet=function(t){var i=this;return this._trans("readonly",function(o){return i.core.getMany({keys:t,trans:o}).then(function(s){return s.map(function(c){return i.hook.reading.fire(c)})})})},e.prototype.bulkAdd=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var h=s.schema.primKey,m=h.auto,b=h.keyPath;if(b&&c)throw new q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=t.length,T=b&&m?t.map(br(b)):t;return s.core.mutate({trans:d,type:"add",keys:c,values:T,wantResults:l}).then(function(R){var _=R.numFailures,E=R.results,w=R.lastResult,I=R.failures,x=l?E:w;if(_===0)return x;throw new cn("".concat(s.name,".bulkAdd(): ").concat(_," of ").concat(v," operations failed"),I)})})},e.prototype.bulkPut=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(d){var h=s.schema.primKey,m=h.auto,b=h.keyPath;if(b&&c)throw new q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new q.InvalidArgument("Arguments objects and keys must have the same length");var v=t.length,T=b&&m?t.map(br(b)):t;return s.core.mutate({trans:d,type:"put",keys:c,values:T,wantResults:l}).then(function(R){var _=R.numFailures,E=R.results,w=R.lastResult,I=R.failures,x=l?E:w;if(_===0)return x;throw new cn("".concat(s.name,".bulkPut(): ").concat(_," of ").concat(v," operations failed"),I)})})},e.prototype.bulkUpdate=function(t){var i=this,o=this.core,s=t.map(function(d){return d.key}),c=t.map(function(d){return d.changes}),l=[];return this._trans("readwrite",function(d){return o.getMany({trans:d,keys:s,cache:"clone"}).then(function(h){var m=[],b=[];t.forEach(function(T,R){var _=T.key,E=T.changes,w=h[R];if(w){for(var I=0,x=Object.keys(E);I<x.length;I++){var C=x[I],A=E[C];if(C===i.schema.primKey.keyPath){if(oe(A,_)!==0)throw new q.Constraint("Cannot update primary key in bulkUpdate()")}else ze(w,C,A)}l.push(R),m.push(_),b.push(w)}});var v=m.length;return o.mutate({trans:d,type:"put",keys:m,values:b,updates:{keys:s,changeSpecs:c}}).then(function(T){var R=T.numFailures,_=T.failures;if(R===0)return v;for(var E=0,w=Object.keys(_);E<w.length;E++){var I=w[E],x=l[Number(I)];if(x!=null){var C=_[I];delete _[I],_[x]=C}}throw new cn("".concat(i.name,".bulkUpdate(): ").concat(R," of ").concat(v," operations failed"),_)})})})},e.prototype.bulkDelete=function(t){var i=this,o=t.length;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:t})}).then(function(s){var c=s.numFailures,l=s.lastResult,d=s.failures;if(c===0)return l;throw new cn("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),d)})},e}();function Gn(e){var t={},i=function(d,h){if(h){for(var m=arguments.length,b=new Array(m-1);--m;)b[m-1]=arguments[m];return t[d].subscribe.apply(null,b),e}else if(typeof d=="string")return t[d]};i.addEventType=c;for(var o=1,s=arguments.length;o<s;++o)c(arguments[o]);return i;function c(d,h,m){if(typeof d=="object")return l(d);h||(h=Mp),m||(m=fe);var b={subscribers:[],fire:m,subscribe:function(v){b.subscribers.indexOf(v)===-1&&(b.subscribers.push(v),b.fire=h(b.fire,v))},unsubscribe:function(v){b.subscribers=b.subscribers.filter(function(T){return T!==v}),b.fire=b.subscribers.reduce(h,m)}};return t[d]=i[d]=b,b}function l(d){xe(d).forEach(function(h){var m=d[h];if(ge(m))c(h,d[h][0],d[h][1]);else if(m==="asap")var b=c(h,Wn,function(){for(var T=arguments.length,R=new Array(T);T--;)R[T]=arguments[T];b.subscribers.forEach(function(_){fc(function(){_.apply(null,R)})})});else throw new q.InvalidArgument("Invalid event config")})}}function zn(e,t){return dn(t).from({prototype:e}),t}function qp(e){return zn(Tc.prototype,function(i,o,s){this.db=e,this._tx=s,this.name=i,this.schema=o,this.hook=e._allTables[i]?e._allTables[i].hook:Gn(null,{creating:[Op,fe],reading:[Dp,Wn],updating:[Fp,fe],deleting:[Rp,fe]})})}function on(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Vi(e,t){e.filter=zt(e.filter,t)}function Wi(e,t,i){var o=e.replayFilter;e.replayFilter=o?function(){return zt(o(),t())}:t,e.justLimit=i&&!o}function Qp(e,t){e.isMatch=zt(e.isMatch,t)}function Pr(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new q.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function Zs(e,t,i){var o=Pr(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:o,range:e.range}})}function _r(e,t,i,o){var s=e.replayFilter?zt(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},l=function(d,h,m){if(!s||s(h,m,function(T){return h.stop(T)},function(T){return h.fail(T)})){var b=h.primaryKey,v=""+b;v==="[object ArrayBuffer]"&&(v=""+new Uint8Array(b)),Ke(c,v)||(c[v]=!0,t(d,h,m))}};return Promise.all([e.or._iterate(l,i),ec(Zs(e,o,i),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}else return ec(Zs(e,o,i),zt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function ec(e,t,i,o){var s=o?function(l,d,h){return i(o(l),d,h)}:i,c=me(s);return e.then(function(l){if(l)return l.start(function(){var d=function(){return l.continue()};(!t||t(l,function(h){return d=h},function(h){l.stop(h),d=fe},function(h){l.fail(h),d=fe}))&&c(l.value,l,function(h){return d=h}),d()})})}var og=Symbol(),Zp=function(){function e(t){Object.assign(this,t)}return e.prototype.execute=function(t){var i;if(this.add!==void 0){var o=this.add;if(ge(o))return Dr(Dr([],ge(t)?t:[],!0),o,!0).sort();if(typeof o=="number")return(Number(t)||0)+o;if(typeof o=="bigint")try{return BigInt(t)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(this.remove!==void 0){var s=this.remove;if(ge(s))return ge(t)?t.filter(function(l){return!s.includes(l)}).sort():[];if(typeof s=="number")return Number(t)-s;if(typeof s=="bigint")try{return BigInt(t)-s}catch{return BigInt(0)-s}throw new TypeError("Invalid subtrahend ".concat(s))}var c=(i=this.replacePrefix)===null||i===void 0?void 0:i[0];return c&&typeof t=="string"&&t.startsWith(c)?this.replacePrefix[1]+t.substring(c.length):t},e}(),eh=function(){function e(){}return e.prototype._read=function(t,i){var o=this._ctx;return o.error?o.table._trans(null,we.bind(null,o.error)):o.table._trans("readonly",t).then(i)},e.prototype._write=function(t){var i=this._ctx;return i.error?i.table._trans(null,we.bind(null,i.error)):i.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var i=this._ctx;i.algorithm=zt(i.algorithm,t)},e.prototype._iterate=function(t,i){return _r(this._ctx,t,i,this._ctx.table.core)},e.prototype.clone=function(t){var i=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return t&&Ye(o,t),i._ctx=o,i},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var i=this._ctx;return this._read(function(o){return _r(i,t,o,i.table.core)})},e.prototype.count=function(t){var i=this;return this._read(function(o){var s=i._ctx,c=s.table.core;if(on(s,!0))return c.count({trans:o,query:{index:Pr(s,c.schema),range:s.range}}).then(function(d){return Math.min(d,s.limit)});var l=0;return _r(s,function(){return++l,!1},o,c).then(function(){return l})}).then(t)},e.prototype.sortBy=function(t,i){var o=t.split(".").reverse(),s=o[0],c=o.length-1;function l(m,b){return b?l(m[o[b]],b-1):m[s]}var d=this._ctx.dir==="next"?1:-1;function h(m,b){var v=l(m,c),T=l(b,c);return v<T?-d:v>T?d:0}return this.toArray(function(m){return m.sort(h)}).then(i)},e.prototype.toArray=function(t){var i=this;return this._read(function(o){var s=i._ctx;if(s.dir==="next"&&on(s,!0)&&s.limit>0){var c=s.valueMapper,l=Pr(s,s.table.core.schema);return s.table.core.query({trans:o,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(h){var m=h.result;return c?m.map(c):m})}else{var d=[];return _r(s,function(h){return d.push(h)},o,s.table.core).then(function(){return d})}},t)},e.prototype.offset=function(t){var i=this._ctx;return t<=0?this:(i.offset+=t,on(i)?Wi(i,function(){var o=t;return function(s,c){return o===0?!0:o===1?(--o,!1):(c(function(){s.advance(o),o=0}),!1)}}):Wi(i,function(){var o=t;return function(){return--o<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Wi(this._ctx,function(){var i=t;return function(o,s,c){return--i<=0&&s(c),i>=0}},!0),this},e.prototype.until=function(t,i){return Vi(this._ctx,function(o,s,c){return t(o.value)?(s(c),i):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(i){return i[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Vi(this._ctx,function(i){return t(i.value)}),Qp(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.key,s)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.primaryKey,s)})},e.prototype.keys=function(t){var i=this._ctx;i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.key)}).then(function(){return o}).then(t)},e.prototype.primaryKeys=function(t){var i=this._ctx;if(i.dir==="next"&&on(i,!0)&&i.limit>0)return this._read(function(s){var c=Pr(i,i.table.core.schema);return i.table.core.query({trans:s,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(s){var c=s.result;return c}).then(t);i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.primaryKey)}).then(function(){return o}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(i){return i[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,i=t.index&&t.table.schema.idxByName[t.index];if(!i||!i.multi)return this;var o={};return Vi(this._ctx,function(s){var c=s.primaryKey.toString(),l=Ke(o,c);return o[c]=!0,!l}),this},e.prototype.modify=function(t){var i=this,o=this._ctx;return this._write(function(s){var c;if(typeof t=="function")c=t;else{var l=xe(t),d=l.length;c=function(I){for(var x=!1,C=0;C<d;++C){var A=l[C],k=t[A],F=mt(I,A);k instanceof Zp?(ze(I,A,k.execute(F)),x=!0):F!==k&&(ze(I,A,k),x=!0)}return x}}var h=o.table.core,m=h.schema.primaryKey,b=m.outbound,v=m.extractKey,T=i.db._options.modifyChunkSize||200,R=[],_=0,E=[],w=function(I,x){var C=x.failures,A=x.numFailures;_+=I-A;for(var k=0,F=xe(C);k<F.length;k++){var H=F[k];R.push(C[H])}};return i.clone().primaryKeys().then(function(I){var x=on(o)&&o.limit===1/0&&(typeof t!="function"||t===Gi)&&{index:o.index,range:o.range},C=function(A){var k=Math.min(T,I.length-A);return h.getMany({trans:s,keys:I.slice(A,A+k),cache:"immutable"}).then(function(F){for(var H=[],O=[],j=b?[]:null,L=[],M=0;M<k;++M){var D=F[M],K={value:Vt(D),primKey:I[A+M]};c.call(K,K.value,K)!==!1&&(K.value==null?L.push(I[A+M]):!b&&oe(v(D),v(K.value))!==0?(L.push(I[A+M]),H.push(K.value)):(O.push(K.value),b&&j.push(I[A+M])))}return Promise.resolve(H.length>0&&h.mutate({trans:s,type:"add",values:H}).then(function(W){for(var $ in W.failures)L.splice(parseInt($),1);w(H.length,W)})).then(function(){return(O.length>0||x&&typeof t=="object")&&h.mutate({trans:s,type:"put",keys:j,values:O,criteria:x,changeSpec:typeof t!="function"&&t,isAdditionalChunk:A>0}).then(function(W){return w(O.length,W)})}).then(function(){return(L.length>0||x&&t===Gi)&&h.mutate({trans:s,type:"delete",keys:L,criteria:x,isAdditionalChunk:A>0}).then(function(W){return w(L.length,W)})}).then(function(){return I.length>A+k&&C(A+T)})})};return C(0).then(function(){if(R.length>0)throw new Or("Error modifying one or more objects",R,_,E);return I.length})})})},e.prototype.delete=function(){var t=this._ctx,i=t.range;return on(t)&&(t.isPrimKey||i.type===3)?this._write(function(o){var s=t.table.core.schema.primaryKey,c=i;return t.table.core.count({trans:o,query:{index:s,range:c}}).then(function(l){return t.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(d){var h=d.failures;d.lastResult,d.results;var m=d.numFailures;if(m)throw new Or("Could not delete some values",Object.keys(h).map(function(b){return h[b]}),l-m);return l-m})})}):this.modify(Gi)},e}(),Gi=function(e,t){return t.value=null};function th(e){return zn(eh.prototype,function(i,o){this.db=e;var s=xc,c=null;if(o)try{s=o()}catch(m){c=m}var l=i._ctx,d=l.table,h=d.hook.reading.fire;this._ctx={table:d,index:l.index,isPrimKey:!l.index||d.schema.primKey.keyPath&&l.index===d.schema.primKey.name,range:s,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:l.or,valueMapper:h!==Wn?h:null}})}function nh(e,t){return e<t?-1:e===t?0:1}function rh(e,t){return e>t?-1:e===t?0:1}function Ge(e,t,i){var o=e instanceof kc?new e.Collection(e):e;return o._ctx.error=i?new i(t):new TypeError(t),o}function an(e){return new e.Collection(e,function(){return Cc("")}).limit(0)}function ih(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function oh(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function ah(e,t,i,o,s,c){for(var l=Math.min(e.length,o.length),d=-1,h=0;h<l;++h){var m=t[h];if(m!==o[h])return s(e[h],i[h])<0?e.substr(0,h)+i[h]+i.substr(h+1):s(e[h],o[h])<0?e.substr(0,h)+o[h]+i.substr(h+1):d>=0?e.substr(0,d)+t[d]+i.substr(d+1):null;s(e[h],m)<0&&(d=h)}return l<o.length&&c==="next"?e+i.substr(e.length):l<e.length&&c==="prev"?e.substr(0,i.length):d<0?null:e.substr(0,d)+o[d]+i.substr(d+1)}function wr(e,t,i,o){var s,c,l,d,h,m,b,v=i.length;if(!i.every(function(E){return typeof E=="string"}))return Ge(e,Ic);function T(E){s=ih(E),c=oh(E),l=E==="next"?nh:rh;var w=i.map(function(I){return{lower:c(I),upper:s(I)}}).sort(function(I,x){return l(I.lower,x.lower)});d=w.map(function(I){return I.upper}),h=w.map(function(I){return I.lower}),m=E,b=E==="next"?"":o}T("next");var R=new e.Collection(e,function(){return _t(d[0],h[v-1]+o)});R._ondirectionchange=function(E){T(E)};var _=0;return R._addAlgorithm(function(E,w,I){var x=E.key;if(typeof x!="string")return!1;var C=c(x);if(t(C,h,_))return!0;for(var A=null,k=_;k<v;++k){var F=ah(x,C,d[k],h[k],l,m);F===null&&A===null?_=k+1:(A===null||l(A,F)>0)&&(A=F)}return w(A!==null?function(){E.continue(A+b)}:I),!1}),R}function _t(e,t,i,o){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:o}}function Cc(e){return{type:1,lower:e,upper:e}}var kc=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,i,o,s){o=o!==!1,s=s===!0;try{return this._cmp(t,i)>0||this._cmp(t,i)===0&&(o||s)&&!(o&&s)?an(this):new this.Collection(this,function(){return _t(t,i,!o,!s)})}catch{return Ge(this,pt)}},e.prototype.equals=function(t){return t==null?Ge(this,pt):new this.Collection(this,function(){return Cc(t)})},e.prototype.above=function(t){return t==null?Ge(this,pt):new this.Collection(this,function(){return _t(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?Ge(this,pt):new this.Collection(this,function(){return _t(t,void 0,!1)})},e.prototype.below=function(t){return t==null?Ge(this,pt):new this.Collection(this,function(){return _t(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?Ge(this,pt):new this.Collection(this,function(){return _t(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?Ge(this,Ic):this.between(t,t+$t,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):wr(this,function(i,o){return i.indexOf(o[0])===0},[t],$t)},e.prototype.equalsIgnoreCase=function(t){return wr(this,function(i,o){return i===o[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=ht.apply(sn,arguments);return t.length===0?an(this):wr(this,function(i,o){return o.indexOf(i)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=ht.apply(sn,arguments);return t.length===0?an(this):wr(this,function(i,o){return o.some(function(s){return i.indexOf(s)===0})},t,$t)},e.prototype.anyOf=function(){var t=this,i=ht.apply(sn,arguments),o=this._cmp;try{i.sort(o)}catch{return Ge(this,pt)}if(i.length===0)return an(this);var s=new this.Collection(this,function(){return _t(i[0],i[i.length-1])});s._ondirectionchange=function(l){o=l==="next"?t._ascending:t._descending,i.sort(o)};var c=0;return s._addAlgorithm(function(l,d,h){for(var m=l.key;o(m,i[c])>0;)if(++c,c===i.length)return d(h),!1;return o(m,i[c])===0?!0:(d(function(){l.continue(i[c])}),!1)}),s},e.prototype.notEqual=function(t){return this.inAnyRange([[ao,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=ht.apply(sn,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Ge(this,pt)}var i=t.reduce(function(o,s){return o?o.concat([[o[o.length-1][1],s]]):[[ao,s]]},null);return i.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,i){var o=this,s=this._cmp,c=this._ascending,l=this._descending,d=this._min,h=this._max;if(t.length===0)return an(this);if(!t.every(function(k){return k[0]!==void 0&&k[1]!==void 0&&c(k[0],k[1])<=0}))return Ge(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",q.InvalidArgument);var m=!i||i.includeLowers!==!1,b=i&&i.includeUppers===!0;function v(k,F){for(var H=0,O=k.length;H<O;++H){var j=k[H];if(s(F[0],j[1])<0&&s(F[1],j[0])>0){j[0]=d(j[0],F[0]),j[1]=h(j[1],F[1]);break}}return H===O&&k.push(F),k}var T=c;function R(k,F){return T(k[0],F[0])}var _;try{_=t.reduce(v,[]),_.sort(R)}catch{return Ge(this,pt)}var E=0,w=b?function(k){return c(k,_[E][1])>0}:function(k){return c(k,_[E][1])>=0},I=m?function(k){return l(k,_[E][0])>0}:function(k){return l(k,_[E][0])>=0};function x(k){return!w(k)&&!I(k)}var C=w,A=new this.Collection(this,function(){return _t(_[0][0],_[_.length-1][1],!m,!b)});return A._ondirectionchange=function(k){k==="next"?(C=w,T=c):(C=I,T=l),_.sort(R)},A._addAlgorithm(function(k,F,H){for(var O=k.key;C(O);)if(++E,E===_.length)return F(H),!1;return x(O)?!0:(o._cmp(O,_[E][1])===0||o._cmp(O,_[E][0])===0||F(function(){T===c?k.continue(_[E][0]):k.continue(_[E][1])}),!1)}),A},e.prototype.startsWithAnyOf=function(){var t=ht.apply(sn,arguments);return t.every(function(i){return typeof i=="string"})?t.length===0?an(this):this.inAnyRange(t.map(function(i){return[i,i+$t]})):Ge(this,"startsWithAnyOf() only works with strings")},e}();function sh(e){return zn(kc.prototype,function(i,o,s){if(this.db=e,this._ctx={table:i,index:o===":id"?null:o,or:s},this._cmp=this._ascending=oe,this._descending=function(c,l){return oe(l,c)},this._max=function(c,l){return oe(c,l)>0?c:l},this._min=function(c,l){return oe(c,l)<0?c:l},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new q.MissingAPI})}function at(e){return me(function(t){return Kn(t),e(t.target.error),!1})}function Kn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Yn="storagemutated",so="x-storagemutated-1",kt=Gn(null,Yn),ch=function(){function e(){}return e.prototype._lock=function(){return Mn(!X.global),++this._reculock,this._reculock===1&&!X.global&&(X.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Mn(!X.global),--this._reculock===0)for(X.global||(X.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Gt(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&X.lockOwnerFor!==this},e.prototype.create=function(t){var i=this;if(!this.mode)return this;var o=this.db.idbdb,s=this.db._state.dbOpenError;if(Mn(!this.idbtrans),!t&&!o)switch(s&&s.name){case"DatabaseClosedError":throw new q.DatabaseClosed(s);case"MissingAPIError":throw new q.MissingAPI(s.message,s);default:throw new q.OpenFailed(s)}if(!this.active)throw new q.TransactionInactive;return Mn(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):o.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=me(function(c){Kn(c),i._reject(t.error)}),t.onabort=me(function(c){Kn(c),i.active&&i._reject(new q.Abort(t.error)),i.active=!1,i.on("abort").fire(c)}),t.oncomplete=me(function(){i.active=!1,i._resolve(),"mutatedParts"in t&&kt.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,i,o){var s=this;if(t==="readwrite"&&this.mode!=="readwrite")return we(new q.ReadOnly("Transaction is readonly"));if(!this.active)return we(new q.TransactionInactive);if(this._locked())return new z(function(l,d){s._blockedFuncs.push([function(){s._promise(t,i,o).then(l,d)},X])});if(o)return xt(function(){var l=new z(function(d,h){s._lock();var m=i(d,h,s);m&&m.then&&m.then(d,h)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var c=new z(function(l,d){var h=i(l,d,s);h&&h.then&&h.then(l,d)});return c._lib=!0,c},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var i=this._root(),o=z.resolve(t);if(i._waitingFor)i._waitingFor=i._waitingFor.then(function(){return o});else{i._waitingFor=o,i._waitingQueue=[];var s=i.idbtrans.objectStore(i.storeNames[0]);(function l(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(s.get(-1/0).onsuccess=l)})()}var c=i._waitingFor;return new z(function(l,d){o.then(function(h){return i._waitingQueue.push(me(l.bind(null,h)))},function(h){return i._waitingQueue.push(me(d.bind(null,h)))}).finally(function(){i._waitingFor===c&&(i._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new q.Abort))},e.prototype.table=function(t){var i=this._memoizedTables||(this._memoizedTables={});if(Ke(i,t))return i[t];var o=this.schema[t];if(!o)throw new q.NotFound("Table "+t+" not part of transaction");var s=new this.db.Table(t,o,this);return s.core=this.db.core.table(t),i[t]=s,s},e}();function uh(e){return zn(ch.prototype,function(i,o,s,c,l){var d=this;this.db=e,this.mode=i,this.storeNames=o,this.schema=s,this.chromeTransactionDurability=c,this.idbtrans=null,this.on=Gn(this,"complete","error","abort"),this.parent=l||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(h,m){d._resolve=h,d._reject=m}),this._completion.then(function(){d.active=!1,d.on.complete.fire()},function(h){var m=d.active;return d.active=!1,d.on.error.fire(h),d.parent?d.parent._reject(h):m&&d.idbtrans&&d.idbtrans.abort(),we(h)})})}function co(e,t,i,o,s,c,l){return{name:e,keyPath:t,unique:i,multi:o,auto:s,compound:c,src:(i&&!l?"&":"")+(o?"*":"")+(s?"++":"")+Ac(t)}}function Ac(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Eo(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:_p(i,function(o){return[o.name,o]})}}function lh(e){return e.length===1?e[0]:e}var Hn=function(e){try{return e.only([[]]),Hn=function(){return[[]]},[[]]}catch{return Hn=function(){return $t},$t}};function uo(e){return e==null?function(){}:typeof e=="string"?fh(e):function(t){return mt(t,e)}}function fh(e){var t=e.split(".");return t.length===1?function(i){return i[e]}:function(i){return mt(i,e)}}function tc(e){return[].slice.call(e)}var dh=0;function jn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ph(e,t,i){function o(v,T){var R=tc(v.objectStoreNames);return{schema:{name:v.name,tables:R.map(function(_){return T.objectStore(_)}).map(function(_){var E=_.keyPath,w=_.autoIncrement,I=ge(E),x=E==null,C={},A={name:_.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:x,compound:I,keyPath:E,autoIncrement:w,unique:!0,extractKey:uo(E)},indexes:tc(_.indexNames).map(function(k){return _.index(k)}).map(function(k){var F=k.name,H=k.unique,O=k.multiEntry,j=k.keyPath,L=ge(j),M={name:F,compound:L,keyPath:j,unique:H,multiEntry:O,extractKey:uo(j)};return C[jn(j)]=M,M}),getIndexByKeyPath:function(k){return C[jn(k)]}};return C[":id"]=A.primaryKey,E!=null&&(C[jn(E)]=A.primaryKey),A})},hasGetAll:R.length>0&&"getAll"in T.objectStore(R[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function s(v){if(v.type===3)return null;if(v.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=v.lower,R=v.upper,_=v.lowerOpen,E=v.upperOpen,w=T===void 0?R===void 0?null:t.upperBound(R,!!E):R===void 0?t.lowerBound(T,!!_):t.bound(T,R,!!_,!!E);return w}function c(v){var T=v.name;function R(w){var I=w.trans,x=w.type,C=w.keys,A=w.values,k=w.range;return new Promise(function(F,H){F=me(F);var O=I.objectStore(T),j=O.keyPath==null,L=x==="put"||x==="add";if(!L&&x!=="delete"&&x!=="deleteRange")throw new Error("Invalid operation type: "+x);var M=(C||A||{length:1}).length;if(C&&A&&C.length!==A.length)throw new Error("Given keys array must have same length as given values array.");if(M===0)return F({numFailures:0,failures:{},results:[],lastResult:void 0});var D,K=[],W=[],$=0,G=function(re){++$,Kn(re)};if(x==="deleteRange"){if(k.type===4)return F({numFailures:$,failures:W,results:[],lastResult:void 0});k.type===3?K.push(D=O.clear()):K.push(D=O.delete(s(k)))}else{var se=L?j?[A,C]:[A,null]:[C,null],ve=se[0],be=se[1];if(L)for(var de=0;de<M;++de)K.push(D=be&&be[de]!==void 0?O[x](ve[de],be[de]):O[x](ve[de])),D.onerror=G;else for(var de=0;de<M;++de)K.push(D=O[x](ve[de])),D.onerror=G}var Ee=function(re){var U=re.target.result;K.forEach(function(ae,V){return ae.error!=null&&(W[V]=ae.error)}),F({numFailures:$,failures:W,results:x==="delete"?C:K.map(function(ae){return ae.result}),lastResult:U})};D.onerror=function(re){G(re),Ee(re)},D.onsuccess=Ee})}function _(w){var I=w.trans,x=w.values,C=w.query,A=w.reverse,k=w.unique;return new Promise(function(F,H){F=me(F);var O=C.index,j=C.range,L=I.objectStore(T),M=O.isPrimaryKey?L:L.index(O.name),D=A?k?"prevunique":"prev":k?"nextunique":"next",K=x||!("openKeyCursor"in M)?M.openCursor(s(j),D):M.openKeyCursor(s(j),D);K.onerror=at(H),K.onsuccess=me(function(W){var $=K.result;if(!$){F(null);return}$.___id=++dh,$.done=!1;var G=$.continue.bind($),se=$.continuePrimaryKey;se&&(se=se.bind($));var ve=$.advance.bind($),be=function(){throw new Error("Cursor not started")},de=function(){throw new Error("Cursor not stopped")};$.trans=I,$.stop=$.continue=$.continuePrimaryKey=$.advance=be,$.fail=me(H),$.next=function(){var Ee=this,re=1;return this.start(function(){return re--?Ee.continue():Ee.stop()}).then(function(){return Ee})},$.start=function(Ee){var re=new Promise(function(ae,V){ae=me(ae),K.onerror=at(V),$.fail=V,$.stop=function(Be){$.stop=$.continue=$.continuePrimaryKey=$.advance=de,ae(Be)}}),U=function(){if(K.result)try{Ee()}catch(ae){$.fail(ae)}else $.done=!0,$.start=function(){throw new Error("Cursor behind last entry")},$.stop()};return K.onsuccess=me(function(ae){K.onsuccess=U,U()}),$.continue=G,$.continuePrimaryKey=se,$.advance=ve,U(),re},F($)},H)})}function E(w){return function(I){return new Promise(function(x,C){x=me(x);var A=I.trans,k=I.values,F=I.limit,H=I.query,O=F===1/0?void 0:F,j=H.index,L=H.range,M=A.objectStore(T),D=j.isPrimaryKey?M:M.index(j.name),K=s(L);if(F===0)return x({result:[]});if(w){var W=k?D.getAll(K,O):D.getAllKeys(K,O);W.onsuccess=function(ve){return x({result:ve.target.result})},W.onerror=at(C)}else{var $=0,G=k||!("openKeyCursor"in D)?D.openCursor(K):D.openKeyCursor(K),se=[];G.onsuccess=function(ve){var be=G.result;if(!be)return x({result:se});if(se.push(k?be.value:be.primaryKey),++$===F)return x({result:se});be.continue()},G.onerror=at(C)}})}}return{name:T,schema:v,mutate:R,getMany:function(w){var I=w.trans,x=w.keys;return new Promise(function(C,A){C=me(C);for(var k=I.objectStore(T),F=x.length,H=new Array(F),O=0,j=0,L,M=function($){var G=$.target;(H[G._pos]=G.result)!=null,++j===O&&C(H)},D=at(A),K=0;K<F;++K){var W=x[K];W!=null&&(L=k.get(x[K]),L._pos=K,L.onsuccess=M,L.onerror=D,++O)}O===0&&C(H)})},get:function(w){var I=w.trans,x=w.key;return new Promise(function(C,A){C=me(C);var k=I.objectStore(T),F=k.get(x);F.onsuccess=function(H){return C(H.target.result)},F.onerror=at(A)})},query:E(h),openCursor:_,count:function(w){var I=w.query,x=w.trans,C=I.index,A=I.range;return new Promise(function(k,F){var H=x.objectStore(T),O=C.isPrimaryKey?H:H.index(C.name),j=s(A),L=j?O.count(j):O.count();L.onsuccess=me(function(M){return k(M.target.result)}),L.onerror=at(F)})}}}var l=o(e,i),d=l.schema,h=l.hasGetAll,m=d.tables.map(function(v){return c(v)}),b={};return m.forEach(function(v){return b[v.name]=v}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(v){var T=b[v];if(!T)throw new Error("Table '".concat(v,"' not found"));return b[v]},MIN_KEY:-1/0,MAX_KEY:Hn(t),schema:d}}function hh(e,t){return t.reduce(function(i,o){var s=o.create;return ee(ee({},i),s(i))},e)}function mh(e,t,i,o){var s=i.IDBKeyRange;i.indexedDB;var c=hh(ph(t,s,o),e.dbcore);return{dbcore:c}}function Nr(e,t){var i=t.db,o=mh(e._middlewares,i,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(s){var c=s.name;e.core.schema.tables.some(function(l){return l.name===c})&&(s.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=s.core))})}function Lr(e,t,i,o){i.forEach(function(s){var c=o[s];t.forEach(function(l){var d=uc(l,s);(!d||"value"in d&&d.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?It(l,s,{get:function(){return this.table(s)},set:function(h){cc(this,s,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):l[s]=new e.Table(s,c))})})}function lo(e,t){t.forEach(function(i){for(var o in i)i[o]instanceof e.Table&&delete i[o]})}function gh(e,t){return e._cfg.version-t._cfg.version}function yh(e,t,i,o){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Eo("$meta",Dc("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,s);c.create(i),c._completion.catch(o);var l=c._reject.bind(c),d=X.transless||X;xt(function(){if(X.trans=c,X.transless=d,t===0)xe(s).forEach(function(h){xo(i,h,s[h].primKey,s[h].indexes)}),Nr(e,i),z.follow(function(){return e.on.populate.fire(c)}).catch(l);else return Nr(e,i),bh(e,c,t).then(function(h){return _h(e,h,c,i)}).catch(l)})}function vh(e,t){Pc(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=Gr(e,e.idbdb,t);jr(e,e._dbSchema,t);for(var o=Io(i,e._dbSchema),s=function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=t.objectStore(m.name);m.add.forEach(function(v){st&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(v.src)),Br(b,v)})},c=0,l=o.change;c<l.length;c++){var d=l[c],h=s(d);if(typeof h=="object")return h.value}}function bh(e,t,i){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(o){return o??i}):z.resolve(i)}function _h(e,t,i,o){var s=[],c=e._versions,l=e._dbSchema=Gr(e,e.idbdb,o),d=c.filter(function(m){return m._cfg.version>=t});if(d.length===0)return z.resolve();d.forEach(function(m){s.push(function(){var b=l,v=m._cfg.dbschema;jr(e,b,o),jr(e,v,o),l=e._dbSchema=v;var T=Io(b,v);T.add.forEach(function(x){xo(o,x[0],x[1].primKey,x[1].indexes)}),T.change.forEach(function(x){if(x.recreate)throw new q.Upgrade("Not yet support for changing primary key");var C=o.objectStore(x.name);x.add.forEach(function(A){return Br(C,A)}),x.change.forEach(function(A){C.deleteIndex(A.name),Br(C,A)}),x.del.forEach(function(A){return C.deleteIndex(A)})});var R=m._cfg.contentUpgrade;if(R&&m._cfg.version>t){Nr(e,o),i._memoizedTables={};var _=dc(v);T.del.forEach(function(x){_[x]=b[x]}),lo(e,[e.Transaction.prototype]),Lr(e,[e.Transaction.prototype],xe(_),_),i.schema=_;var E=mo(R);E&&gn();var w,I=z.follow(function(){if(w=R(i),w&&E){var x=Tt.bind(null,null);w.then(x,x)}});return w&&typeof w.then=="function"?z.resolve(w):I.then(function(){return w})}}),s.push(function(b){var v=m._cfg.dbschema;wh(v,b),lo(e,[e.Transaction.prototype]),Lr(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),i.schema=e._dbSchema}),s.push(function(b){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===m._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(v){return v!=="$meta"})):b.objectStore("$meta").put(m._cfg.version,"version"))})});function h(){return s.length?z.resolve(s.shift()(i.idbtrans)).then(h):z.resolve()}return h().then(function(){Pc(l,o)})}function Io(e,t){var i={del:[],add:[],change:[]},o;for(o in e)t[o]||i.del.push(o);for(o in t){var s=e[o],c=t[o];if(!s)i.add.push([o,c]);else{var l={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)l.recreate=!0,i.change.push(l);else{var d=s.idxByName,h=c.idxByName,m=void 0;for(m in d)h[m]||l.del.push(m);for(m in h){var b=d[m],v=h[m];b?b.src!==v.src&&l.change.push(v):l.add.push(v)}(l.del.length>0||l.add.length>0||l.change.length>0)&&i.change.push(l)}}}return i}function xo(e,t,i,o){var s=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return o.forEach(function(c){return Br(s,c)}),s}function Pc(e,t){xe(e).forEach(function(i){t.db.objectStoreNames.contains(i)||(st&&console.debug("Dexie: Creating missing table",i),xo(t,i,e[i].primKey,e[i].indexes))})}function wh(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(i){return e[i]==null&&t.db.deleteObjectStore(i)})}function Br(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Gr(e,t,i){var o={},s=Hr(t.objectStoreNames,0);return s.forEach(function(c){for(var l=i.objectStore(c),d=l.keyPath,h=co(Ac(d),d||"",!0,!1,!!l.autoIncrement,d&&typeof d!="string",!0),m=[],b=0;b<l.indexNames.length;++b){var v=l.index(l.indexNames[b]);d=v.keyPath;var T=co(v.name,d,!!v.unique,!!v.multiEntry,!1,d&&typeof d!="string",!1);m.push(T)}o[c]=Eo(c,h,m)}),o}function Sh(e,t,i){e.verno=t.version/10;var o=e._dbSchema=Gr(e,t,i);e._storeNames=Hr(t.objectStoreNames,0),Lr(e,[e._allTables],xe(o),o)}function Eh(e,t){var i=Gr(e,e.idbdb,t),o=Io(i,e._dbSchema);return!(o.add.length||o.change.some(function(s){return s.add.length||s.change.length}))}function jr(e,t,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var c=o[s],l=i.objectStore(c);e._hasGetAll="getAll"in l;for(var d=0;d<l.indexNames.length;++d){var h=l.indexNames[d],m=l.index(h).keyPath,b=typeof m=="string"?m:"["+Hr(m).join("+")+"]";if(t[c]){var v=t[c].idxByName[b];v&&(v.name=h,delete t[c].idxByName[b],t[c].idxByName[h]=v)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&De.WorkerGlobalScope&&De instanceof De.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Dc(e){return e.split(",").map(function(t,i){t=t.trim();var o=t.replace(/([&*]|\+\+)/g,""),s=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return co(o,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),ge(s),i===0)})}var Ih=function(){function e(){}return e.prototype._parseStoresSpec=function(t,i){xe(t).forEach(function(o){if(t[o]!==null){var s=Dc(t[o]),c=s.shift();if(c.unique=!0,c.multi)throw new q.Schema("Primary key cannot be multi-valued");s.forEach(function(l){if(l.auto)throw new q.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new q.Schema("Index must have a name and cannot be an empty string")}),i[o]=Eo(o,c,s)}})},e.prototype.stores=function(t){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?Ye(this._cfg.storesSource,t):t;var o=i._versions,s={},c={};return o.forEach(function(l){Ye(s,l._cfg.storesSource),c=l._cfg.dbschema={},l._parseStoresSpec(s,c)}),i._dbSchema=c,lo(i,[i._allTables,i,i.Transaction.prototype]),Lr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],xe(c),c),i._storeNames=xe(c),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=vo(this._cfg.contentUpgrade||fe,t),this},e}();function xh(e){return zn(Ih.prototype,function(i){this.db=e,this._cfg={version:i,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function To(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new At(Wr,{addons:[],indexedDB:e,IDBKeyRange:t}),i.version(1).stores({dbnames:"name"})),i.table("dbnames")}function Co(e){return e&&typeof e.databases=="function"}function Th(e){var t=e.indexedDB,i=e.IDBKeyRange;return Co(t)?Promise.resolve(t.databases()).then(function(o){return o.map(function(s){return s.name}).filter(function(s){return s!==Wr})}):To(t,i).toCollection().primaryKeys()}function Ch(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!Co(i)&&t!==Wr&&To(i,o).put({name:t}).catch(fe)}function kh(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!Co(i)&&t!==Wr&&To(i,o).delete(t).catch(fe)}function fo(e){return xt(function(){return X.letThrough=!0,e()})}function Ah(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(i){var o=function(){return indexedDB.databases().finally(i)};t=setInterval(o,100),o()}).finally(function(){return clearInterval(t)})}var zi;function ko(e){return!("from"in e)}var Ue=function(e,t){if(this)Ye(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var i=new Ue;return e&&"d"in e&&Ye(i,e),i}};fn(Ue.prototype,(zi={add:function(e){return $r(this,e),this},addKey:function(e){return Vn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(i){return Vn(t,i,i)}),this},hasKey:function(e){var t=Ur(this).next(e).value;return t&&oe(t.from,e)<=0&&oe(t.to,e)>=0}},zi[eo]=function(){return Ur(this)},zi));function Vn(e,t,i){var o=oe(t,i);if(!isNaN(o)){if(o>0)throw RangeError();if(ko(e))return Ye(e,{from:t,to:i,d:1});var s=e.l,c=e.r;if(oe(i,e.from)<0)return s?Vn(s,t,i):e.l={from:t,to:i,d:1,l:null,r:null},nc(e);if(oe(t,e.to)>0)return c?Vn(c,t,i):e.r={from:t,to:i,d:1,l:null,r:null},nc(e);oe(t,e.from)<0&&(e.from=t,e.l=null,e.d=c?c.d+1:1),oe(i,e.to)>0&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1);var l=!e.r;s&&!e.l&&$r(e,s),c&&l&&$r(e,c)}}function $r(e,t){function i(o,s){var c=s.from,l=s.to,d=s.l,h=s.r;Vn(o,c,l),d&&i(o,d),h&&i(o,h)}ko(t)||i(e,t)}function Ph(e,t){var i=Ur(t),o=i.next();if(o.done)return!1;for(var s=o.value,c=Ur(e),l=c.next(s.from),d=l.value;!o.done&&!l.done;){if(oe(d.from,s.to)<=0&&oe(d.to,s.from)>=0)return!0;oe(s.from,d.from)<0?s=(o=i.next(d.from)).value:d=(l=c.next(s.from)).value}return!1}function Ur(e){var t=ko(e)?null:{s:0,n:e};return{next:function(i){for(var o=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,o)for(;t.n.l&&oe(i,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!o||oe(i,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function nc(e){var t,i,o=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0),s=o>1?"r":o<-1?"l":"";if(s){var c=s==="r"?"l":"r",l=ee({},e),d=e[s];e.from=d.from,e.to=d.to,e[s]=d[s],l[s]=d[c],e[c]=l,l.d=rc(l)}e.d=rc(e)}function rc(e){var t=e.r,i=e.l;return(t?i?Math.max(t.d,i.d):t.d:i?i.d:0)+1}function zr(e,t){return xe(t).forEach(function(i){e[i]?$r(e[i],t[i]):e[i]=mc(t[i])}),e}function Ao(e,t){return e.all||t.all||Object.keys(e).some(function(i){return t[i]&&Ph(t[i],e[i])})}var Ht={},Yi={},Ji=!1;function Sr(e,t){zr(Yi,e),Ji||(Ji=!0,setTimeout(function(){Ji=!1;var i=Yi;Yi={},Po(i,!1)},0))}function Po(e,t){t===void 0&&(t=!1);var i=new Set;if(e.all)for(var o=0,s=Object.values(Ht);o<s.length;o++){var c=s[o];ic(c,e,i,t)}else for(var l in e){var d=/^idb\:\/\/(.*)\/(.*)\//.exec(l);if(d){var h=d[1],m=d[2],c=Ht["idb://".concat(h,"/").concat(m)];c&&ic(c,e,i,t)}}i.forEach(function(b){return b()})}function ic(e,t,i,o){for(var s=[],c=0,l=Object.entries(e.queries.query);c<l.length;c++){for(var d=l[c],h=d[0],m=d[1],b=[],v=0,T=m;v<T.length;v++){var R=T[v];Ao(t,R.obsSet)?R.subscribers.forEach(function(I){return i.add(I)}):o&&b.push(R)}o&&s.push([h,b])}if(o)for(var _=0,E=s;_<E.length;_++){var w=E[_],h=w[0],b=w[1];e.queries.query[h]=b}}function Dh(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?we(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var o=t.openCanceller,s=Math.round(e.verno*10),c=!1;function l(){if(t.openCanceller!==o)throw new q.DatabaseClosed("db.open() was cancelled")}var d=t.dbReadyResolve,h=null,m=!1,b=function(){return new z(function(v,T){if(l(),!i)throw new q.MissingAPI;var R=e.name,_=t.autoSchema||!s?i.open(R):i.open(R,s);if(!_)throw new q.MissingAPI;_.onerror=at(T),_.onblocked=me(e._fireOnBlocked),_.onupgradeneeded=me(function(E){if(h=_.transaction,t.autoSchema&&!e._options.allowEmptyDB){_.onerror=Kn,h.abort(),_.result.close();var w=i.deleteDatabase(R);w.onsuccess=w.onerror=me(function(){T(new q.NoSuchDatabase("Database ".concat(R," doesnt exist")))})}else{h.onerror=at(T);var I=E.oldVersion>Math.pow(2,62)?0:E.oldVersion;m=I<1,e.idbdb=_.result,c&&vh(e,h),yh(e,I/10,h,T)}},T),_.onsuccess=me(function(){h=null;var E=e.idbdb=_.result,w=Hr(E.objectStoreNames);if(w.length>0)try{var I=E.transaction(lh(w),"readonly");if(t.autoSchema)Sh(e,E,I);else if(jr(e,e._dbSchema,I),!Eh(e,I)&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),E.close(),s=E.version+1,c=!0,v(b());Nr(e,I)}catch{}un.push(e),E.onversionchange=me(function(x){t.vcFired=!0,e.on("versionchange").fire(x)}),E.onclose=me(function(x){e.on("close").fire(x)}),m&&Ch(e._deps,R),v()},T)}).catch(function(v){switch(v?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(s>0)return s=0,b();break}return z.reject(v)})};return z.race([o,(typeof navigator>"u"?z.resolve():Ah()).then(b)]).then(function(){return l(),t.onReadyBeingFired=[],z.resolve(fo(function(){return e.on.ready.fire(e.vip)})).then(function v(){if(t.onReadyBeingFired.length>0){var T=t.onReadyBeingFired.reduce(vo,fe);return t.onReadyBeingFired=[],z.resolve(fo(function(){return T(e.vip)})).then(v)}})}).finally(function(){t.openCanceller===o&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(v){t.dbOpenError=v;try{h&&h.abort()}catch{}return o===t.openCanceller&&e._close(),we(v)}).finally(function(){t.openComplete=!0,d()}).then(function(){if(m){var v={};e.tables.forEach(function(T){T.schema.indexes.forEach(function(R){R.name&&(v["idb://".concat(e.name,"/").concat(T.name,"/").concat(R.name)]=new Ue(-1/0,[[[]]]))}),v["idb://".concat(e.name,"/").concat(T.name,"/")]=v["idb://".concat(e.name,"/").concat(T.name,"/:dels")]=new Ue(-1/0,[[[]]])}),kt(Yn).fire(v),Po(v,!0)}return e})}function po(e){var t=function(l){return e.next(l)},i=function(l){return e.throw(l)},o=c(t),s=c(i);function c(l){return function(d){var h=l(d),m=h.value;return h.done?m:!m||typeof m.then!="function"?ge(m)?Promise.all(m).then(o,s):o(m):m.then(o,s)}}return c(t)()}function Oh(e,t,i){var o=arguments.length;if(o<2)throw new q.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];i=s.pop();var c=pc(s);return[e,c,i]}function Oc(e,t,i,o,s){return z.resolve().then(function(){var c=X.transless||X,l=e._createTransaction(t,i,e._dbSchema,o);l.explicit=!0;var d={trans:l,transless:c};if(o)l.idbtrans=o.idbtrans;else try{l.create(),l.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(v){return v.name===yo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Oc(e,t,i,null,s)})):we(v)}var h=mo(s);h&&gn();var m,b=z.follow(function(){if(m=s.call(l,l),m)if(h){var v=Tt.bind(null,null);m.then(v,v)}else typeof m.next=="function"&&typeof m.throw=="function"&&(m=po(m))},d);return(m&&typeof m.then=="function"?z.resolve(m).then(function(v){return l.active?v:we(new q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):b.then(function(){return m})).then(function(v){return o&&l._resolve(),l._completion.then(function(){return v})}).catch(function(v){return l._reject(v),we(v)})})}function Er(e,t,i){for(var o=ge(e)?e.slice():[e],s=0;s<i;++s)o.push(t);return o}function Rh(e){return ee(ee({},e),{table:function(t){var i=e.table(t),o=i.schema,s={},c=[];function l(E,w,I){var x=jn(E),C=s[x]=s[x]||[],A=E==null?0:typeof E=="string"?1:E.length,k=w>0,F=ee(ee({},I),{name:k?"".concat(x,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:k,keyTail:w,keyLength:A,extractKey:uo(E),unique:!k&&I.unique});if(C.push(F),F.isPrimaryKey||c.push(F),A>1){var H=A===2?E[0]:E.slice(0,A-1);l(H,w+1,I)}return C.sort(function(O,j){return O.keyTail-j.keyTail}),F}var d=l(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[d];for(var h=0,m=o.indexes;h<m.length;h++){var b=m[h];l(b.keyPath,0,b)}function v(E){var w=s[jn(E)];return w&&w[0]}function T(E,w){return{type:E.type===1?2:E.type,lower:Er(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:Er(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0}}function R(E){var w=E.query.index;return w.isVirtual?ee(ee({},E),{query:{index:w.lowLevelIndex,range:T(E.query.range,w.keyTail)}}):E}var _=ee(ee({},i),{schema:ee(ee({},o),{primaryKey:d,indexes:c,getIndexByKeyPath:v}),count:function(E){return i.count(R(E))},query:function(E){return i.query(R(E))},openCursor:function(E){var w=E.query.index,I=w.keyTail,x=w.isVirtual,C=w.keyLength;if(!x)return i.openCursor(E);function A(k){function F(O){O!=null?k.continue(Er(O,E.reverse?e.MAX_KEY:e.MIN_KEY,I)):E.unique?k.continue(k.key.slice(0,C).concat(E.reverse?e.MIN_KEY:e.MAX_KEY,I)):k.continue()}var H=Object.create(k,{continue:{value:F},continuePrimaryKey:{value:function(O,j){k.continuePrimaryKey(Er(O,e.MAX_KEY,I),j)}},primaryKey:{get:function(){return k.primaryKey}},key:{get:function(){var O=k.key;return C===1?O[0]:O.slice(0,C)}},value:{get:function(){return k.value}}});return H}return i.openCursor(R(E)).then(function(k){return k&&A(k)})}});return _}})}var Fh={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Rh};function Do(e,t,i,o){return i=i||{},o=o||"",xe(e).forEach(function(s){if(!Ke(t,s))i[o+s]=void 0;else{var c=e[s],l=t[s];if(typeof c=="object"&&typeof l=="object"&&c&&l){var d=Zi(c),h=Zi(l);d!==h?i[o+s]=t[s]:d==="Object"?Do(c,l,i,o+s+"."):c!==l&&(i[o+s]=t[s])}else c!==l&&(i[o+s]=t[s])}}),xe(t).forEach(function(s){Ke(e,s)||(i[o+s]=t[s])}),i}function Oo(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Mh={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return ee(ee({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,s=ee(ee({},i),{mutate:function(c){var l=X.trans,d=l.table(t).hook,h=d.deleting,m=d.creating,b=d.updating;switch(c.type){case"add":if(m.fire===fe)break;return l._promise("readwrite",function(){return v(c)},!0);case"put":if(m.fire===fe&&b.fire===fe)break;return l._promise("readwrite",function(){return v(c)},!0);case"delete":if(h.fire===fe)break;return l._promise("readwrite",function(){return v(c)},!0);case"deleteRange":if(h.fire===fe)break;return l._promise("readwrite",function(){return T(c)},!0)}return i.mutate(c);function v(_){var E=X.trans,w=_.keys||Oo(o,_);if(!w)throw new Error("Keys missing");return _=_.type==="add"||_.type==="put"?ee(ee({},_),{keys:w}):ee({},_),_.type!=="delete"&&(_.values=Dr([],_.values,!0)),_.keys&&(_.keys=Dr([],_.keys,!0)),Nh(i,_,w).then(function(I){var x=w.map(function(C,A){var k=I[A],F={onerror:null,onsuccess:null};if(_.type==="delete")h.fire.call(F,C,k,E);else if(_.type==="add"||k===void 0){var H=m.fire.call(F,C,_.values[A],E);C==null&&H!=null&&(C=H,_.keys[A]=C,o.outbound||ze(_.values[A],o.keyPath,C))}else{var O=Do(k,_.values[A]),j=b.fire.call(F,O,C,k,E);if(j){var L=_.values[A];Object.keys(j).forEach(function(M){Ke(L,M)?L[M]=j[M]:ze(L,M,j[M])})}}return F});return i.mutate(_).then(function(C){for(var A=C.failures,k=C.results,F=C.numFailures,H=C.lastResult,O=0;O<w.length;++O){var j=k?k[O]:w[O],L=x[O];j==null?L.onerror&&L.onerror(A[O]):L.onsuccess&&L.onsuccess(_.type==="put"&&I[O]?_.values[O]:j)}return{failures:A,results:k,numFailures:F,lastResult:H}}).catch(function(C){return x.forEach(function(A){return A.onerror&&A.onerror(C)}),Promise.reject(C)})})}function T(_){return R(_.trans,_.range,1e4)}function R(_,E,w){return i.query({trans:_,values:!1,query:{index:o,range:E},limit:w}).then(function(I){var x=I.result;return v({type:"delete",keys:x,trans:_}).then(function(C){return C.numFailures>0?Promise.reject(C.failures[0]):x.length<w?{failures:[],numFailures:0,lastResult:void 0}:R(_,ee(ee({},E),{lower:x[x.length-1],lowerOpen:!0}),w)})})}}});return s}})}};function Nh(e,t,i){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:i,cache:"immutable"})}function Rc(e,t,i){try{if(!t||t.keys.length<e.length)return null;for(var o=[],s=0,c=0;s<t.keys.length&&c<e.length;++s)oe(t.keys[s],e[c])===0&&(o.push(i?Vt(t.values[s]):t.values[s]),++c);return o.length===e.length?o:null}catch{return null}}var Lh={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var i=e.table(t);return ee(ee({},i),{getMany:function(o){if(!o.cache)return i.getMany(o);var s=Rc(o.keys,o.trans._cache,o.cache==="clone");return s?z.resolve(s):i.getMany(o).then(function(c){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?Vt(c):c},c})},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),i.mutate(o)}})}}}};function Fc(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Mc(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Bh={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,i=new Ue(e.MIN_KEY,e.MAX_KEY);return ee(ee({},e),{transaction:function(o,s,c){if(X.subscr&&s!=="readonly")throw new q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(X.querier));return e.transaction(o,s,c)},table:function(o){var s=e.table(o),c=s.schema,l=c.primaryKey,d=c.indexes,h=l.extractKey,m=l.outbound,b=l.autoIncrement&&d.filter(function(_){return _.compound&&_.keyPath.includes(l.keyPath)}),v=ee(ee({},s),{mutate:function(_){var E=_.trans,w=_.mutatedParts||(_.mutatedParts={}),I=function(M){var D="idb://".concat(t,"/").concat(o,"/").concat(M);return w[D]||(w[D]=new Ue)},x=I(""),C=I(":dels"),A=_.type,k=_.type==="deleteRange"?[_.range]:_.type==="delete"?[_.keys]:_.values.length<50?[Oo(l,_).filter(function(M){return M}),_.values]:[],F=k[0],H=k[1],O=_.trans._cache;if(ge(F)){x.addKeys(F);var j=A==="delete"||F.length===H.length?Rc(F,O):null;j||C.addKeys(F),(j||H)&&jh(I,c,j,H)}else if(F){var L={from:F.lower,to:F.upper};C.add(L),x.add(L)}else x.add(i),C.add(i),c.indexes.forEach(function(M){return I(M.name).add(i)});return s.mutate(_).then(function(M){return F&&(_.type==="add"||_.type==="put")&&(x.addKeys(M.results),b&&b.forEach(function(D){var K=_.values.map(function($){return D.extractKey($)}),W=D.keyPath.findIndex(function($){return $===l.keyPath});M.results.forEach(function($){return K[W]=$}),I(D.name).addKeys(K)})),E.mutatedParts=zr(E.mutatedParts||{},w),M})}}),T=function(_){var E,w,I=_.query,x=I.index,C=I.range;return[x,new Ue((E=C.lower)!==null&&E!==void 0?E:e.MIN_KEY,(w=C.upper)!==null&&w!==void 0?w:e.MAX_KEY)]},R={get:function(_){return[l,new Ue(_.key)]},getMany:function(_){return[l,new Ue().addKeys(_.keys)]},count:T,query:T,openCursor:T};return xe(R).forEach(function(_){v[_]=function(E){var w=X.subscr,I=!!w,x=Fc(X,s)&&Mc(_,E),C=x?E.obsSet={}:w;if(I){var A=function(M){var D="idb://".concat(t,"/").concat(o,"/").concat(M);return C[D]||(C[D]=new Ue)},k=A(""),F=A(":dels"),H=R[_](E),O=H[0],j=H[1];if(_==="query"&&O.isPrimaryKey&&!E.values?F.add(j):A(O.name||"").add(j),!O.isPrimaryKey)if(_==="count")F.add(i);else{var L=_==="query"&&m&&E.values&&s.query(ee(ee({},E),{values:!1}));return s[_].apply(this,arguments).then(function(M){if(_==="query"){if(m&&E.values)return L.then(function($){var G=$.result;return k.addKeys(G),M});var D=E.values?M.result.map(h):M.result;E.values?k.addKeys(D):F.addKeys(D)}else if(_==="openCursor"){var K=M,W=E.values;return K&&Object.create(K,{key:{get:function(){return F.addKey(K.primaryKey),K.key}},primaryKey:{get:function(){var $=K.primaryKey;return F.addKey($),$}},value:{get:function(){return W&&k.addKey(K.primaryKey),K.value}}})}return M})}}return s[_].apply(this,arguments)}}),v}})}};function jh(e,t,i,o){function s(c){var l=e(c.name||"");function d(m){return m!=null?c.extractKey(m):null}var h=function(m){return c.multiEntry&&ge(m)?m.forEach(function(b){return l.addKey(b)}):l.addKey(m)};(i||o).forEach(function(m,b){var v=i&&d(i[b]),T=o&&d(o[b]);oe(v,T)!==0&&(v!=null&&h(v),T!=null&&h(T))})}t.indexes.forEach(s)}function oc(e,t,i){if(i.numFailures===0)return t;if(t.type==="deleteRange")return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(i.numFailures===o)return null;var s=ee({},t);return ge(s.keys)&&(s.keys=s.keys.filter(function(c,l){return!(l in i.failures)})),"values"in s&&ge(s.values)&&(s.values=s.values.filter(function(c,l){return!(l in i.failures)})),s}function $h(e,t){return t.lower===void 0?!0:t.lowerOpen?oe(e,t.lower)>0:oe(e,t.lower)>=0}function Uh(e,t){return t.upper===void 0?!0:t.upperOpen?oe(e,t.upper)<0:oe(e,t.upper)<=0}function Xi(e,t){return $h(e,t)&&Uh(e,t)}function ac(e,t,i,o,s,c){if(!i||i.length===0)return e;var l=t.query.index,d=l.multiEntry,h=t.query.range,m=o.schema.primaryKey,b=m.extractKey,v=l.extractKey,T=(l.lowLevelIndex||l).extractKey,R=i.reduce(function(_,E){var w=_,I=[];if(E.type==="add"||E.type==="put")for(var x=new Ue,C=E.values.length-1;C>=0;--C){var A=E.values[C],k=b(A);if(!x.hasKey(k)){var F=v(A);(d&&ge(F)?F.some(function(L){return Xi(L,h)}):Xi(F,h))&&(x.addKey(k),I.push(A))}}switch(E.type){case"add":w=_.concat(t.values?I:I.map(function(L){return b(L)}));break;case"put":var H=new Ue().addKeys(E.values.map(function(L){return b(L)}));w=_.filter(function(L){return!H.hasKey(t.values?b(L):L)}).concat(t.values?I:I.map(function(L){return b(L)}));break;case"delete":var O=new Ue().addKeys(E.keys);w=_.filter(function(L){return!O.hasKey(t.values?b(L):L)});break;case"deleteRange":var j=E.range;w=_.filter(function(L){return!Xi(b(L),j)});break}return w},e);return R===e?e:(R.sort(function(_,E){return oe(T(_),T(E))||oe(b(_),b(E))}),t.limit&&t.limit<1/0&&(R.length>t.limit?R.length=t.limit:e.length===t.limit&&R.length<t.limit&&(s.dirty=!0)),c?Object.freeze(R):R)}function sc(e,t){return oe(e.lower,t.lower)===0&&oe(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Kh(e,t,i,o){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var s=oe(e,t);if(s===0){if(i&&o)return 0;if(i)return 1;if(o)return-1}return s}function Hh(e,t,i,o){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var s=oe(e,t);if(s===0){if(i&&o)return 0;if(i)return-1;if(o)return 1}return s}function Vh(e,t){return Kh(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Hh(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Wh(e,t,i,o){var s=Ht["idb://".concat(e,"/").concat(t)];if(!s)return[];var c=s.queries[i];if(!c)return[null,!1,s,null];var l=o.query?o.query.index.name:null,d=c[l||""];if(!d)return[null,!1,s,null];switch(i){case"query":var h=d.find(function(v){return v.req.limit===o.limit&&v.req.values===o.values&&sc(v.req.query.range,o.query.range)});if(h)return[h,!0,s,d];var m=d.find(function(v){var T="limit"in v.req?v.req.limit:1/0;return T>=o.limit&&(o.values?v.req.values:!0)&&Vh(v.req.query.range,o.query.range)});return[m,!1,s,d];case"count":var b=d.find(function(v){return sc(v.req.query.range,o.query.range)});return[b,!!b,s,d]}}function Gh(e,t,i,o){e.subscribers.add(i),o.addEventListener("abort",function(){e.subscribers.delete(i),e.subscribers.size===0&&zh(e,t)})}function zh(e,t){setTimeout(function(){e.subscribers.size===0&&Bt(t,e)},3e3)}var Yh={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,i=ee(ee({},e),{transaction:function(o,s,c){var l=e.transaction(o,s,c);if(s==="readwrite"){var d=new AbortController,h=d.signal,m=function(b){return function(){if(d.abort(),s==="readwrite"){for(var v=new Set,T=0,R=o;T<R.length;T++){var _=R[T],E=Ht["idb://".concat(t,"/").concat(_)];if(E){var w=e.table(_),I=E.optimisticOps.filter(function(W){return W.trans===l});if(l._explicit&&b&&l.mutatedParts)for(var x=0,C=Object.values(E.queries.query);x<C.length;x++)for(var A=C[x],k=0,F=A.slice();k<F.length;k++){var H=F[k];Ao(H.obsSet,l.mutatedParts)&&(Bt(A,H),H.subscribers.forEach(function(W){return v.add(W)}))}else if(I.length>0){E.optimisticOps=E.optimisticOps.filter(function(W){return W.trans!==l});for(var O=0,j=Object.values(E.queries.query);O<j.length;O++)for(var A=j[O],L=0,M=A.slice();L<M.length;L++){var H=M[L];if(H.res!=null&&l.mutatedParts)if(b&&!H.dirty){var D=Object.isFrozen(H.res),K=ac(H.res,H.req,I,w,H,D);H.dirty?(Bt(A,H),H.subscribers.forEach(function(G){return v.add(G)})):K!==H.res&&(H.res=K,H.promise=z.resolve({result:K}))}else H.dirty&&Bt(A,H),H.subscribers.forEach(function(G){return v.add(G)})}}}}v.forEach(function(W){return W()})}}};l.addEventListener("abort",m(!1),{signal:h}),l.addEventListener("error",m(!1),{signal:h}),l.addEventListener("complete",m(!0),{signal:h})}return l},table:function(o){var s=e.table(o),c=s.schema.primaryKey,l=ee(ee({},s),{mutate:function(d){var h=X.trans;if(c.outbound||h.db._options.cache==="disabled"||h.explicit)return s.mutate(d);var m=Ht["idb://".concat(t,"/").concat(o)];if(!m)return s.mutate(d);var b=s.mutate(d);return(d.type==="add"||d.type==="put")&&(d.values.length>=50||Oo(c,d).some(function(v){return v==null}))?b.then(function(v){var T=ee(ee({},d),{values:d.values.map(function(_,E){var w,I=!((w=c.keyPath)===null||w===void 0)&&w.includes(".")?Vt(_):ee({},_);return ze(I,c.keyPath,v.results[E]),I})}),R=oc(m,T,v);m.optimisticOps.push(R),queueMicrotask(function(){return d.mutatedParts&&Sr(d.mutatedParts)})}):(m.optimisticOps.push(d),d.mutatedParts&&Sr(d.mutatedParts),b.then(function(v){if(v.numFailures>0){Bt(m.optimisticOps,d);var T=oc(m,d,v);T&&m.optimisticOps.push(T),d.mutatedParts&&Sr(d.mutatedParts)}}),b.catch(function(){Bt(m.optimisticOps,d),d.mutatedParts&&Sr(d.mutatedParts)})),b},query:function(d){var h;if(!Fc(X,s)||!Mc("query",d))return s.query(d);var m=((h=X.trans)===null||h===void 0?void 0:h.db._options.cache)==="immutable",b=X,v=b.requery,T=b.signal,R=Wh(t,o,"query",d),_=R[0],E=R[1],w=R[2],I=R[3];if(_&&E)_.obsSet=d.obsSet;else{var x=s.query(d).then(function(C){var A=C.result;if(_&&(_.res=A),m){for(var k=0,F=A.length;k<F;++k)Object.freeze(A[k]);Object.freeze(A)}else C.result=Vt(A);return C}).catch(function(C){return I&&_&&Bt(I,_),Promise.reject(C)});_={obsSet:d.obsSet,promise:x,subscribers:new Set,type:"query",req:d,dirty:!1},I?I.push(_):(I=[_],w||(w=Ht["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),w.queries.query[d.query.index.name||""]=I)}return Gh(_,I,v,T),_.promise.then(function(C){return{result:ac(C.result,d,w?.optimisticOps,s,_,m)}})}});return l}});return i}};function Ir(e,t){return new Proxy(e,{get:function(i,o,s){return o==="db"?t:Reflect.get(i,o,s)}})}var At=function(){function e(t,i){var o=this;this._middlewares={},this.verno=0;var s=e.dependencies;this._options=i=ee({addons:e.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange};var c=i.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:fe,dbReadyPromise:null,cancelOpen:fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};l.dbReadyPromise=new z(function(h){l.dbReadyResolve=h}),l.openCanceller=new z(function(h,m){l.cancelOpen=m}),this._state=l,this.name=t,this.on=Gn(this,"populate","blocked","versionchange","close",{ready:[vo,fe]}),this.on.ready.subscribe=lc(this.on.ready.subscribe,function(h){return function(m,b){e.vip(function(){var v=o._state;if(v.openComplete)v.dbOpenError||z.resolve().then(m),b&&h(m);else if(v.onReadyBeingFired)v.onReadyBeingFired.push(m),b&&h(m);else{h(m);var T=o;b||h(function R(){T.on.ready.unsubscribe(m),T.on.ready.unsubscribe(R)})}})}}),this.Collection=th(this),this.Table=qp(this),this.Transaction=uh(this),this.Version=xh(this),this.WhereClause=sh(this),this.on("versionchange",function(h){h.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=Hn(i.IDBKeyRange),this._createTransaction=function(h,m,b,v){return new o.Transaction(h,m,b,o._options.chromeTransactionDurability,v)},this._fireOnBlocked=function(h){o.on("blocked").fire(h),un.filter(function(m){return m.name===o.name&&m!==o&&!m._state.vcFired}).map(function(m){return m.on("versionchange").fire(h)})},this.use(Lh),this.use(Yh),this.use(Bh),this.use(Fh),this.use(Mh);var d=new Proxy(this,{get:function(h,m,b){if(m==="_vip")return!0;if(m==="table")return function(T){return Ir(o.table(T),d)};var v=Reflect.get(h,m,b);return v instanceof Tc?Ir(v,d):m==="tables"?v.map(function(T){return Ir(T,d)}):m==="_createTransaction"?function(){var T=v.apply(this,arguments);return Ir(T,d)}:v}});this.vip=d,c.forEach(function(h){return h(o)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new q.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var i=this._versions,o=i.filter(function(s){return s._cfg.version===t})[0];return o||(o=new this.Version(t),i.push(o),i.sort(gh),o.stores({}),this._state.autoSchema=!1,o)},e.prototype._whenReady=function(t){var i=this;return this.idbdb&&(this._state.openComplete||X.letThrough||this._vip)?t():new z(function(o,s){if(i._state.openComplete)return s(new q.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen){s(new q.DatabaseClosed);return}i.open().catch(fe)}i._state.dbReadyPromise.then(o,s)}).then(t)},e.prototype.use=function(t){var i=t.stack,o=t.create,s=t.level,c=t.name;c&&this.unuse({stack:i,name:c});var l=this._middlewares[i]||(this._middlewares[i]=[]);return l.push({stack:i,create:o,level:s??10,name:c}),l.sort(function(d,h){return d.level-h.level}),this},e.prototype.unuse=function(t){var i=t.stack,o=t.name,s=t.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return s?c.create!==s:o?c.name!==o:!1})),this},e.prototype.open=function(){var t=this;return Gt(Et,function(){return Dh(t)})},e.prototype._close=function(){var t=this._state,i=un.indexOf(this);if(i>=0&&un.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new z(function(o){t.dbReadyResolve=o}),t.openCanceller=new z(function(o,s){t.cancelOpen=s}))},e.prototype.close=function(t){var i=t===void 0?{disableAutoOpen:!0}:t,o=i.disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new q.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new q.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},e.prototype.delete=function(t){var i=this;t===void 0&&(t={disableAutoOpen:!0});var o=arguments.length>0&&typeof arguments[0]!="object",s=this._state;return new z(function(c,l){var d=function(){i.close(t);var h=i._deps.indexedDB.deleteDatabase(i.name);h.onsuccess=me(function(){kh(i._deps,i.name),c()}),h.onerror=at(l),h.onblocked=i._fireOnBlocked};if(o)throw new q.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(d):d()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return xe(this._allTables).map(function(i){return t._allTables[i]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Oh.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,i,o){var s=this,c=X.trans;(!c||c.db!==this||t.indexOf("!")!==-1)&&(c=null);var l=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var d,h;try{if(h=i.map(function(b){var v=b instanceof s.Table?b.name:b;if(typeof v!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return v}),t=="r"||t===Ki)d=Ki;else if(t=="rw"||t==Hi)d=Hi;else throw new q.InvalidArgument("Invalid transaction mode: "+t);if(c){if(c.mode===Ki&&d===Hi)if(l)c=null;else throw new q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c&&h.forEach(function(b){if(c&&c.storeNames.indexOf(b)===-1)if(l)c=null;else throw new q.SubTransaction("Table "+b+" not included in parent transaction.")}),l&&c&&!c.active&&(c=null)}}catch(b){return c?c._promise(null,function(v,T){T(b)}):we(b)}var m=Oc.bind(null,this,d,h,c,o);return c?c._promise(d,m,"lock"):X.trans?Gt(X.transless,function(){return s._whenReady(m)}):this._whenReady(m)},e.prototype.table=function(t){if(!Ke(this._allTables,t))throw new q.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e}(),Jh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Xh=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,i,o){return this._subscribe(!t||typeof t=="function"?{next:t,error:i,complete:o}:t)},e.prototype[Jh]=function(){return this},e}(),Kr;try{Kr={indexedDB:De.indexedDB||De.mozIndexedDB||De.webkitIndexedDB||De.msIndexedDB,IDBKeyRange:De.IDBKeyRange||De.webkitIDBKeyRange}}catch{Kr={indexedDB:null,IDBKeyRange:null}}function qh(e){var t=!1,i,o=new Xh(function(s){var c=mo(e);function l(I){var x=hn();try{c&&gn();var C=xt(e,I);return c&&(C=C.finally(Tt)),C}finally{x&&mn()}}var d=!1,h,m={},b={},v={get closed(){return d},unsubscribe:function(){d||(d=!0,h&&h.abort(),T&&kt.storagemutated.unsubscribe(E))}};s.start&&s.start(v);var T=!1,R=function(){return Ui(w)};function _(){return Ao(b,m)}var E=function(I){zr(m,I),_()&&R()},w=function(){if(!(d||!Kr.indexedDB)){m={};var I={};h&&h.abort(),h=new AbortController;var x={subscr:I,signal:h.signal,requery:R,querier:e,trans:null},C=l(x);Promise.resolve(C).then(function(A){t=!0,i=A,!(d||x.signal.aborted)&&(m={},b=I,!Ip(b)&&!T&&(kt(Yn,E),T=!0),Ui(function(){return!d&&s.next&&s.next(A)}))},function(A){t=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||d||Ui(function(){d||s.error&&s.error(A)})})}};return setTimeout(R,0),v});return o.hasValue=function(){return t},o.getValue=function(){return i},o}var jt=At;fn(jt,ee(ee({},Vr),{delete:function(e){var t=new jt(e,{addons:[]});return t.delete()},exists:function(e){return new jt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Th(jt.dependencies).then(e)}catch{return we(new q.MissingAPI)}},defineClass:function(){function e(t){Ye(this,t)}return e},ignoreTransaction:function(e){return X.trans?Gt(X.transless,e):e()},vip:fo,async:function(e){return function(){try{var t=po(e.apply(this,arguments));return!t||typeof t.then!="function"?z.resolve(t):t}catch(i){return we(i)}}},spawn:function(e,t,i){try{var o=po(e.apply(i,t||[]));return!o||typeof o.then!="function"?z.resolve(o):o}catch(s){return we(s)}},currentTransaction:{get:function(){return X.trans||null}},waitFor:function(e,t){var i=z.resolve(typeof e=="function"?jt.ignoreTransaction(e):e).timeout(t||6e4);return X.trans?X.trans.waitFor(i):i},Promise:z,debug:{get:function(){return st},set:function(e){vc(e)}},derive:dn,extend:Ye,props:fn,override:lc,Events:Gn,on:kt,liveQuery:qh,extendObservabilitySet:zr,getByKeyPath:mt,setByKeyPath:ze,delByKeyPath:wp,shallowClone:dc,deepClone:Vt,getObjectDiff:Do,cmp:oe,asap:fc,minKey:ao,addons:[],connections:un,errnames:yo,dependencies:Kr,cache:Ht,semVer:Xs,version:Xs.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,i){return e+t/Math.pow(10,i*2)})}));jt.maxKey=Hn(jt.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(kt(Yn,function(e){if(!St){var t;t=new CustomEvent(so,{detail:e}),St=!0,dispatchEvent(t),St=!1}}),addEventListener(so,function(e){var t=e.detail;St||Ro(t)}));function Ro(e){var t=St;try{St=!0,kt.storagemutated.fire(e),Po(e,!0)}finally{St=t}}var St=!1,wt,ho=function(){};typeof BroadcastChannel<"u"&&(ho=function(){wt=new BroadcastChannel(so),wt.onmessage=function(e){return e.data&&Ro(e.data)}},ho(),typeof wt.unref=="function"&&wt.unref(),kt(Yn,function(e){St||wt.postMessage(e)}));typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!At.disableBfCache&&e.persisted){st&&console.debug("Dexie: handling persisted pagehide"),wt?.close();for(var t=0,i=un;t<i.length;t++){var o=i[t];o.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!At.disableBfCache&&e.persisted&&(st&&console.debug("Dexie: handling persisted pageshow"),ho(),Ro({all:new Ue(-1/0,[[]])}))}));z.rejectionMapper=Pp;vc(st);var Fo=class{getDB(){let t=new At("FireShotDB");return t.version(1).stores({captures:`
              ++id,
              time,
              url,
              title`,tiles:"++id, parentId"}),t}async createNewEntry(){return await this.getDB().captures.add({time:0})}async addTile(t,i){await this.getDB().tiles.add({parentId:t,blob:i})}async commitEntry(t,i,o,s,c){await this.getDB().captures.update(t,{time:i,url:o,title:s,metadata:c})}async cleanup(){N()("DB cleanup...");let i=await this.getDB().captures.where("time").equals(0).primaryKeys();await this.deleteCaptures(i)}async deleteCaptures(t){let i=this.getDB();await i.tiles.where("parentId").anyOf(t).delete(),await i.captures.bulkDelete(t)}async deleteOlderThanGivenDays(t){N()("Performing database cleanup...");let i=this.getDB(),o=new Date;o.setDate(o.getDate()-t);let s=await i.captures.where("time").below(o).primaryKeys();s.length>0?(console.log(`Removing ${s.length} items`),await this.deleteCaptures(s)):N()("Nothing to do.")}async getCapture(t){try{let i=this.getDB();return{...await i.captures.get(t),tiles:(await i.tiles.where("parentId").equals(t).sortBy("id")).map(o=>o.blob)}}catch(i){return console.error(i),null}}async getAllCaptures(){return await this.getDB().captures.toArray()}},Yt=new Fo;var Nc="image/png",Yr=class{#l=0;#g=0;#f=0;#y=0;#v=0;#d=0;#p;#a=0;#h=0;#b=0;#s=-1;#t=0;#n=0;#u=[];#e=null;#i=null;#c=null;#r;#o=null;#m=0;dbError=!1;constructor(){}async init(){try{await Yt.cleanup()}catch(t){console.error(t)}}#E(){this.#e=new OffscreenCanvas(this.#t,y.V),this.#e.aTag=1,this.#i=new OffscreenCanvas(this.#t,y.V),this.#i.aTag=2,this.#c=this.#e.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#c.aTag=1,this.#o=this.#i.getContext("2d",{alpha:!1,willReadFrequently:!1}),this.#o.aTag=2}async#_(t){try{this.#s<0&&(this.#s=await Yt.createNewEntry()),await Yt.addTile(this.#s,t),this.#h+=t.size,++this.#b}catch(i){this.dbError=!0,console.warn(i.message)}}async#w(){Qe("swapActiveContext"),this.#m=0,this.#r+=this.#e.height,await this.#_(await this.#e.convertToBlob({type:Nc})),[this.#e,this.#i]=[this.#i,this.#e],[this.#c,this.#o]=[this.#o,this.#c],Ze("swapActiveContext")}async#I(t){let i=t.x,o=t.y,s=this.#d===t.y||this.#a===0,c=t.metrics.div,l=t.metrics.left,d=t.metrics.top,h=t.metrics.crop,m=t.metrics.cropLeft||0,b=t.metrics.cropTop||0,v=t.metrics.cropRight||0,T=t.metrics.cropBottom||0,R=t.metrics.stickyHdrHeight,{w:_,h:E}=c?{w:t.metrics.cw,h:t.metrics.ch}:yr(t.dataurl);this.#a===0&&(this.#v=t.x,this.#d=t.y),this.#a=this.#a+1,this.#y=Math.min(this.#y,t.y),this.#g=Math.max(this.#g,t.y),this.#t===0&&(this.#t=this.#l+_-this.#f-(h?m:0),h&&(this.#t=Math.min(this.#t,v-m)),this.#E(),this.#r=0);let w=s?0:R,I=i-this.#v-m,x=o-this.#d-b+w,C=c?E-w:E-w-d,A=x+C;this.#n=Math.max(this.#n,A),h&&(this.#n=Math.min(this.#n,Math.floor(T-b))),Qe("fetch dataurl");let k=await fetch(t.dataurl);if(!k.ok)throw new Error("failed to preload image chunk");Ze("fetch dataurl"),Qe("createImageBitmap");let F=await createImageBitmap(await k.blob());Ze("createImageBitmap"),x-this.#r>=this.#e.height&&await this.#w(),Qe("drawImage"),this.#c.drawImage(F,l,d+w,_,E,I,x-this.#r,_,E),Ze("drawImage"),this.#n-this.#r>=this.#e.height&&(Qe("drawImage - 2"),this.#m=this.#n-this.#r-this.#e.height,this.#o.drawImage(F,l,d+w,_,E,I,x-this.#r-this.#e.height,_,E),Ze("drawImage - 2"))}async#x(t){Qe("commitDBRecord");let i=Z(y.a,2)-1;try{let o={calculatedHeight:Math.floor(this.#n),calculatedWidth:this.#t,blobsSize:this.#h,totalTiles:this.#b,pageUrl:t.url,...t.savedCapParamsForDebugging};await Yt.commitEntry(this.#s,new Date(t.created),t.url,t.title,{n:i,size:this.#h,width:this.#t,height:Math.floor(this.#n),cbb:t.canBeBetter,debug:o,links:t.links,words:t.words})}catch(o){this.dbError=!0,console.warn(o.message)}Ze("commitDBRecord")}async#S(){this.#t===0&&this.#u.forEach(t=>{this.#f=Math.min(this.#f,t.x),this.#l=Math.max(this.#l,t.x)});for(let t of this.#u)await this.#I(t);this.#u.length=0}async processTile(t){this.#u.push(t),typeof this.#p>"u"&&(this.#p=t.y),this.#p!==t.y&&await this.#S()}async finalize(t){return Qe("Finalize"),this.#a===0&&await this.#S(),this.#m>0&&await this.#w(),this.#i.height=this.#n-this.#r,this.#o.drawImage(this.#e,0,0,this.#t,this.#n-this.#r,0,0,this.#t,this.#n-this.#r),await this.#_(await this.#i.convertToBlob({type:Nc})),this.#e.width=1,this.#e.height=1,this.#i.width=1,this.#i.height=1,await this.#x(t),N()("tiles created"),Ze("Finalize"),this.#s}};function Qh(){let e=null,t=null,i=null;function o(d){Q(y.Q,d.name),Q(y._,d.key),Q(y.g,!0),Q(y.t,!0)}async function s(){t=new Yr,await t.init(),i=null}async function c(d){i?i=i.then(()=>t.processTile(d)):i=t.processTile(d)}async function l(d){try{if(d.rows===0)return;await i;let h=await t.finalize(d);if(t.dbError){Lc(!0);return}t=null,i=null,ue&&Qe("captureDone");let m=[y.u,y.f].indexOf(d.action)!==-1,b;if(m){let T=btoa(JSON.stringify({action:d.action,folder:d.overrideFolder||"",context:d.contextId}));b={url:`fsCaptured.html?id=${h}&params=${T}`,active:!0}}else b={url:`fsCaptured.html?id=${h}`,windowId:d.tab.windowId,index:d.tab.incognito&&!qe()?void 0:d.tab.index+1,openerTabId:d.tab.incognito?void 0:d.tab.id},Z(y.me)!=="true"&&(delete b.index,qe()&&delete b.openerTabId);let v=T=>new Promise(R=>{chrome.tabs.create(T,_=>{chrome.runtime.lastError?(delete T.index,delete T.openerTabId,chrome.tabs.create(T,R)):R(_)})});d.justStore||await v(b),ue&&Ze("captureDone")}finally{e({topic:"processingFinished"})}}return{init:function(d){e=d},launchJSON:function(d){switch(d.JSONCommand){case"captureInit":return s();case"captureTabPNG":c(d);break;case"captureDone":return l(d);case"activateFireShot":o(d);break}}}}var ye=new Qh;function Jr(){return Le()?tt:ye}function te(e,t,i){if(typeof tt>"u"){console.error("This method should be called only from the Service worker.");return}let o;typeof e=="object"?(o=e,e=t,t=i):o=Jr();try{let s=t||{},c=e;if(s.JSONCommand=c,ue)if(s.dataurl){let l=s.dataurl;s.dataurl="<cut>",N()("plugin command: "+c+" : "+JSON.stringify(s)),s.dataurl=l}else N()("plugin command: "+c+" : "+JSON.stringify(s).substring(0,2e3));return o.launchJSON(s)}catch(s){return Lt(s.message),!1}}function Bc(){te("openSettings")}function Lc(e){chrome.tabs.create({url:`fsHistory.html${e?"?cleanup=1":""}`})}function jc(){te("resumeEditing")}function $c(){te("ieCaptureOptions")}function Mo(){te("upgradeToPro")}function Uc(){tn("UA-1025658-9","fireshot.com","DoTrial"),te("upgradeToProTrial")}function Kc(){te("enterLicense")}function Hc(){te("openFile")}function Vc(){te("openFromClipboard")}function Wc(){te("showLicensingInfo")}function Gc(){te("showAboutWindow")}function zc(){bt()?(qe()?chrome.windows:chrome.tabs).create({url:"fsNativeInstall.html"}):Zh()}function Zh(){Q(y.t,"true"),ue||em()}function em(){window.open("https://getfireshot.com/beta-pro.php?browser="+ot())}var Yc=function(e){var i,o,s,c=!1,l={timeout:10,delay:0};function d(w){return new Promise(I=>{chrome.tabs.create(w,I)})}function h(w,I){try{w&&w.postMessage(I)}catch{}}function m(w,I){return new Promise((x,C)=>{chrome.tabs.update(w,{},A=>{chrome.runtime.lastError?C({message:chrome.runtime.lastError.message,abort:!0}):A?chrome.scripting.executeScript(I).then(x).catch(k=>C({message:k,abort:!1})):C({message:"Error: the tab does not exist",abort:!0})})})}function b(w){return new Promise(I=>{$e()?chrome.tabs.update(w.id,{active:!0,highlighted:!0},I):chrome.tabs.highlight({windowId:w.windowId,tabs:w.index},I)})}async function v(w,I){let x;try{let C=await Promise.race([new Promise(A=>{x=setInterval(()=>{he().contains(y.i)?chrome.tabs.update(w,{},k=>{(chrome.runtime.lastError||!k)&&(N()("Closed main tab detected"),A("error_closed"))}):(N()("Abort detected"),A("error_aborted"))},200)}),I]);return clearInterval(x),C}catch(C){return console.error(C.message),clearInterval(x),"error_aborted"}}function T(w,I){return v(w,new Promise(x=>{let C=!1;chrome.tabs.update(w,{url:I},A=>{A||x(!1);let k=(H,O)=>{if(w===H)switch(O.status){case"complete":N()(`${I} loaded.`),clearTimeout(F),chrome.tabs.onUpdated.removeListener(k),x(!0);break;case"loading":C=!0;break}};var F=setTimeout(()=>{N()(`${I} timed out.`),chrome.tabs.onUpdated.removeListener(k),x(C)},l.timeout*1e3);chrome.tabs.onUpdated.addListener(k)})}))}function R(w,I,x,C,A,k){return new Promise(F=>{e.executeGrabber(I,x,{JSPlugin:!0,overrideSpeed:C,overrideFolder:A,tabId:w,contextId:k},()=>{F()},!0)})}function _(w,I,x){return new Promise((C,A)=>{if(!x){C();return}I&&(h(I,{topic:"delay-info",secsLeft:x}),h(I,{topic:"set-visible",visible:!0}));let k=setInterval(()=>{--x,m(w,{args:[x],target:{tabId:w},injectImmediately:!0,func:F=>{window.fsTitle||(window.fsTitle=document.title),document.title=(F>0?"["+F+"] ":"")+window.fsTitle}}).then(()=>{x<=0||o||s?(clearInterval(k),h(I,{topic:"set-visible",visible:!1}),setTimeout(C,$e()?100:0)):h(I,{topic:"delay-info",secsLeft:x})}).catch(F=>{clearInterval(k),A(F)})},1e3)})}function E(w){return new Promise((I,x)=>{chrome.scripting.insertCSS({target:{tabId:w},files:["css/fsautomationbanner.css"]}).catch(C=>x({message:C,abort:!1})),m(w,{target:{tabId:w},injectImmediately:!0,files:["scripts/page/fsAutomationBanner.js"]}).then(()=>{let C=chrome.tabs.connect(w,{name:"fsAutomationPort"});C.onMessage.addListener(k=>{switch(N()(k),k.topic){case"abort":o=!0,c&&e.stopCapturing(!0);break;case"next":s=!0,c&&e.stopCapturing();break}});let A={};for(let k=1;k<=6;++k){let F=`automation_banner_locale_string_${k}`;A[F]=chrome.i18n.getMessage(F)}h(C,{topic:"set-locale-strings",localeStrings:A}),I(C)}).catch(C=>x(C))})}return{grabPages:async function(w,I,x,C){ue&&Qe("automation"),C&&(l=C),i=await d({url:"about:blank"});for(let A=0;A<w.length&&!o&&he().contains(y.i);++A){let k=w[A],F,H=await T(i.id,k);if(H==="error_closed"||H==="error_aborted")break;if(!H)continue;await b(i),s=!1,c=!1;try{F=await E(i.id),await _(i.id,F,l.delay)}catch(O){if(console.log("ERROR: "+O.message),F=null,O.abort){o=!0;break}}!o&&!s&&(h(F,{topic:"set-progress",progress:A+1,total:w.length}),c=!0,await R(i.id,I,x,C.speed,C.subfolder,C.callbackContextId)),F&&F.disconnect()}return chrome.tabs.remove(i.id,()=>{chrome.runtime.lastError}),ue&&Ze("automation"),N()("grabPages completed."),!o}}};var No=class{getDB(){let t=new At("FireShotDebug");return t.version(1).stores({replay:`
              ++id`}),t}async clear(){await this.getDB().replay.clear()}async saveCommand(t,i){await this.getDB().replay.add({command:t,data:i})}async getReplay(){return await this.getDB().replay.filter(()=>!0).toArray()}},yn=new No;function Lo(){let e=null,t=null,i=null,o,s,c,l=new Map,d=null,h=0,m=null,b,v,T,R;function _(O){return new Promise(j=>{let L,M=0,D=500;if(O){j();return}let K=()=>{chrome.runtime.onMessage.removeListener(L),W&&(clearTimeout(W),W=null,j())};chrome.runtime.onMessage.addListener(L=($,G)=>{switch($.message){case"frameInfo":{if(!M)return;$.data.frameId=G.frameId,N()(G.frameId+"  ",$.data),l.set(G.frameId,$.data),l.size>=M&&(M=0,K());break}}});let W=setTimeout(()=>{N()("frame collector timeout"),K()},D);chrome.scripting.executeScript({target:{allFrames:!0,tabId:e.id},injectImmediately:!0,files:["scripts/page/fsFrames.js"]}).then($=>({length:M=0}=$||0,chrome.scripting.executeScript({target:{tabId:e.id},injectImmediately:!0,func:()=>window.postMessage({message:"rInfo",exts:{x:0,y:0,clientLeft:0,clientTop:0},fullyVisible:!0,level:0},"*")}).catch(G=>{throw G}))).catch($=>{N()(`chrome.scripting error: ${$}`),K()})})}function E(){Q(y.a,parseInt(Z(y.a,1))+1)}function w(O,j,L){let M=setTimeout(()=>{M&&(M=void 0,L(!1))},j);chrome.scripting.executeScript({target:{tabId:O},injectImmediately:!1,func:()=>{}}).then(()=>{M&&(clearTimeout(M),M=void 0,L(!0))}).catch(D=>{N()(D),M&&(clearTimeout(M),M=void 0,L(!0))})}async function I(O,j){let L=this?["scripts/page/fsContent.js"]:["scripts/page/fsPageUtils.js","scripts/page/fsSelection.js","scripts/page/fsLinks.js","scripts/page/fsContent.js"];return chrome.scripting.executeScript({target:{tabId:O,frameIds:[j]},injectImmediately:!0,files:L})}function x(O,j,L,M,D,K){o=!1,s=!1,e=D,i=K;let W=j!==y.e&&j!==y.m||K!==0||$e()&&/Version\/14/.test(navigator.appVersion);_(W).then(()=>{m=function($){$?A(O,L,M):k(O,j,L,M)},N()("capturePage: checking capabilities at "+D.url+". Tab state is: "+D.status),j!=y.P&&(D.url?.startsWith("chrome://")||D.url?.startsWith("chrome-extension://"))?(N()("Chrome url detected. Calling default cap method."),A(O,L,M)):j==y.P&&D.url!==void 0&&D.title!==void 0?setTimeout(function(){N()("Calling captureBrowser directly..."),E(),te("updateFilenameTemplateSettings",Rn()),te("captureBrowser",{action:O+":-",url:D.url,title:D.title}),M&&M()},100):I(D.id,K).then(()=>setTimeout(m,200)).catch($=>{console.log($),N()("Calling default capturing on exception"),m(!0)})})}function C(O,j,L){return new Promise((M,D)=>{let K=W=>chrome.tabs.captureVisibleTab(O,j,$=>{!chrome.runtime.lastError&&$?M($):W<L.MAX_CAP_TRIALS?(N()("Capture visible tab retry "+W),setTimeout(()=>{K(++W)},L.CAP_DELAY)):(N()("Maximum attempts to call captureVisibleTab reached."),D())});K(0)})}function A(O,j,L){C(void 0,{format:"png"},{MAX_CAP_TRIALS:5,CAP_DELAY:510}).then(async M=>{let D=j.JSPlugin?ye:Jr(),K=yr(M);await te(D,"captureInit"),D!==ye&&await te(ye,"captureInit"),te(D,"captureTabPNG",{dataurl:M,datasize:M.length,x:0,y:0,metrics:{left:0,top:0,crop:!1,stickyHdrHeight:0}}),D!==ye&&te(ye,"captureTabPNG",{dataurl:M,datasize:M.length,x:0,y:0,metrics:{left:0,top:0,crop:!1,stickyHdrHeight:0}});let W=e.url||"not available",$=e.title?e.title.replace(/[\u200B-\u200F\u202A-\u202E\u2060\u2066-\u2069]/g,"").replace(/\u00A0/g," "):"not available",G={action:O,url:W,title:$,left:0,top:0,cw:K.w,ch:K.h};if(qe()&&(!e.url||e.url.startsWith("about:"))&&e.width>0&&K.w/e.width*e.height<K.h){let ve=K.w/e.width;G.crop=!0,G.cropLeft=0,G.cropTop=0,G.cropRight=K.w,G.cropBottom=e.height*ve}let se=navigator.userAgent.match(/(Firefox|Chrom(e|ium)|Safari)\/([0-9]+)\./);G.browserVersion=parseInt(se&&se.length>=4?se[3]:"0.0"),G.usrData=j.usrData,G.overrideFolder=j.overrideFolder,G.contextId=j.contextId,G.links={},G.words={},G.created=new Date,G.tab={},{windowId:G.tab.windowId,incognito:G.tab.incognito,index:G.tab.index,id:G.tab.id}=e,G.savedCapParamsForDebugging={version:je().extVersionFull,pro:We(),action:G.action,left:G.left,top:G.top,rows:1,cols:1,cw:G.cw,ch:G.ch,ratioW:1,ratioH:1},E(),await te("updateFilenameTemplateSettings",Rn()),await te(D,"captureDone",G),D!==ye&&await te(ye,"captureDone",{...G,justStore:!0})}).catch(M=>{M&&console.log(M.message)}).finally(()=>{L&&L(!0)})}function k(O,j,L,M){let D=W=>{M&&M(W),M=null};function K(W,$,G){let se=-1,ve=-1;C(e.windowId,{format:"jpeg"},{MAX_CAP_TRIALS:20,CAP_DELAY:50}).then(be=>{try{let de=js(be);se=de[0],ve=de[1],N()("Emulation extents: "+de[0]+" x "+de[1])}catch(de){N()(de.toString())}}).catch(()=>{}).finally(()=>{b={rw:Ni(se/W),rh:Ni(ve/$)},G()})}N()("doCapturing");try{let W=chrome.tabs.connect(e.id,{frameId:i}),$=()=>{D(!1)},G=L.JSPlugin?ye:Jr();v=()=>{t=void 0,W.onMessage.removeListener(re),W.onDisconnect.removeListener($);try{W.disconnect()}catch{}D(!1)};let se=()=>{let ae=[...l].filter(Oe=>Oe[0]>0&&Oe[1].clientWidth>=100&&Oe[1].clientHeight>=100&&Oe[1].scrollable&&Oe[1].fullyVisible).map(Oe=>Oe[1]),V=1,Be=1;if(i>0){let Oe=l.get(i);V=Oe.scales[0],Be=Oe.scales[1]}let He={..._e.storage};L.overrideSpeed&&(He[y.he]=L.overrideSpeed),W.postMessage({topic:"init",mode:j,debug:ue,options:JSON.stringify(He),adv:We(),frames:ae,ratioW:b.rw*V,ratioH:b.rh*Be})},ve,be,de=null,Ee=parseInt(Z(y.edtLimitScrollingTime,1200))||1200;de=new Date,y.T&&yn.clear();let re=async U=>{switch(N()($e()?JSON.stringify(U).substring(0,2e3):JSON.stringify(U)),U.topic){case"ping":W.postMessage({topic:"pong"});break;case"preStep1Done":K(U.windowW,U.windowH,()=>{W.postMessage({topic:"preStep2"})});break;case"preStep2Done":se();break;case"initAborted":N()("init Aborted"),D();break;case"initDone":switch(ve=U.url,be=U.title,j){case y.o:case y.e:y.T&&yn.saveCommand("captureInit",{}),await te(G,"captureInit"),G!==ye&&await te(ye,"captureInit"),W.postMessage({topic:"scrollNext"});break;case y.m:y.T&&yn.saveCommand("captureInit",{}),await te(G,"captureInit"),G!==ye&&await te(ye,"captureInit"),t=()=>{W.postMessage({topic:"cancelSelection"})},W.postMessage({topic:"selectArea"});break;case y.P:E(),te("updateFilenameTemplateSettings",Rn()),te("captureBrowser",{action:O+":-",url:ve,title:be}),W.onMessage.removeListener(re),W.onDisconnect.removeListener($),W.disconnect(),D(!0);break}break;case"areaSelected":t=void 0,W.postMessage({topic:"scrollNext"});break;case"areaSelectionCanceled":v();break;case"switchToFrame":{W.onMessage.removeListener(re),W.onDisconnect.removeListener($),T=U.restorePosition,R=U.capturePosition;let ae=new Map;ae.set(U.id,l.get(U.id)),l=ae,L.overrideTitle=be,W.disconnect(),x(O,y.e,L,M,e,U.id)}break;case"scrollDone":Q(y.j,U.progress),chrome.runtime.sendMessage({message:"setProgressValue",progress:U.progress}).catch(()=>{}),C(e.windowId,{format:"png"},{MAX_CAP_TRIALS:40,CAP_DELAY:50}).then(ae=>{let V=U.metrics;if(i>0){let He=l.get(i);V.left=Math.round((R.left+He.clientLeft)*b.rw),V.top=Math.round((R.top+He.clientTop)*b.rh),V.cw=He.clientWidth*b.rw*He.scales[0],V.ch=He.clientHeight*b.rh*He.scales[1],V.div=1}y.T&&yn.saveCommand("captureTabPNG",{dataurl:ae,datasize:ae.length,x:U.x,y:U.y,metrics:U.metrics}),te(G,"captureTabPNG",{dataurl:ae,datasize:ae.length,x:U.x,y:U.y,metrics:U.metrics}),G!==ye&&te(ye,"captureTabPNG",{dataurl:ae,datasize:ae.length,x:U.x,y:U.y,metrics:U.metrics});let Be=new Date-de>Ee*1e3;W.postMessage({topic:"scrollNext",cancel:o||Be})}).catch(()=>W.postMessage({topic:"scrollNext",cancel:!0})).catch(()=>v);break;case"scrollFinished":N()("FINISHED ("+U.rows+" x "+U.cols+")"),Q(y.j,100),chrome.runtime.sendMessage({message:"setProgressValue",progress:100}).catch(()=>{}),(U.rows>10||G!==ye)&&setTimeout(()=>chrome.runtime.sendMessage({message:"setProcessingStatus"}).catch(()=>{}),100),setTimeout(async()=>{if(W.onMessage.removeListener(re),W.onDisconnect.removeListener($),W.disconnect(),i>0){let V=l.get(i);U.left=Math.round((R.left+V.clientLeft)*b.rw),U.top=Math.round((R.top+V.clientTop)*b.rh),U.cw=V.clientWidth*b.rw*V.scales[0],U.ch=V.clientHeight*b.rh*V.scales[1],U.div=1}U.savedCapParamsForDebugging={version:je().extVersionFull,pro:We(),action:O,div:U.div,left:U.left,top:U.top,rows:U.rows,cols:U.cols,cw:U.cw,ch:U.ch,ratioW:b.rw,ratioH:b.rh,cropLeft:U.cropLeft,cropRight:U.cropRight,cropTop:U.cropTop,cropBottom:U.cropBottom},U.url=ve,U.title=L.overrideTitle||be,U.key="-",U.action=O;let ae=navigator.userAgent.match(/(Firefox|Chrom(e|ium)|Safari)\/([0-9]+)\./);if(U.browserVersion=parseInt(ae&&ae.length>=4?ae[3]:"0.0"),U.usrData=L.usrData,U.overrideFolder=L.overrideFolder,U.contextId=G===ye?L.contextId:0,U.created=new Date,U.tab={},{windowId:U.tab.windowId,incognito:U.tab.incognito,index:U.tab.index,id:U.tab.id}=e,!s){y.T&&yn.saveCommand("captureDone",U),E(),await te("updateFilenameTemplateSettings",Rn());try{await te(G,"captureDone",U),G!==ye&&await te(ye,"captureDone",{...U,justStore:!0})}catch(V){console.error(V)}}i>0&&T&&(chrome.scripting.executeScript({args:[T.left,T.top],target:{tabId:e.id,frameIds:[0]},injectImmediately:!0,func:(V,Be)=>document.scrollingElement.scrollTo(V,Be)}),T=void 0),D(!0)},j===y.e?200:0);break;case"setOption":Q(U.optionName,U.optionValue);break}};W.onMessage.addListener(re),W.onDisconnect.addListener($),Q(y.j,0),i===0?W.postMessage({topic:"preStep1",debug:ue}):se()}catch(W){console.error(W),D()}}function F(O){o=!1,s=!1,N()("capturetabs");function j($,G){return{next:function(se){G(se)||$(this)}}}function L($,G){$e()?chrome.tabs.update($.id,{active:!0,highlighted:!0},G):chrome.tabs.highlight({windowId:$.windowId,tabs:$.index},G)}function M($){return new Promise(function(G){var se=0;let ve=Number(new Date),be=!We()||Z(y.de)==="true"?y.o:y.e,de=$e()||Z(y.ye)==="true",Ee;de&&(d=(re,U)=>{re===ve&&(Ee||(Ee=U,On(U)))}),chrome.tabs.query({currentWindow:!0},re=>{if(!re||re.length===0){G(se);return}for(let V=0;V<re.length&&!W;++V)re[V].active&&(W=re[V]);var U=0,ae=new j(V=>{try{L(re[U],()=>{w(re[U].id,5e3,Be=>{Be?x($,be,{contextId:ve},He=>{He&&++se,V.next()},re[U++],0):(U++,V.next())})})}catch(Be){Lt(Be.message),G(se)}},()=>U>=re.length||o||!he().contains(y.E)?(de&&Ee&&setTimeout(()=>On(Ee),1e3),G(se),!0):!1);ae.next()})})}let D=new ji;D.start();var K=O===y.p||!Le()?O:y.K,W;O===y.p&&(te("startMultiPagePDF"),c=!0),h=0,he().add(y.E),he(),M(K).then($=>{he().remove(y.E),D.stop(),O===y.p?(te("endMultiPagePDF"),c=void 0):te("doGroupAction",{action:O,count:$})})}let H={doTest:O=>{let j={id:O},L=0;m=M=>{M=M||!1,console.log("Called pendingCapFunction with result: "+M)},I(j.id,L).then(()=>setTimeout(m,200)).catch(M=>{console.log(M),N()("Calling default capturing on exception"),m(!0)})},onFileSavedEvent:(O,j)=>{d&&d(O,j)},stopCapturing:O=>{o=!0,s=O,N()("Capturing canceled");let j=he();h++===0?t&&(Fn(),t()):j.contains(y.c)?setTimeout(v,1500):(j.contains(y.i)||j.contains(y.E))&&j.reset()},executeGrabber:(O,j,L,M)=>{if(h=0,L=L||{},j===y.I)F(O);else{c&&(te("cancelMultiPagePDF"),c=void 0);let D=K=>{he().remove(y.c),M&&M(K)};he().add(y.c),L.tabId?chrome.tabs.get(L.tabId,K=>K?x(O,j,L,D,K,0):D(!1)):chrome.tabs.query({currentWindow:!0,active:!0},K=>{K.length>0?x(O,j,L,D,K[0],0):(Fn(),D(!1))})}},captureList:async O=>{O={...O};let j=O.prefBatchURLs.split(`
`).filter(D=>D.trim().length>0).map(D=>(D=D.trim(),/^(http|https|ftp|ftps):\/\/.*/.test(D)?D:"https://"+D)),L="";if(O.prefBatchCreateFolder){let D=new Date;L=`FireShot batch job (${D.getFullYear()}-${nn(D.getMonth()+1,0,2)}-${nn(D.getDate(),0,2)} ${nn(D.getHours(),0,2)}-${nn(D.getMinutes(),0,2)}-${nn(D.getSeconds(),0,2)})`}he().add(y.i);let M=new ji;M.start();try{let D,K=Number(new Date);O.prefBatchOpenFolder&&(d=(W,$)=>{W===K&&(D||(D=$,On($)))}),await new Yc(H).grabPages(j,O.prefBatchFormat==="pdf"?y.f:y.u,O.prefBatchMode==="entire"?y.e:y.o,{timeout:parseInt(O.prefBatchTimeout),delay:parseInt(O.prefBatchDelay),speed:parseInt(O.prefBatchScrollSpeed),subfolder:L,callbackContextId:K}),O.prefBatchOpenFolder&&D&&setTimeout(()=>On(D),1e3)}catch(D){console.error(D)}M.stop(),he().remove(y.i)}};return H}var Xr="utmrAlarmUpdated";function Jc(){let e=new Date,t=Math.round(e.getTime()/(1e3*60*60*24)),i=y._e+t;fetch(i).then(o=>{if(o.status==200)Q(y.b,e.getTime()+Math.round(Math.random()*y.Se)),N()("Update info available in "+(parseInt(Z(y.b))-e.getTime())/1e3+" seconds"),Xc();else throw"fail"}).catch(()=>{console.log(`Failed to check update, resuming in ${y.B/1e3} seconds`),setTimeout(Jc,y.B),Q(y.F,Date.now()+y.B)}),N()("Checking "+i)}function Xc(){let e=parseInt(Z(y.b,"0")),t=e-Date.now();e&&t<=0?(chrome.alarms.clear(Xr),qc()):(chrome.alarms.clear(Xr),chrome.alarms.create(Xr,{when:e}))}function Jn(){N()("checkAdvancedUpdates");let e=parseInt(Z(y.F,"0")),t=parseInt(Z(y.b,"0")),i=new Date().getTime();t?(N()("scheduling update badge"),Xc()):e?i>=e?(N()("almost time to check updates"),setTimeout(Jc,Math.random()*y.Ee)):(N()(`not a time to check for updates, have to wait for ${(e-i+1e3)/1e3} seconds`),setTimeout(Jn,e-i+1e3)):(N()(`first run, scheduling check in ${y.L/1e3} seconds`),Q(y.F,i+y.L),setTimeout(Jn,y.L+1e3))}function qc(){parseInt(Z(y.b,"0"))&&(Q(y.F,""),Q(y.b,""),N()("Update!"),(!(We()&&Mi())||ue)&&rn(`https://getfireshot.com/updated.php?app=${ot()}&src=ext&ver=${Z(y.v)}&win=${bt()?1:0}`),Jn())}function tm(e){_e.ensureLoaded().then(()=>{switch(e.name){case Xr:qc();break}})}chrome.alarms.onAlarm.addListener(tm);async function Qc(e){let t=-1;async function i(){async function m(b,v){function T(C,A){return new Promise(k=>{fetch(A.data).then(F=>F.blob()).then(F=>{F.name=decodeURIComponent(A.name),C.push(F),k()})})}let R=await chrome.runtime.sendMessage({type:"getAttachments",email:b.User.getEmailAddress()}),_=JSON.parse(R),E=[],w=[],I=[];v.setToRecipients(decodeURIComponent(_.to).split(",")),v.setSubject(decodeURIComponent(_.subject));for(var x=0;x<_.files.length;++x)E.push(T(_.files[x].inline==="yes"?w:I,_.files[x]));await Promise.all(E).then(()=>{w.length>0&&v.attachInlineFiles(w),I.length>0&&(setTimeout(function(){v.attachFiles(I)},1e3),v.getBodyElement().focus())})}InboxSDK.load(2,"sdk_FireShot_c30c6a0127").then(b=>{let v=b.Compose.registerComposeViewHandler(T=>{v(),m(b,T)});b.Compose.openNewComposeView()})}let o=!1;chrome.runtime.onMessage.addListener(function m(b,v,T){v?.tab?.id===t&&(b.type==="inboxsdk__injectPageWorld"&&!o?(o=!0,chrome.scripting.executeScript({target:{tabId:v.tab.id},world:"MAIN",files:["scripts/3p/pageWorld.js"]}),T(!0)):b.type==="getAttachments"&&(chrome.runtime.onMessage.removeListener(m),T(e)))});let s=!1,c=async(m,b,v)=>{!s&&t===m&&b?.status==="complete"&&/^https?:\/\/mail.google.com\/mail.*$/.test(v.url)&&(chrome.tabs.onUpdated.removeListener(c),s=!0,await chrome.scripting.executeScript({target:{tabId:t},files:["scripts/3p/inboxsdk.js"]}),await chrome.scripting.executeScript({target:{tabId:t},func:i}))},l=null,d=async()=>{chrome.tabs.onUpdated.addListener(c),{id:t}=await chrome.tabs.create({url:"https://gmail.com/"})};if(setTimeout(()=>{chrome.tabs.onUpdated.removeListener(c),chrome.tabs.onRemoved.removeListener(l)},5*60*60*1e3),await Us())d();else{let{id:m}=await chrome.tabs.create({url:"fsGmailPermissions.html"});l=async b=>{b===m&&(N()("Permissions tab closed"),chrome.tabs.onRemoved.removeListener(l),await chrome.permissions.contains({origins:["https://mail.google.com/*"]})?(N()("Gmail permissions granted starting GMail."),d()):N()("Gmail permissions not granted, aborting attachment"))},chrome.tabs.onRemoved.addListener(l)}}Ms();var Bo=()=>{},vn=null,eu="alarmCleanupDB",qr={doUpgrade:Mo,openFile:Hc,openClipboard:Vc,showAbout:Gc,onFileSavedEvent:dm,onStopCapturingClicked:$o,resumeEditing:jc,executeGrabber:bn,executeBatch:cm,enterLicense:Kc,openCaptureSettings:$c,openSettings:Bc,addOnDeterminingFilenameHandler:vm,doTrial:Uc,tryReconnecNativePlugin:um,showLicenseInfo:Wc,captureLoaded:_m,captureCreated:bm,doTest:sm,isNativeSupported:Le,scrollingCompleted:wm,addTaskOnPermissionGranted:Xn};N()("Service worker started.");var Pt,{extVersion:Dt,extVersionFull:jo,fSilentMode:tu}=je(),Zc=!1,nu=!1;_e.onInit=async()=>{N()("fsPreferences.onInit event."),he().reset()};_e.ensureLoaded().then(gm);chrome.runtime.onMessage.addListener(it(lm));chrome.commands.onCommand.addListener(it(hm));chrome.alarms.onAlarm.addListener(it(ym));chrome.contextMenus.onClicked.addListener(it(mm));chrome.runtime.onInstalled.addListener(it(async e=>{_e.ensureLoaded().then(vr),e.reason&&e.reason==="install"&&(nu=!0,_e.ensureLoaded().then(fm))}));chrome.runtime.onStartup.addListener(it(()=>{N()("*** chrome.runtime.onStartup"),_e.ensureLoaded().then(su)}));self.oninstall=()=>_e.ensureLoaded().then(su);function nm(){N()("restoreBadge");let e=Z(y.q,"");e!==""&&rn(e)}function rm(){if(N()("displayAnnouncements"),tu)return;if(nu){en(im());return}else if(Le())return;let e=Z(y.v);e&&Dt!=e&&(!We()||ue||Z(y.Y,"true")==="true"?rn(ru()):Q(y.v,Dt))}function im(){return N()("getInstalledPageUR"),Le()||We()&&!$e()?`https://getfireshot.com/installed.php?ver=${Dt}&app=${ot()}&native=1`:`https://getfireshot.com/installed-lite.php?ver=${Dt}&app=${ot()}`}function ru(){return N()("getUpdatedPageURL"),Le()||We()&&!$e()?`https://getfireshot.com/updated.php?app=${ot()}&ver=${Dt}&h=${We()?"1":"0"}`:`https://getfireshot.com/updated-lite.php?app=${ot()}&ver=${Dt}`}function iu(){return N()("initNativeModule"),new Promise(e=>{tt.init(au,pm,()=>{N()("Host ready event"),e(),om()},()=>{e()})})}function om(){N()("switchToProIfRequired");let e=Bi()||Ve=="{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}",t=Bi();Q(y.t,Z(y.t)==="true"||e),Q(y.g,Z(y.g)==="true"||t)}async function am(){N()("performVisualDelay");let e=Z(y.ge,5);he().add(y.M);let t=!1,i=o=>new Promise(s=>setTimeout(s,o));for(let o=e;o>0&&!t;--o){chrome.action.setBadgeBackgroundColor({color:"#333"}),chrome.action.setBadgeTextColor({color:"#fff"}),chrome.action.setBadgeText({text:o.toString()});for(let s=0;s<5&&!t;++s)await i(200),t=!he().contains(y.M)}return chrome.action.setBadgeText({text:""}),he().remove(y.M),!t}function Xn(e,t){if(!qr[t.method]){console.error("Unknown method: "+t.method);return}chrome.permissions.contains(e).then(i=>{if(i)return qr[t.method].apply(self,t.args);Xn.callId=Xn.callId||0;let o=()=>chrome.permissions.onAdded.removeListener(c),c=(d=>()=>{o(),d===Xn.callId&&chrome.permissions.contains(e).then(h=>h?qr[t.method].apply(self,t.args):!1)})(++Xn.callId);chrome.permissions.onAdded.addListener(c),setTimeout(o,3e4)})}async function sm(){throw new Error("Testing tags...")}function ou(){bn(Ri(),gr())}async function bn(e,t,i,o,s,c){N()(`executeGrabber(${e}, ${t})`);let l=he();l.contains(y.c)||l.contains(y.M)||(!i?.delayed||await am())&&(s||Fi(e,t),Pt=new Lo,Pt.executeGrabber(e,t,i,o,c))}function cm(e){N()("executeBatch"),!he().contains(y.c)&&(Pt=new Lo,Pt.captureList(e))}function um(){N()("tryReconnecNativePlugin"),!tt.autoReconnect&&!tt.updating&&!tt.portBusy&&iu()}function au(e){it(()=>{var t=e.topic,i=e.data?e.data+"":"";t=="status"?e.code==$i?te("setAddonVersion",{version:jo,browser:Di,id:Ve,guid:Z(y.k)}):(tn("UA-1025658-9","DLL","NativeError",e.data),alert(`FireShot failed to update. The updater reported the following error: \r
-----------------------------------------------\r
`+e.data+`\r
-----------------------------------------------\r
\r
FireShot will have to work in Lite mode.`),N()("Error from native module: "+e.data)):t=="openURL"?en(i):t=="enableResumeMenu"?Q(y.U,i==="enable"):t=="setupMode"?Q(y.t,i!=="false"):t=="processingFinished"?Fn():t=="setRegistered"?Q(y.g,i!=="false"):t=="getInfo"?Vs(i,function(o){te("processInfo",{data:o})}):t=="sendCrashReport"?Hs(i):t=="base64Content"?vn&&vn(i):t=="sendToGmail"?Qc(i):t=="switchToLite"?(tn("UA-1025658-9","fireshot.com","NativeSwitchBackToLite"),Fi(y.u,y.e),Q(y.t,"false"),tt.forceDisconnect()):t=="updateFilenameTemplate"&&Ws(i)})()}function lm(e,t,i){let o=["callExtensionMethodMsg","checkFSAvailabilityEvt","activateFireShot"].indexOf(e.message)!==-1;return _e.ensureLoaded().then(()=>{switch(e.message){case"callExtensionMethodMsg":{let s=qr[e.method];s?typeof s=="function"?e.async?(e.params.push(c=>i(c)),s.apply(this,e.params)):i(s.apply(this,e.params)):console.error(`Error: ${e.method}() is not a function.`):console.error(`Error: function ${e.method}() not found.`)}break;case"checkFSAvailabilityEvt":N()("checkFSAvailabilityEvt"),i({FSAvailable:!0,FSNative:Le(),FSUpgraded:Z(y.t)==="true",FSVersion:jo});break;case"capturePageEvt":{let s=parseInt(e.Action);if(s==y.ce)Le()?Mo():en("https://getfireshot.com/buy.php?SRC="+ot()+"-lite");else if(Li()){vn=l=>{vn=null;try{chrome.scripting.executeScript({args:[l],target:{tabId:t.tab.id,frameIds:[t.frameId]},injectImmediately:!0,func:d=>{if(window.fsPendingCB){let h={cbId:window.fsPendingCB,data:d};typeof cloneInto<"u"&&(h=cloneInto(h,document.defaultView));let m=new document.defaultView.CustomEvent("FireShotCaptureCompleteEvent",{detail:h});document.dispatchEvent(m)}}})}catch{}};let c;switch(e.Entire){case"selected":c=y.m;break;case"true":c=y.e;break;default:c=y.o;break}bn(s===y.H?y.K:s,c,{usrData:e.Data},function(){s===y.H&&te("storeEncodedContent",{path:e.Data}),s!==y.ae&&vn&&vn("")},!0,t.frameId)}}break;case"switchToNativeEvt":zc();break;case"activateFireShot":N()(e.name+" "+e.key),Q(y._,e.key),i("OK"),te("activateFireShot",{name:e.name,key:e.key});break}}),o}function fm(){N()("FireShot installed."),Q(y.v,Dt),Q(y.k,Ks());}function dm(e,t){N()(`onFileSavedEvent(ctxId = ${e}, fileId = ${t})`),Pt&&Pt.onFileSavedEvent(e,t)}function $o(){N()("onStopCapturingClicked");let e=he();return e.contains(y.i)&&e.remove(y.i),Pt?(Pt.stopCapturing(),!0):!1}function pm(e){N()("onNativeHostUpdated"),it(()=>{N()("Native module has updated to the "+e+" version."),tn("UA-1025658-9","DLL","NativeHostUpdated");let t=Z(y.v);t&&t!=Dt&&e==jo&&!tu&&(!We()||ue||Z(y.Y,"true")==="true"?rn(ru()):Q(y.v,e))})()}function hm(e){N()("Hotkey command:",e);let t=he();if(!t.contains(y.c)&&!t.contains(y.i)&&!t.contains(y.E)){let i=Le()?y.u:y.N;switch(e){case"last-used-action":ou();break;case"capture-entire-page-action":bn(i,y.e);break;case"capture-visible-page-action":bn(i,y.o);break;case"capture-selection-action":bn(i,y.m);break}}else(t.contains(y.c)||t.contains(y.i)||t.contains(y.E))&&e==="last-used-action"&&$o()}function mm(e){_e.ensureLoaded().then(()=>{switch(e.menuItemId){case"mnuLastCommand":he().isIdle()&&ou();break;case"mnuStopCommand":$o();break}})}async function su(){Zc||(Zc=!0,N()("onExtensionStartup event"),chrome.alarms.create(eu,{periodInMinutes:24*60}),Q(y.U,!1),Q(y.S,!1),Li()&&$s(!0),nm(),bt()&&!Oi()&&await iu(),rm())}async function gm(){N()("onServiceWorkerStarted event"),ye.init(au),Jn(),_e.onChanged.addListener(e=>{e&&e[y.A]&&vr()})}function ym(e){switch(N()(`onGenericAlarm: ${e.name}`),e.name){case eu:setTimeout(()=>{_e.ensureLoaded().then(()=>{let t=parseInt(_e.getOption(y.ve,"30"));t&&Yt.deleteOlderThanGivenDays(t)})},3e3);break}}function vm(e){N()("addOnDeterminingFilenameHandler"),Bo(),e&&it(()=>{if(qe())return;let t=(i,o)=>{i.byExtensionId===Ve&&(o({filename:e}),Bo())};Bo=()=>chrome.downloads.onDeterminingFilename.removeListener(t),chrome.downloads.onDeterminingFilename.addListener(t)})()}function bm(){}function _m(){}function wm(){}})();
//# sourceMappingURL=fsServiceWorker.js.map

//# debugId=af9c8516-2e86-51f3-8d9a-8fed62d4711b
